"use strict";(self.webpackChunkdocusaurus_classic_typescript=self.webpackChunkdocusaurus_classic_typescript||[]).push([[1277],{8879:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>m,frontMatter:()=>i,metadata:()=>p,toc:()=>l});var n=r(11),a=(r(2735),r(9530));const i={},o="Iframe-based rendering",p={unversionedId:"architecture/browser-iframe-rendering",id:"architecture/browser-iframe-rendering",title:"Iframe-based rendering",description:"To avoid page reloads, all the PHPRequestHandler responses must be rendered in an iframe. Remember, the entire setup only lives as long as the main index.html. We want to avoid reloading the main app at all costs.",source:"@site/docs/11-architecture/10-browser-iframe-rendering.md",sourceDirName:"11-architecture",slug:"/architecture/browser-iframe-rendering",permalink:"/wordpress-playground/architecture/browser-iframe-rendering",draft:!1,editUrl:"https://github.com/WordPress/wordpress-playground/tree/trunk/packages/docs/site/docs/11-architecture/10-browser-iframe-rendering.md",tags:[],version:"current",sidebarPosition:10,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Browser tab orchestrates the execution",permalink:"/wordpress-playground/architecture/browser-tab-orchestrates-execution"},next:{title:"PHP Worker Threads",permalink:"/wordpress-playground/architecture/browser-php-worker-threads"}},s={},l=[{value:"Iframes caveats",id:"iframes-caveats",level:2}],c={toc:l},d="wrapper";function m(e){let{components:t,...r}=e;return(0,a.kt)(d,(0,n.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"iframe-based-rendering"},"Iframe-based rendering"),(0,a.kt)("p",null,"To avoid page reloads, all the ",(0,a.kt)("inlineCode",{parentName:"p"},"PHPRequestHandler")," responses must be rendered in an iframe. Remember, the entire setup only lives as long as the main ",(0,a.kt)("inlineCode",{parentName:"p"},"index.html"),". We want to avoid reloading the main app at all costs."),(0,a.kt)("p",null,"In our app example above, ",(0,a.kt)("inlineCode",{parentName:"p"},"index.php")," renders the following HTML:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},'<a href="page.php">Go to page.php</a>\n')),(0,a.kt)("p",null,"Imagine our ",(0,a.kt)("inlineCode",{parentName:"p"},"index.html")," rendered it in a ",(0,a.kt)("inlineCode",{parentName:"p"},"<div>")," instead of an ",(0,a.kt)("inlineCode",{parentName:"p"},"<iframe>"),". As soon as you click on that link, the browser will try to navigate from ",(0,a.kt)("inlineCode",{parentName:"p"},"index.html")," to ",(0,a.kt)("inlineCode",{parentName:"p"},"page.php"),". However, ",(0,a.kt)("inlineCode",{parentName:"p"},"index.html")," runs the entire PHP app, including the Worker Thread, the PHPRequestHandler, and the traffic control connecting them to the Service Worker. Navigating away from it would destroy the app."),(0,a.kt)("p",null,"Now, consider an iframe with the same link in it:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},"<iframe srcdoc='<a href=\"page.php\">Go to page.php</a>'></iframe>\n")),(0,a.kt)("p",null,"This time, click the link in the browser to load ",(0,a.kt)("inlineCode",{parentName:"p"},"page.php")," ",(0,a.kt)("strong",{parentName:"p"},"inside the iframe"),". The top-level ",(0,a.kt)("inlineCode",{parentName:"p"},"index.html"),", where the PHP application runs, remains unaffected. That's why iframes are crucial for the ",(0,a.kt)("inlineCode",{parentName:"p"},"@php-wasm/web")," setup."),(0,a.kt)("admonition",{title:"Crash reports",type:"info"},(0,a.kt)("p",{parentName:"admonition"},"Playground doesn't collect crash reports automatically. Instead, it prompts users to submit\xa0a crash report when an instance fails to run in the browser."),(0,a.kt)("p",{parentName:"admonition"},"The report includes a log, description, and a URL, and users can modify it before submitting it."),(0,a.kt)("p",{parentName:"admonition"},"The ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/WordPress/wordpress-playground/blob/trunk/packages/playground/website/public/logger.php"},"Logger API")," handles it from there. This simple REST API validates the data and sends it to the ",(0,a.kt)("strong",{parentName:"p"},"Making WordPress")," ",(0,a.kt)("a",{parentName:"p",href:"https://wordpress.slack.com/archives/C06Q5DCKZ3L"},"#playground-logs Slack channel"),".")),(0,a.kt)("h2",{id:"iframes-caveats"},"Iframes caveats"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},'target="_top"')," isn't handled yet, so clicking links with ",(0,a.kt)("inlineCode",{parentName:"li"},'target="_top"')," will reload the page you\u2019re working on."),(0,a.kt)("li",{parentName:"ul"},"JavaScript popups originating in the ",(0,a.kt)("inlineCode",{parentName:"li"},"iframe")," may not always display.")))}m.isMDXComponent=!0},9530:(e,t,r)=>{r.d(t,{Zo:()=>c,kt:()=>h});var n=r(2735);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var s=n.createContext({}),l=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},c=function(e){var t=l(e.components);return n.createElement(s.Provider,{value:t},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),d=l(r),u=a,h=d["".concat(s,".").concat(u)]||d[u]||m[u]||i;return r?n.createElement(h,o(o({ref:t},c),{},{components:r})):n.createElement(h,o({ref:t},c))}));function h(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=r.length,o=new Array(i);o[0]=u;var p={};for(var s in t)hasOwnProperty.call(t,s)&&(p[s]=t[s]);p.originalType=e,p[d]="string"==typeof e?e:a,o[1]=p;for(var l=2;l<i;l++)o[l]=r[l];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}u.displayName="MDXCreateElement"}}]);