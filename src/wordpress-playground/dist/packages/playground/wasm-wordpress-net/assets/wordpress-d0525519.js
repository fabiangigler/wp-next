(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();const Ns=function(){return typeof process<"u"&&process.release?.name==="node"?"NODE":typeof window<"u"?"WEB":typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?"WORKER":"NODE"}();if(Ns==="NODE"){let e=function(r){return new Promise(function(n,s){r.onload=r.onerror=function(a){r.onload=r.onerror=null,a.type==="load"?n(r.result):s(new Error("Failed to read the blob/file"))}})},t=function(){const r=new Uint8Array([1,2,3,4]),s=new File([r],"test").stream();try{return s.getReader({mode:"byob"}),!0}catch{return!1}};if(typeof File>"u"){class r extends Blob{constructor(s,a,o){super(s);let u;o?.lastModified&&(u=new Date),(!u||isNaN(u.getFullYear()))&&(u=new Date),this.lastModifiedDate=u,this.lastModified=u.getMilliseconds(),this.name=a||""}}global.File=r}typeof Blob.prototype.arrayBuffer>"u"&&(Blob.prototype.arrayBuffer=function(){const n=new FileReader;return n.readAsArrayBuffer(this),e(n)}),typeof Blob.prototype.text>"u"&&(Blob.prototype.text=function(){const n=new FileReader;return n.readAsText(this),e(n)}),(typeof Blob.prototype.stream>"u"||!t())&&(Blob.prototype.stream=function(){let r=0;const n=this;return new ReadableStream({type:"bytes",autoAllocateChunkSize:512*1024,async pull(s){const a=s.byobRequest.view,u=await n.slice(r,r+a.byteLength).arrayBuffer(),d=new Uint8Array(u);new Uint8Array(a.buffer).set(d);const l=d.byteLength;s.byobRequest.respond(l),r+=l,r>=n.size&&s.close()}})})}if(Ns==="NODE"&&typeof CustomEvent>"u"){class e extends Event{constructor(r,n={}){super(r,n),this.detail=n.detail}initCustomEvent(){}}globalThis.CustomEvent=e}const gr={0:"No error occurred. System call completed successfully.",1:"Argument list too long.",2:"Permission denied.",3:"Address in use.",4:"Address not available.",5:"Address family not supported.",6:"Resource unavailable, or operation would block.",7:"Connection already in progress.",8:"Bad file descriptor.",9:"Bad message.",10:"Device or resource busy.",11:"Operation canceled.",12:"No child processes.",13:"Connection aborted.",14:"Connection refused.",15:"Connection reset.",16:"Resource deadlock would occur.",17:"Destination address required.",18:"Mathematics argument out of domain of function.",19:"Reserved.",20:"File exists.",21:"Bad address.",22:"File too large.",23:"Host is unreachable.",24:"Identifier removed.",25:"Illegal byte sequence.",26:"Operation in progress.",27:"Interrupted function.",28:"Invalid argument.",29:"I/O error.",30:"Socket is connected.",31:"There is a directory under that path.",32:"Too many levels of symbolic links.",33:"File descriptor value too large.",34:"Too many links.",35:"Message too large.",36:"Reserved.",37:"Filename too long.",38:"Network is down.",39:"Connection aborted by network.",40:"Network unreachable.",41:"Too many files open in system.",42:"No buffer space available.",43:"No such device.",44:"There is no such file or directory OR the parent directory does not exist.",45:"Executable file format error.",46:"No locks available.",47:"Reserved.",48:"Not enough space.",49:"No message of the desired type.",50:"Protocol not available.",51:"No space left on device.",52:"Function not supported.",53:"The socket is not connected.",54:"Not a directory or a symbolic link to a directory.",55:"Directory not empty.",56:"State not recoverable.",57:"Not a socket.",58:"Not supported, or operation not supported on socket.",59:"Inappropriate I/O control operation.",60:"No such device or address.",61:"Value too large to be stored in data type.",62:"Previous owner died.",63:"Operation not permitted.",64:"Broken pipe.",65:"Protocol error.",66:"Protocol not supported.",67:"Protocol wrong type for socket.",68:"Result too large.",69:"Read-only file system.",70:"Invalid seek.",71:"No such process.",72:"Reserved.",73:"Connection timed out.",74:"Text file busy.",75:"Cross-device link.",76:"Extension: Capabilities insufficient."};function Wa(e){const t=typeof e=="object"?e?.errno:null;if(t in gr)return gr[t]}function Ve(e=""){return function(r,n,s){const a=s.value;s.value=function(...o){try{return a.apply(this,o)}catch(u){const d=typeof u=="object"?u?.errno:null;if(d in gr){const l=gr[d],f=typeof o[1]=="string"?o[1]:null,y=f!==null?e.replaceAll("{path}",f):e;throw new Error(`${y}: ${l}`,{cause:u})}throw u}}}}const Ha="playground-log",ts=(e,...t)=>{Ke.dispatchEvent(new CustomEvent(Ha,{detail:{log:e,args:t}}))},Ga=(e,...t)=>{switch(typeof e.message=="string"?e.message=Wr(e.message):e.message.message&&typeof e.message.message=="string"&&(e.message.message=Wr(e.message.message)),e.severity){case"Debug":console.debug(e.message,...t);break;case"Info":console.info(e.message,...t);break;case"Warn":console.warn(e.message,...t);break;case"Error":console.error(e.message,...t);break;case"Fatal":console.error(e.message,...t);break;default:console.log(e.message,...t)}},Ba=e=>e instanceof Error?[e.message,e.stack].join(`
`):JSON.stringify(e,null,2),Cs=[],rs=e=>{Cs.push(e)},qr=e=>{if(e.raw===!0)rs(e.message);else{const t=Ja(typeof e.message=="object"?Ba(e.message):e.message,e.severity??"Info",e.prefix??"JavaScript");rs(t)}};class Ka extends EventTarget{constructor(t=[]){super(),this.handlers=t,this.fatalErrorEvent="playground-fatal-error"}getLogs(){return this.handlers.includes(qr)?[...Cs]:(this.error(`Logs aren't stored because the logToMemory handler isn't registered.
				If you're using a custom logger instance, make sure to register logToMemory handler.
			`),[])}logMessage(t,...r){for(const n of this.handlers)n(t,...r)}log(t,...r){this.logMessage({message:t,severity:void 0,prefix:"JavaScript",raw:!1},...r)}debug(t,...r){this.logMessage({message:t,severity:"Debug",prefix:"JavaScript",raw:!1},...r)}info(t,...r){this.logMessage({message:t,severity:"Info",prefix:"JavaScript",raw:!1},...r)}warn(t,...r){this.logMessage({message:t,severity:"Warn",prefix:"JavaScript",raw:!1},...r)}error(t,...r){this.logMessage({message:t,severity:"Error",prefix:"JavaScript",raw:!1},...r)}}const xa=()=>{try{if(process.env.NODE_ENV==="test")return[qr,ts]}catch{}return[qr,Ga,ts]},Ke=new Ka(xa()),Wr=e=>e.replace(/\t/g,""),Ja=(e,t,r)=>{const n=new Date,s=new Intl.DateTimeFormat("en-GB",{year:"numeric",month:"short",day:"2-digit",timeZone:"UTC"}).format(n).replace(/ /g,"-"),a=new Intl.DateTimeFormat("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1,timeZone:"UTC",timeZoneName:"short"}).format(n),o=s+" "+a;return e=Wr(e),`[${o}] ${r} ${t}: ${e}`};class ns extends Error{constructor(t,r){super(t),this.userFriendlyMessage=r,this.userFriendlyMessage||(this.userFriendlyMessage=t)}}function le(...e){let t=e.join("/");const r=t[0]==="/",n=t.substring(t.length-1)==="/";return t=Rs(t),!t&&!r&&(t="."),t&&n&&(t+="/"),t}function Os(e){if(e==="/")return"/";e=Rs(e);const t=e.lastIndexOf("/");return t===-1?"":t===0?"/":e.substr(0,t)}function Rs(e){const t=e[0]==="/";return e=Qa(e.split("/").filter(r=>!!r),!t).join("/"),(t?"/":"")+e.replace(/\/$/,"")}function Qa(e,t){let r=0;for(let n=e.length-1;n>=0;n--){const s=e[n];s==="."?e.splice(n,1):s===".."?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r;r--)e.unshift("..");return e}function Is(e=36,t="!@#$%^&*()_+=-[]/.,<>?"){const r="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"+t;let n="";for(let s=e;s>0;--s)n+=r[Math.floor(Math.random()*r.length)];return n}function Xa(){return Is(36,"-_")}function pe(e){return`json_decode(base64_decode('${Ya(JSON.stringify(e))}'), true)`}function Nr(e){const t={};for(const r in e)t[r]=pe(e[r]);return t}function Ya(e){return Za(new TextEncoder().encode(e))}function Za(e){const t=String.fromCodePoint(...e);return btoa(t)}var eo=Object.defineProperty,to=Object.getOwnPropertyDescriptor,ze=(e,t,r,n)=>{for(var s=n>1?void 0:n?to(t,r):t,a=e.length-1,o;a>=0;a--)(o=e[a])&&(s=(n?o(t,r,s):o(s))||s);return n&&s&&eo(t,r,s),s};const qe=class ke{static readFileAsText(t,r){return new TextDecoder().decode(ke.readFileAsBuffer(t,r))}static readFileAsBuffer(t,r){return t.readFile(r)}static writeFile(t,r,n){t.writeFile(r,n)}static unlink(t,r){t.unlink(r)}static mv(t,r,n){try{const s=t.lookupPath(r).node.mount,a=ke.fileExists(t,n)?t.lookupPath(n).node.mount:t.lookupPath(Os(n)).node.mount;s.mountpoint!==a.mountpoint?(ke.copyRecursive(t,r,n),ke.rmdir(t,r,{recursive:!0})):t.rename(r,n)}catch(s){const a=Wa(s);throw a?new Error(`Could not move ${r} to ${n}: ${a}`,{cause:s}):s}}static rmdir(t,r,n={recursive:!0}){n?.recursive&&ke.listFiles(t,r).forEach(s=>{const a=`${r}/${s}`;ke.isDir(t,a)?ke.rmdir(t,a,n):ke.unlink(t,a)}),t.rmdir(r)}static listFiles(t,r,n={prependPath:!1}){if(!ke.fileExists(t,r))return[];try{const s=t.readdir(r).filter(a=>a!=="."&&a!=="..");if(n.prependPath){const a=r.replace(/\/$/,"");return s.map(o=>`${a}/${o}`)}return s}catch(s){return Ke.error(s,{path:r}),[]}}static isDir(t,r){return ke.fileExists(t,r)?t.isDir(t.lookupPath(r).node.mode):!1}static fileExists(t,r){try{return t.lookupPath(r),!0}catch{return!1}}static mkdir(t,r){t.mkdirTree(r)}static copyRecursive(t,r,n){const s=t.lookupPath(r).node;if(t.isDir(s.mode)){t.mkdirTree(n);const a=t.readdir(r).filter(o=>o!=="."&&o!=="..");for(const o of a)ke.copyRecursive(t,le(r,o),le(n,o))}else t.writeFile(n,t.readFile(r))}};ze([Ve('Could not read "{path}"')],qe,"readFileAsText",1);ze([Ve('Could not read "{path}"')],qe,"readFileAsBuffer",1);ze([Ve('Could not write to "{path}"')],qe,"writeFile",1);ze([Ve('Could not unlink "{path}"')],qe,"unlink",1);ze([Ve('Could not remove directory "{path}"')],qe,"rmdir",1);ze([Ve('Could not list files in "{path}"')],qe,"listFiles",1);ze([Ve('Could not stat "{path}"')],qe,"isDir",1);ze([Ve('Could not stat "{path}"')],qe,"fileExists",1);ze([Ve('Could not create directory "{path}"')],qe,"mkdir",1);ze([Ve('Could not copy files from "{path}"')],qe,"copyRecursive",1);const ro={500:"Internal Server Error",502:"Bad Gateway",404:"Not Found",403:"Forbidden",401:"Unauthorized",400:"Bad Request",301:"Moved Permanently",302:"Found",307:"Temporary Redirect",308:"Permanent Redirect",204:"No Content",201:"Created",200:"OK"};class _r{constructor(t,r,n,s="",a=0){this.httpStatusCode=t,this.headers=r,this.bytes=n,this.exitCode=a,this.errors=s}static forHttpCode(t,r=""){return new _r(t,{},new TextEncoder().encode(r||ro[t]||""))}static fromRawData(t){return new _r(t.httpStatusCode,t.headers,t.bytes,t.errors,t.exitCode)}toRawData(){return{headers:this.headers,bytes:this.bytes,errors:this.errors,exitCode:this.exitCode,httpStatusCode:this.httpStatusCode}}get json(){return JSON.parse(this.text)}get text(){return new TextDecoder().decode(this.bytes)}}(function(){return typeof process<"u"&&process.release?.name==="node"?"NODE":typeof window<"u"?"WEB":typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?"WORKER":"NODE"})();var no=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function so(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}ReadableStream.prototype[Symbol.asyncIterator]||(ReadableStream.prototype[Symbol.asyncIterator]=async function*(){const e=this.getReader();try{for(;;){const{done:t,value:r}=await e.read();if(t)return;yield r}}finally{e.releaseLock()}},ReadableStream.prototype.iterate=ReadableStream.prototype[Symbol.asyncIterator]);const ao=["8.3","8.2","8.1","8.0","7.4","7.3","7.2","7.1","7.0"],oo=ao[0],io=["iconv","mbstring","xml-bundle","gd"];/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const As=Symbol("Comlink.proxy"),co=Symbol("Comlink.endpoint"),uo=Symbol("Comlink.releaseProxy"),jr=Symbol("Comlink.finalizer"),pr=Symbol("Comlink.thrown"),Ds=e=>typeof e=="object"&&e!==null||typeof e=="function",lo={canHandle:e=>Ds(e)&&e[As],serialize(e){const{port1:t,port2:r}=new MessageChannel;return Cr(e,t),[r,[r]]},deserialize(e){return e.start(),en(e)}},fo={canHandle:e=>Ds(e)&&pr in e,serialize({value:e}){let t;return e instanceof Error?t={isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:t={isError:!1,value:e},[t,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}},kt=new Map([["proxy",lo],["throw",fo]]);function po(e,t){for(const r of e)if(t===r||r==="*"||r instanceof RegExp&&r.test(t))return!0;return!1}function Cr(e,t=globalThis,r=["*"]){t.addEventListener("message",function n(s){if(!s||!s.data)return;if(!po(r,s.origin)){console.warn(`Invalid origin '${s.origin}' for comlink proxy`);return}const{id:a,type:o,path:u}=Object.assign({path:[]},s.data),d=(s.data.argumentList||[]).map(it);let l;try{const f=u.slice(0,-1).reduce((T,g)=>T[g],e),y=u.reduce((T,g)=>T[g],e);switch(o){case"GET":l=y;break;case"SET":f[u.slice(-1)[0]]=it(s.data.value),l=!0;break;case"APPLY":l=y.apply(f,d);break;case"CONSTRUCT":{const T=new y(...d);l=Fs(T)}break;case"ENDPOINT":{const{port1:T,port2:g}=new MessageChannel;Cr(e,g),l=go(T,[T])}break;case"RELEASE":l=void 0;break;default:return}}catch(f){l={value:f,[pr]:0}}Promise.resolve(l).catch(f=>({value:f,[pr]:0})).then(f=>{const[y,T]=Er(f);t.postMessage(Object.assign(Object.assign({},y),{id:a}),T),o==="RELEASE"&&(t.removeEventListener("message",n),js(t),jr in e&&typeof e[jr]=="function"&&e[jr]())}).catch(f=>{const[y,T]=Er({value:new TypeError("Unserializable return value"),[pr]:0});t.postMessage(Object.assign(Object.assign({},y),{id:a}),T)})}),t.start&&t.start()}function ho(e){return e.constructor.name==="MessagePort"}function js(e){ho(e)&&e.close()}function en(e,t){return Hr(e,[],t)}function ir(e){if(e)throw new Error("Proxy has been released and is not useable")}function Ms(e){return St(e,{type:"RELEASE"}).then(()=>{js(e)})}const vr=new WeakMap,wr="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{const t=(vr.get(e)||0)-1;vr.set(e,t),t===0&&Ms(e)});function mo(e,t){const r=(vr.get(t)||0)+1;vr.set(t,r),wr&&wr.register(e,t,e)}function yo(e){wr&&wr.unregister(e)}function Hr(e,t=[],r=function(){}){let n=!1;const s=new Proxy(r,{get(a,o){if(ir(n),o===uo)return()=>{yo(s),Ms(e),n=!0};if(o==="then"){if(t.length===0)return{then:()=>s};const u=St(e,{type:"GET",path:t.map(d=>d.toString())}).then(it);return u.then.bind(u)}return Hr(e,[...t,o])},set(a,o,u){ir(n);const[d,l]=Er(u);return St(e,{type:"SET",path:[...t,o].map(f=>f.toString()),value:d},l).then(it)},apply(a,o,u){ir(n);const d=t[t.length-1];if(d===co)return St(e,{type:"ENDPOINT"}).then(it);if(d==="bind")return Hr(e,t.slice(0,-1));const[l,f]=ss(u);return St(e,{type:"APPLY",path:t.map(y=>y.toString()),argumentList:l},f).then(it)},construct(a,o){ir(n);const[u,d]=ss(o);return St(e,{type:"CONSTRUCT",path:t.map(l=>l.toString()),argumentList:u},d).then(it)}});return mo(s,e),s}function $o(e){return Array.prototype.concat.apply([],e)}function ss(e){const t=e.map(Er);return[t.map(r=>r[0]),$o(t.map(r=>r[1]))]}const Ls=new WeakMap;function go(e,t){return Ls.set(e,t),e}function Fs(e){return Object.assign(e,{[As]:!0})}function Us(e,t=globalThis,r="*"){return{postMessage:(n,s)=>e.postMessage(n,r,s),addEventListener:t.addEventListener.bind(t),removeEventListener:t.removeEventListener.bind(t)}}function Er(e){for(const[t,r]of kt)if(r.canHandle(e)){const[n,s]=r.serialize(e);return[{type:"HANDLER",name:t,value:n},s]}return[{type:"RAW",value:e},Ls.get(e)||[]]}function it(e){switch(e.type){case"HANDLER":return kt.get(e.name).deserialize(e.value);case"RAW":return e.value}}function St(e,t,r){return new Promise(n=>{const s=_o();e.addEventListener("message",function a(o){!o.data||!o.data.id||o.data.id!==s||(e.removeEventListener("message",a),n(o.data))}),e.start&&e.start(),e.postMessage(Object.assign({id:s},t),r)})}function _o(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}function vo(e,t=void 0){Vs();const r=e instanceof Worker?e:Us(e,t),n=en(r),s=tn(n);return new Proxy(s,{get:(a,o)=>o==="isConnected"?async()=>{for(;;)try{await wo(n.isConnected(),200);break}catch{}}:n[o]})}async function wo(e,t){return new Promise((r,n)=>{setTimeout(n,t),e.then(r)})}function Eo(e,t){Vs();const r=Promise.resolve();let n,s;const a=new Promise((d,l)=>{n=d,s=l}),o=tn(e),u=new Proxy(o,{get:(d,l)=>l==="isConnected"?()=>r:l==="isReady"?()=>a:l in d?d[l]:t?.[l]});return Cr(u,typeof window<"u"?Us(self.parent):void 0),[n,s,u]}let as=!1;function Vs(){if(as)return;as=!0,kt.set("EVENT",{canHandle:r=>r instanceof CustomEvent,serialize:r=>[{detail:r.detail},[]],deserialize:r=>r}),kt.set("FUNCTION",{canHandle:r=>typeof r=="function",serialize(r){const{port1:n,port2:s}=new MessageChannel;return Cr(r,n),[s,[s]]},deserialize(r){return r.start(),en(r)}}),kt.set("PHPResponse",{canHandle:r=>typeof r=="object"&&r!==null&&"headers"in r&&"bytes"in r&&"errors"in r&&"exitCode"in r&&"httpStatusCode"in r,serialize(r){return[r.toRawData(),[]]},deserialize(r){return _r.fromRawData(r)}});const e=kt.get("throw"),t=e?.serialize;e.serialize=({value:r})=>{const n=t({value:r});return r.response&&(n[0].value.response=r.response),r.source&&(n[0].value.source=r.source),n}}function tn(e){return new Proxy(e,{get(t,r){switch(typeof t[r]){case"function":return(...n)=>t[r](...n);case"object":return t[r]===null?t[r]:tn(t[r]);case"undefined":case"number":case"string":return t[r];default:return Fs(t[r])}}})}function bo(e,t){return{type:"response",requestId:e,response:t}}function zs(e){return e.pathname.startsWith("/scope:")}function So(e){return zs(e)?e.pathname.split("/")[1].split(":")[1]:null}async function Po(e,t,r){const n=navigator.serviceWorker;if(!n)throw window.isSecureContext?new ns("Service workers are not supported in your browser."):new ns("WordPress Playground uses service workers and may only work on HTTPS and http://localhost/ sites, but the current site is neither.");await(await n.register(r,{type:"module",updateViaCache:"none"})).update(),navigator.serviceWorker.addEventListener("message",async function(o){if(t&&o.data.scope!==t)return;const u=o.data.args||[],d=o.data.method,l=await e[d](...u);o.source.postMessage(bo(o.data.requestId,l))}),n.startMessages()}function ko(e,t){window.addEventListener("message",r=>{r.source===e.contentWindow&&(t&&r.origin!==t||typeof r.data!="object"||r.data.type!=="relay"||window.parent.postMessage(r.data,"*"))}),window.addEventListener("message",r=>{r.source===window.parent&&(typeof r.data!="object"||r.data.type!=="relay"||e?.contentWindow?.postMessage(r.data))})}async function To(e,t={}){e=No(e,t);const r=new Worker(e,{type:"module"});return new Promise((n,s)=>{r.onerror=o=>{const u=new Error(`WebWorker failed to load at ${e}. ${o.message?`Original error: ${o.message}`:""}`);u.filename=o.filename,s(u)};function a(o){o.data==="worker-script-started"&&(n(r),r.removeEventListener("message",a))}r.addEventListener("message",a)})}function No(e,t){if(!Object.entries(t).length)return e+"";const r=new URL(e);for(const[n,s]of Object.entries(t))if(Array.isArray(s))for(const a of s)r.searchParams.append(n,a);else r.searchParams.set(n,s);return r.toString()}const Co="_overlay_1571u_1",Oo="_is-hidden_1571u_17",Ro="_wrapper_1571u_22",Io="_wrapper-definite_1571u_32",Ao="_progress-bar_1571u_32",Do="_is-indefinite_1571u_32",jo="_wrapper-indefinite_1571u_33",Mo="_is-definite_1571u_33",Lo="_indefinite-loading_1571u_1",Fo="_caption_1571u_81",Pe={overlay:Co,isHidden:Oo,wrapper:Ro,wrapperDefinite:Io,progressBar:Ao,isIndefinite:Do,wrapperIndefinite:jo,isDefinite:Mo,indefiniteLoading:Lo,caption:Fo};class Uo{constructor(t={}){this.caption="Preparing WordPress",this.progress=0,this.isIndefinite=!1,this.visible=!0,this.element=document.createElement("div"),this.captionElement=document.createElement("h3"),this.element.appendChild(this.captionElement),this.setOptions(t)}setOptions(t){"caption"in t&&t.caption&&(this.caption=t.caption),"progress"in t&&(this.progress=t.progress),"isIndefinite"in t&&(this.isIndefinite=t.isIndefinite),"visible"in t&&(this.visible=t.visible),this.updateElement()}destroy(){this.setOptions({visible:!1}),setTimeout(()=>{this.element.remove()},500)}updateElement(){this.element.className="",this.element.classList.add(Pe.overlay),this.visible||this.element.classList.add(Pe.isHidden),this.captionElement.className="",this.captionElement.classList.add(Pe.caption),this.captionElement.textContent=this.caption+"...";const t=this.element.querySelector(`.${Pe.wrapper}`);t&&this.element.removeChild(t),this.isIndefinite?this.element.appendChild(this.createProgressIndefinite()):this.element.appendChild(this.createProgress())}createProgress(){const t=document.createElement("div");t.classList.add(Pe.wrapper,Pe.wrapperDefinite);const r=document.createElement("div");return r.classList.add(Pe.progressBar,Pe.isDefinite),r.style.width=this.progress+"%",t.appendChild(r),t}createProgressIndefinite(){const t=document.createElement("div");t.classList.add(Pe.wrapper,Pe.wrapperIndefinite);const r=document.createElement("div");return r.classList.add(Pe.progressBar,Pe.isIndefinite),t.appendChild(r),t}}const Vo="/worker-thread-492c00ae.js",zo="/sw.js",qo="nightly",Wo="6.6-beta2",Ho={nightly:qo,beta:Wo,"6.5":"6.5.4","6.4":"6.4.4","6.3":"6.3.4","6.2":"6.2.5"},Go=Object.keys(Ho),Bo=Go.filter(e=>e.match(/^\d/))[0],qs=["db.php","plugins/akismet","plugins/hello.php","plugins/wordpress-importer","mu-plugins/sqlite-database-integration","mu-plugins/playground-includes","mu-plugins/0-playground.php","themes/twentytwenty","themes/twentytwentyone","themes/twentytwentytwo","themes/twentytwentythree","themes/twentytwentyfour","themes/twentytwentyfive","themes/twentytwentysix"],rn=async(e,{pluginPath:t,pluginName:r},n)=>{n?.tracker.setCaption(`Activating ${r||t}`);const s=await e.documentRoot,a=await e.run({code:`<?php
			define( 'WP_ADMIN', true );
			require_once( ${pe(s)}. "/wp-load.php" );
			require_once( ${pe(s)}. "/wp-admin/includes/plugin.php" );

			// Set current user to admin
			wp_set_current_user( get_users(array('role' => 'Administrator') )[0]->ID );

			$plugin_path = ${pe(t)};
			$response = false;
			if (!is_dir($plugin_path)) {
				$response = activate_plugin($plugin_path);
			}

			// Activate plugin by name if activation by path wasn't successful
			if ( null !== $response ) {
				foreach ( ( glob( $plugin_path . '/*.php' ) ?: array() ) as $file ) {
					$info = get_plugin_data( $file, false, false );
					if ( ! empty( $info['Name'] ) ) {
						$response = activate_plugin( $file );
						break;
					}
				}
			}

			if ( null === $response ) {
				die('Plugin activated successfully');
			} else if ( is_wp_error( $response ) ) {
				throw new Exception( $response->get_error_message() );
			}

			throw new Exception( 'Unable to activate plugin' );
		`});if(a.text!=="Plugin activated successfully")throw Ke.debug(a),new Error(`Plugin ${t} could not be activated – WordPress exited with no error. Sometimes, when $_SERVER or site options are not configured correctly, WordPress exits early with a 301 redirect. Inspect the "debug" logs in the console for more details`)},Ws=async(e,{themeFolderName:t},r)=>{r?.tracker.setCaption(`Activating ${t}`);const n=await e.documentRoot,s=`${n}/wp-content/themes/${t}`;if(!await e.fileExists(s))throw new Error(`
			Couldn't activate theme ${t}.
			Theme not found at the provided theme path: ${s}.
			Check the theme path to ensure it's correct.
			If the theme is not installed, you can install it using the installTheme step.
			More info can be found in the Blueprint documentation: https://wordpress.github.io/wordpress-playground/blueprints-api/steps/#ActivateThemeStep
		`);const a=await e.run({code:`<?php
			define( 'WP_ADMIN', true );
			require_once( getenv('docroot') . "/wp-load.php" );

			// Set current user to admin
			wp_set_current_user( get_users(array('role' => 'Administrator') )[0]->ID );

			switch_theme( getenv('themeFolderName') );

			if( wp_get_theme()->get_stylesheet() !== getenv('themeFolderName') ) {
				throw new Exception( 'Theme ' . getenv('themeFolderName') . ' could not be activated.' );				
			}
			die('Theme activated successfully');
		`,env:{docroot:n,themeFolderName:t}});if(a.text!=="Theme activated successfully")throw Ke.debug(a),new Error(`Theme ${t} could not be activated – WordPress exited with no error. Sometimes, when $_SERVER or site options are not configured correctly, WordPress exits early with a 301 redirect. Inspect the "debug" logs in the console for more details`)},Ko=async(e,{code:t})=>await e.run({code:t}),xo=async(e,{options:t})=>await e.run(t),Hs=async(e,{path:t})=>{await e.unlink(t)},Jo=async(e,{sql:t},r)=>{r?.tracker.setCaption("Executing SQL Queries");const n=`/tmp/${Xa()}.sql`;await e.writeFile(n,new Uint8Array(await t.arrayBuffer()));const s=await e.documentRoot,a=Nr({docroot:s,sqlFilename:n}),o=await e.run({code:`<?php
		require_once ${a.docroot} . '/wp-load.php';

		$handle = fopen(${a.sqlFilename}, 'r');
		$buffer = '';

		global $wpdb;

		while ($bytes = fgets($handle)) {
			$buffer .= $bytes;

			if (!feof($handle) && substr($buffer, -1, 1) !== "
") {
				continue;
			}

			$wpdb->query($buffer);
			$buffer = '';
		}
	`});return await Hs(e,{path:n}),o},Gr=async(e,{request:t})=>{Ke.warn('Deprecated: The Blueprint step "request" is deprecated and will be removed in a future release.');const r=await e.request(t);if(r.httpStatusCode>399||r.httpStatusCode<200)throw Ke.warn("WordPress response was",{response:r}),new Error(`Request failed with status ${r.httpStatusCode}`);return r},Qo=`<?php

/**
 * Rewrites the wp-config.php file to ensure specific constants are defined
 * with specific values.
 * 
 * Example:
 * 
 * \`\`\`php
 * <?php
 * define('WP_DEBUG', true);
 * // The third define() argument is also supported:
 * define('SAVEQUERIES', false, true);
 * 
 * // Expression
 * define(true ? 'WP_DEBUG_LOG' : 'WP_DEBUG_LOG', 123);
 * 
 * // Guarded expressions shouldn't be wrapped twice
 * if(!defined(1 ? 'A' : 'B')) {
 *     define(1 ? 'A' : 'B', 0);
 * }
 * 
 * // More advanced expression
 * define((function() use($x) {
 *     return [$x, 'a'];
 * })(), 123);
 * \`\`\`
 * 
 * Rewritten with
 * 
 *     $constants = [
 *        'WP_DEBUG' => false,
 *        'WP_DEBUG_LOG' => true,
 *        'SAVEQUERIES' => true,
 *        'NEW_CONSTANT' => "new constant",
 *     ];
 * 
 * \`\`\`php
 * <?php
 * define('WP_DEBUG_LOG',true);
 * define('NEW_CONSTANT','new constant');
 * ?><?php
 * define('WP_DEBUG',false);
 * // The third define() argument is also supported:
 * define('SAVEQUERIES',true, true);
 * 
 * // Expression
 * if(!defined($const ? 'WP_DEBUG_LOG' : 'WP_DEBUG_LOG')) {
 *      define($const ? 'WP_DEBUG_LOG' : 'WP_DEBUG_LOG', 123);
 * }
 * 
 * // Guarded expressions shouldn't be wrapped twice
 * if(!defined(1 ? 'A' : 'B')) {
 *     define(1 ? 'A' : 'B', 0);
 * }
 * 
 * // More advanced expression
 * if(!defined((function() use($x) {
 *    return [$x, 'a'];
 * })())) {
 *     define((function() use($x) {
 *         return [$x, 'a'];
 *     })(), 123);
 * }
 * \`\`\`
 * 
 * @param mixed $content
 * @return string
 */
function rewrite_wp_config_to_define_constants($content, $constants = [])
{
    $tokens = array_reverse(token_get_all($content));
    $output = [];
    $defined_expressions = [];

    // Look through all the tokens and find the define calls
    do {
        $buffer = [];
        $name_buffer = [];
        $value_buffer = [];
        $third_arg_buffer = [];

        // Capture everything until the define call into output.
        // Capturing the define call into a buffer.
        // Example:
        //     <?php echo 'a'; define  (
        //     ^^^^^^^^^^^^^^^^^^^^^^
        //           output   |buffer
        while ($token = array_pop($tokens)) {
            if (is_array($token) && $token[0] === T_STRING && (strtolower($token[1]) === 'define' || strtolower($token[1]) === 'defined')) {
                $buffer[] = $token;
                break;
            }
            $output[] = $token;
        }

        // Maybe we didn't find a define call and reached the end of the file?
        if (!count($tokens)) {
            break;
        }

        // Keep track of the "defined" expressions that are already accounted for
        if($token[1] === 'defined') {
            $output[] = $token;
            $defined_expression = [];
            $open_parenthesis = 0;
            // Capture everything up to the opening parenthesis, including the parenthesis
            // e.g. defined  (
            //           ^^^^
            while ($token = array_pop($tokens)) {
                $output[] = $token;
                if ($token === "(") {
                    ++$open_parenthesis;
                    break;
                }
            }

            // Capture everything up to the closing parenthesis, including the parenthesis
            // e.g. defined  (
            //           ^^^^
            while ($token = array_pop($tokens)) {
                $output[] = $token;
                if ($token === ")") {
                    --$open_parenthesis;
                }
                if ($open_parenthesis === 0) {
                    break;
                }
                $defined_expression[] = $token;
            }

            $defined_expressions[] = stringify_tokens(skip_whitespace($defined_expression));
            continue;
        }

        // Capture everything up to the opening parenthesis, including the parenthesis
        // e.g. define  (
        //           ^^^^
        while ($token = array_pop($tokens)) {
            $buffer[] = $token;
            if ($token === "(") {
                break;
            }
        }

        // Capture the first argument – it's the first expression after the opening
        // parenthesis and before the comma:
        // Examples:
        //     define("WP_DEBUG", true);
        //            ^^^^^^^^^^^
        //
        //     define(count([1,2]) > 2 ? 'WP_DEBUG' : 'FOO', true);
        //            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        $open_parenthesis = 0;
        while ($token = array_pop($tokens)) {
            $buffer[] = $token;
            if ($token === "(" || $token === "[" || $token === "{") {
                ++$open_parenthesis;
            } elseif ($token === ")" || $token === "]" || $token === "}") {
                --$open_parenthesis;
            } elseif ($token === "," && $open_parenthesis === 0) {
                break;
            }

            // Don't capture the comma as a part of the constant name
            $name_buffer[] = $token;
        }

        // Capture everything until the closing parenthesis
        //     define("WP_DEBUG", true);
        //                       ^^^^^^
        $open_parenthesis = 0;
        $is_second_argument = true;
        while ($token = array_pop($tokens)) {
            $buffer[] = $token;
            if ($token === ")" && $open_parenthesis === 0) {
                // Final parenthesis of the define call.
                break;
            } else if ($token === "(" || $token === "[" || $token === "{") {
                ++$open_parenthesis;
            } elseif ($token === ")" || $token === "]" || $token === "}") {
                --$open_parenthesis;
            } elseif ($token === "," && $open_parenthesis === 0) {
                // This define call has more than 2 arguments! The third one is the
                // boolean value indicating $is_case_insensitive. Let's continue capturing
                // to $third_arg_buffer.
                $is_second_argument = false;
            }
            if ($is_second_argument) {
                $value_buffer[] = $token;
            } else {
                $third_arg_buffer[] = $token;
            }
        }

        // Capture until the semicolon
        //     define("WP_DEBUG", true)  ;
        //                             ^^^
        while ($token = array_pop($tokens)) {
            $buffer[] = $token;
            if ($token === ";") {
                break;
            }
        }

        // Decide whether $name_buffer is a constant name or an expression
        $name_token = null;
        $name_token_index = $token;
        $name_is_literal = true;
        foreach ($name_buffer as $k => $token) {
            if (is_array($token)) {
                if ($token[0] === T_WHITESPACE || $token[0] === T_COMMENT || $token[0] === T_DOC_COMMENT) {
                    continue;
                } else if ($token[0] === T_STRING || $token[0] === T_CONSTANT_ENCAPSED_STRING) {
                    $name_token = $token;
                    $name_token_index = $k;
                } else {
                    $name_is_literal = false;
                    break;
                }
            } else if ($token !== "(" && $token !== ")") {
                $name_is_literal = false;
                break;
            }
        }

        // We can't handle expressions as constant names. Let's wrap that define
        // call in an if(!defined()) statement, just in case it collides with
        // a constant name.
        if (!$name_is_literal) {
            // Ensure the defined expression is not already accounted for
            foreach ($defined_expressions as $defined_expression) {
                if ($defined_expression === stringify_tokens(skip_whitespace($name_buffer))) {
                    $output = array_merge($output, $buffer);
                    continue 2;
                }
            }
            $output = array_merge(
                $output,
                ["if(!defined("],
                $name_buffer,
                [")) {\\n     "],
                ['define('],
                $name_buffer,
                [','],
                $value_buffer,
                $third_arg_buffer,
                [");"],
                ["\\n}\\n"]
            );
            continue;
        }

        // Yay, we have a literal constant name in the buffer now. Let's
        // get its value:
        $name = eval('return ' . $name_token[1] . ';');

        // If the constant name is not in the list of constants we're looking,
        // we can ignore it.
        if (!array_key_exists($name, $constants)) {
            $output = array_merge($output, $buffer);
            continue;
        }

        // We now have a define() call that defines a constant we're looking for.
        // Let's rewrite its value to the one 
        $output = array_merge(
            $output,
            ['define('],
            $name_buffer,
            [','],
            [var_export($constants[$name], true)],
            $third_arg_buffer,
            [");"]
        );

        // Remove the constant from the list so we can process any remaining
        // constants later.
        unset($constants[$name]);
    } while (count($tokens));

    // Add any constants that weren't found in the file
    if (count($constants)) {
        $prepend = [
            "<?php \\n"
        ];
        foreach ($constants as $name => $value) {
            $prepend = array_merge(
                $prepend,
                [
                    "define(",
                    var_export($name, true),
                    ',',
                    var_export($value, true),
                    ");\\n"
                ]
            );
        }
        $prepend[] = "?>";
        $output = array_merge(
            $prepend,
            $output
        );
    }

    // Translate the output tokens back into a string
    return stringify_tokens($output);
}

function stringify_tokens($tokens) {
    $output = '';
    foreach ($tokens as $token) {
        if (is_array($token)) {
            $output .= $token[1];
        } else {
            $output .= $token;
        }
    }
    return $output;
}

function skip_whitespace($tokens) {
    $output = [];
    foreach ($tokens as $token) {
        if (is_array($token) && ($token[0] === T_WHITESPACE || $token[0] === T_COMMENT || $token[0] === T_DOC_COMMENT)) {
            continue;
        }
        $output[] = $token;
    }
    return $output;
}
`,Qt=async(e,{consts:t,method:r="define-before-run"})=>{switch(r){case"define-before-run":await Xo(e,t);break;case"rewrite-wp-config":{const n=await e.documentRoot,s=le(n,"/wp-config.php"),a=await e.readFileAsText(s),o=await Yo(e,a,t);await e.writeFile(s,o);break}default:throw new Error(`Invalid method: ${r}`)}};async function Xo(e,t){for(const r in t)await e.defineConstant(r,t[r])}async function Yo(e,t,r){await e.writeFile("/tmp/code.php",t);const n=Nr({consts:r});return await e.run({code:`${Qo}
	$wp_config_path = '/tmp/code.php';
	$wp_config = file_get_contents($wp_config_path);
	$new_wp_config = rewrite_wp_config_to_define_constants($wp_config, ${n.consts});
	file_put_contents($wp_config_path, $new_wp_config);
	`}),await e.readFileAsText("/tmp/code.php")}const Br=async(e,{username:t="admin",password:r="password"}={},n)=>{n?.tracker.setCaption(n?.initialCaption||"Logging in"),await e.request({url:"/wp-login.php"});const s=await e.request({url:"/wp-login.php",method:"POST",body:{log:t,pwd:r,rememberme:"forever"}});if(!s.headers?.location?.[0]?.includes("/wp-admin/"))throw Ke.warn("WordPress response was",{response:s,text:s.text}),new Error(`Failed to log in as ${t} with password ${r}`)},Gs=async(e,{options:t})=>{const r=await e.documentRoot;await e.run({code:`<?php
		include ${pe(r)} . '/wp-load.php';
		$site_options = ${pe(t)};
		foreach($site_options as $name => $value) {
			update_option($name, $value);
		}
		echo "Success";
		`})},Zo=async(e,{meta:t,userId:r})=>{const n=await e.documentRoot;await e.run({code:`<?php
		include ${pe(n)} . '/wp-load.php';
		$meta = ${pe(t)};
		foreach($meta as $name => $value) {
			update_user_meta(${pe(r)}, $name, $value);
		}
		`})},ei=async e=>{await Qt(e,{consts:{WP_ALLOW_MULTISITE:1}});const t=new URL(await e.absoluteUrl);if(t.port!==""){let T=`The current host is ${t.host}, but WordPress multisites do not support custom ports.`;throw t.hostname==="localhost"&&(T+=" For development, you can set up a playground.test domain using the instructions at https://wordpress.github.io/wordpress-playground/contributing/code."),new Error(T)}const r=t.pathname.replace(/\/$/,"")+"/",n=`${t.protocol}//${t.hostname}${r}`;await Gs(e,{options:{siteurl:n,home:n}}),await Br(e,{});const s=await e.documentRoot,o=(await e.run({code:`<?php
define( 'WP_ADMIN', true );
require_once(${pe(s)} . "/wp-load.php");

// Set current user to admin
( get_users(array('role' => 'Administrator') )[0] );

require_once(${pe(s)} . "/wp-admin/includes/plugin.php");
$plugins_root = ${pe(s)} . "/wp-content/plugins";
$plugins = glob($plugins_root . "/*");

$deactivated_plugins = [];
foreach($plugins as $plugin_path) {
	if (str_ends_with($plugin_path, '/index.php')) {
		continue;
	}
	if (!is_dir($plugin_path)) {
		$deactivated_plugins[] = substr($plugin_path, strlen($plugins_root) + 1);
		deactivate_plugins($plugin_path);
		continue;
	}
	// Find plugin entry file
	foreach ( ( glob( $plugin_path . '/*.php' ) ?: array() ) as $file ) {
		$info = get_plugin_data( $file, false, false );
		if ( ! empty( $info['Name'] ) ) {
			deactivate_plugins( $file );
			$deactivated_plugins[] = substr($file, strlen($plugins_root) + 1);
			break;
		}
	}
}
echo json_encode($deactivated_plugins);
`})).json,d=(await Gr(e,{request:{url:"/wp-admin/network.php"}})).text.match(/name="_wpnonce"\s+value="([^"]+)"/)?.[1],l=await Gr(e,{request:{url:"/wp-admin/network.php",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:ti({_wpnonce:d,_wp_http_referer:r+"wp-admin/network.php",sitename:"My WordPress Website Sites",email:"admin@localhost.com",submit:"Install"})}});if(l.httpStatusCode!==200)throw Ke.warn("WordPress response was",{response:l,text:l.text,headers:l.headers}),new Error(`Failed to enable multisite. Response code was ${l.httpStatusCode}`);await Qt(e,{consts:{MULTISITE:!0,SUBDOMAIN_INSTALL:!1,SITE_ID_CURRENT_SITE:1,BLOG_ID_CURRENT_SITE:1,DOMAIN_CURRENT_SITE:t.hostname,PATH_CURRENT_SITE:r}});const f=new URL(await e.absoluteUrl),y=zs(f)?"scope:"+So(f):null;await e.writeFile("/internal/shared/preload/sunrise.php",`<?php
	$_SERVER['HTTP_HOST'] = ${pe(f.hostname)};
	$folder = ${pe(y)};
	if ($folder && strpos($_SERVER['REQUEST_URI'],"/$folder") === false) {
		$_SERVER['REQUEST_URI'] = "/$folder/" . ltrim($_SERVER['REQUEST_URI'], '/');
	}
`),await e.writeFile("/internal/shared/mu-plugins/sunrise.php",`<?php
		if ( !defined( 'BLOG_ID_CURRENT_SITE' ) ) {
			define( 'BLOG_ID_CURRENT_SITE', 1 );
		}
`),await Br(e,{});for(const T of o)await rn(e,{pluginPath:T})};function ti(e){return Object.keys(e).map(t=>encodeURIComponent(t)+"="+encodeURIComponent(e[t])).join("&")}const ri=async(e,{fromPath:t,toPath:r})=>{await e.writeFile(r,await e.readFileAsBuffer(t))},ni=async(e,{fromPath:t,toPath:r})=>{await e.mv(t,r)},si=async(e,{path:t})=>{await e.mkdir(t)},ai=async(e,{path:t})=>{await e.rmdir(t)},Bs=async(e,{path:t,data:r})=>{r instanceof File&&(r=new Uint8Array(await r.arrayBuffer())),t.startsWith("/wordpress/wp-content/mu-plugins")&&!await e.fileExists("/wordpress/wp-content/mu-plugins")&&await e.mkdir("/wordpress/wp-content/mu-plugins"),await e.writeFile(t,r)},Ks=async(e,{siteUrl:t})=>{await Qt(e,{consts:{WP_HOME:t,WP_SITEURL:t}})},oi=async(e,{file:t},r)=>{r?.tracker?.setCaption("Importing content"),await Bs(e,{path:"/tmp/import.wxr",data:t});const n=await e.documentRoot;await e.run({code:`<?php
		require ${pe(n)} . '/wp-load.php';
		require ${pe(n)} . '/wp-admin/includes/admin.php';
  
		kses_remove_filters();
		$admin_id = get_users(array('role' => 'Administrator') )[0]->ID;
        wp_set_current_user( $admin_id );
		$importer = new WXR_Importer( array(
			'fetch_attachments' => true,
			'default_author' => $admin_id
		) );
		$logger = new WP_Importer_Logger_CLI();
		$importer->set_logger( $logger );

		// Slashes from the imported content are lost if we don't call wp_slash here.
		add_action( 'wp_insert_post_data', function( $data ) {
			return wp_slash($data);
		});

		$result = $importer->import( '/tmp/import.wxr' );
		`})},Mr="/tmp/file.zip",ii=async(e,t,r)=>{if(t instanceof File){const s=t;t=Mr,await e.writeFile(t,new Uint8Array(await s.arrayBuffer()))}const n=Nr({zipPath:t,extractToPath:r});await e.run({code:`<?php
        function unzip($zipPath, $extractTo, $overwrite = true)
        {
            if (!is_dir($extractTo)) {
                mkdir($extractTo, 0777, true);
            }
            $zip = new ZipArchive;
            $res = $zip->open($zipPath);
            if ($res === TRUE) {
                $zip->extractTo($extractTo);
                $zip->close();
                chmod($extractTo, 0777);
            } else {
                throw new Exception("Could not unzip file");
            }
        }
        unzip(${n.zipPath}, ${n.extractToPath});
        `}),await e.fileExists(Mr)&&await e.unlink(Mr)},nn=async(e,{zipFile:t,zipPath:r,extractToPath:n})=>{if(r)Ke.warn('The "zipPath" option of the unzip() Blueprint step is deprecated and will be removed. Use "zipFile" instead.');else if(!t)throw new Error("Either zipPath or zipFile must be provided");await ii(e,t||r,n)},ci=async(e,{wordPressFilesZip:t,pathInZip:r=""})=>{const n=await e.documentRoot;let s=le("/tmp","import");await e.mkdir(s),await nn(e,{zipFile:t,extractToPath:s}),s=le(s,r);const a=le(s,"wp-content"),o=le(n,"wp-content");for(const f of qs){const y=le(a,f);await os(e,y);const T=le(o,f);await e.fileExists(T)&&(await e.mkdir(Os(y)),await e.mv(T,y))}const u=le(s,"wp-content","database");await e.fileExists(u)||await e.mv(le(n,"wp-content","database"),u);const d=await e.listFiles(s);for(const f of d)await os(e,le(n,f)),await e.mv(le(s,f),le(n,f));await e.rmdir(s),await Ks(e,{siteUrl:await e.absoluteUrl});const l=pe(le(n,"wp-admin","upgrade.php"));await e.run({code:`<?php
            $_GET['step'] = 'upgrade_db';
            require ${l};
            `})};async function os(e,t){await e.fileExists(t)&&(await e.isDir(t)?await e.rmdir(t):await e.unlink(t))}async function ui(e){const t=await e.request({url:"/wp-admin/export.php?download=true&content=all"});return new File([t.bytes],"export.xml")}async function xs(e,{targetPath:t,zipFile:r,ifAlreadyInstalled:n="overwrite"}){const a=r.name.replace(/\.zip$/,""),o=le(await e.documentRoot,"wp-content"),u=le(o,Is()),d=le(u,"assets",a);await e.fileExists(d)&&await e.rmdir(u,{recursive:!0}),await e.mkdir(u);try{await nn(e,{zipFile:r,extractToPath:d});let l=await e.listFiles(d,{prependPath:!0});l=l.filter(w=>!w.endsWith("/__MACOSX"));const f=l.length===1&&await e.isDir(l[0]);let y,T="";f?(T=l[0],y=l[0].split("/").pop()):(T=d,y=a);const g=`${t}/${y}`;if(await e.fileExists(g)){if(!await e.isDir(g))throw new Error(`Cannot install asset ${y} to ${g} because a file with the same name already exists. Note it's a file, not a directory! Is this by mistake?`);if(n==="overwrite")await e.rmdir(g,{recursive:!0});else{if(n==="skip")return{assetFolderPath:g,assetFolderName:y};throw new Error(`Cannot install asset ${y} to ${t} because it already exists and the ifAlreadyInstalled option was set to ${n}`)}}return await e.mv(T,g),{assetFolderPath:g,assetFolderName:y}}finally{await e.rmdir(u,{recursive:!0})}}function Js(e){const t=e.split(".").shift().replace(/-/g," ");return t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()}const li=async(e,{pluginZipFile:t,ifAlreadyInstalled:r,options:n={}},s)=>{const a=t.name.split("/").pop()||"plugin.zip",o=Js(a);s?.tracker.setCaption(`Installing the ${o} plugin`);const{assetFolderPath:u}=await xs(e,{ifAlreadyInstalled:r,zipFile:t,targetPath:`${await e.documentRoot}/wp-content/plugins`});("activate"in n?n.activate:!0)&&await rn(e,{pluginPath:u,pluginName:o},s)},di=async(e,{themeZipFile:t,ifAlreadyInstalled:r,options:n={}},s)=>{const a=Js(t.name);s?.tracker.setCaption(`Installing the ${a} theme`);const{assetFolderName:o}=await xs(e,{ifAlreadyInstalled:r,zipFile:t,targetPath:`${await e.documentRoot}/wp-content/themes`});("activate"in n?n.activate:!0)&&await Ws(e,{themeFolderName:o},s)},fi=async(e,t,r)=>{r?.tracker?.setCaption("Resetting WordPress data");const n=await e.documentRoot;await e.run({env:{DOCROOT:n},code:`<?php
		require getenv('DOCROOT') . '/wp-load.php';

		$GLOBALS['@pdo']->query('DELETE FROM wp_posts WHERE id > 0');
		$GLOBALS['@pdo']->query("UPDATE SQLITE_SEQUENCE SET SEQ=0 WHERE NAME='wp_posts'");
		
		$GLOBALS['@pdo']->query('DELETE FROM wp_postmeta WHERE post_id > 1');
		$GLOBALS['@pdo']->query("UPDATE SQLITE_SEQUENCE SET SEQ=20 WHERE NAME='wp_postmeta'");

		$GLOBALS['@pdo']->query('DELETE FROM wp_comments');
		$GLOBALS['@pdo']->query("UPDATE SQLITE_SEQUENCE SET SEQ=0 WHERE NAME='wp_comments'");

		$GLOBALS['@pdo']->query('DELETE FROM wp_commentmeta');
		$GLOBALS['@pdo']->query("UPDATE SQLITE_SEQUENCE SET SEQ=0 WHERE NAME='wp_commentmeta'");
		`})},pi=async(e,{options:t})=>{await e.request({url:"/wp-admin/install.php?step=2",method:"POST",body:{language:"en",prefix:"wp_",weblog_title:"My WordPress Website",user_name:t.adminPassword||"admin",admin_password:t.adminPassword||"password",admin_password2:t.adminPassword||"password",Submit:"Install WordPress",pw_weak:"1",admin_email:"admin@localhost.com"}})},hi=async(e,{selfContained:t=!1}={})=>{const r="/tmp/wordpress-playground.zip",n=await e.documentRoot,s=le(n,"wp-content");let a=qs;t&&(a=a.filter(d=>!d.startsWith("themes/twenty")).filter(d=>d!=="mu-plugins/sqlite-database-integration"));const o=Nr({zipPath:r,wpContentPath:s,documentRoot:n,exceptPaths:a.map(d=>le(n,"wp-content",d)),additionalPaths:t?{[le(n,"wp-config.php")]:"wp-config.php"}:{}});await yi(e,`zipDir(${o.wpContentPath}, ${o.zipPath}, array(
			'exclude_paths' => ${o.exceptPaths},
			'zip_root'      => ${o.documentRoot},
			'additional_paths' => ${o.additionalPaths}
		));`);const u=await e.readFileAsBuffer(r);return e.unlink(r),u},mi=`<?php

function zipDir($root, $output, $options = array())
{
    $root = rtrim($root, '/');
    $additionalPaths = array_key_exists('additional_paths', $options) ? $options['additional_paths'] : array();
    $excludePaths = array_key_exists('exclude_paths', $options) ? $options['exclude_paths'] : array();
    $zip_root = array_key_exists('zip_root', $options) ? $options['zip_root'] : $root;

    $zip = new ZipArchive;
    $res = $zip->open($output, ZipArchive::CREATE);
    if ($res === TRUE) {
        $directories = array(
            $root . '/'
        );
        while (sizeof($directories)) {
            $current_dir = array_pop($directories);

            if ($handle = opendir($current_dir)) {
                while (false !== ($entry = readdir($handle))) {
                    if ($entry == '.' || $entry == '..') {
                        continue;
                    }

                    $entry = join_paths($current_dir, $entry);
                    if (in_array($entry, $excludePaths)) {
                        continue;
                    }

                    if (is_dir($entry)) {
                        $directory_path = $entry . '/';
                        array_push($directories, $directory_path);
                    } else if (is_file($entry)) {
                        $zip->addFile($entry, substr($entry, strlen($zip_root)));
                    }
                }
                closedir($handle);
            }
        }
        foreach ($additionalPaths as $disk_path => $zip_path) {
            $zip->addFile($disk_path, $zip_path);
        }
        $zip->close();
        chmod($output, 0777);
    }
}

function join_paths()
{
    $paths = array();

    foreach (func_get_args() as $arg) {
        if ($arg !== '') {
            $paths[] = $arg;
        }
    }

    return preg_replace('#/+#', '/', join('/', $paths));
}
`;async function yi(e,t){return await e.run({code:mi+t})}const $i=async(e,{command:t,wpCliPath:r="/tmp/wp-cli.phar"})=>{if(!await e.fileExists(r))throw new Error(`wp-cli.phar not found at ${r}`);let n;if(typeof t=="string"?(t=t.trim(),n=gi(t)):n=t,n.shift()!=="wp")throw new Error('The first argument must be "wp".');await e.writeFile("/tmp/stdout",""),await e.writeFile("/tmp/stderr",""),await e.writeFile("/wordpress/run-cli.php",`<?php
		// Set up the environment to emulate a shell script
		// call.

		// Set SHELL_PIPE to 0 to ensure WP-CLI formats
		// the output as ASCII tables.
		// @see https://github.com/wp-cli/wp-cli/issues/1102
		putenv( 'SHELL_PIPE=0' );

		// Set the argv global.
		$GLOBALS['argv'] = array_merge([
		  "/tmp/wp-cli.phar",
		  "--path=/wordpress"
		], ${pe(n)});

		// Provide stdin, stdout, stderr streams outside of
		// the CLI SAPI.
		define('STDIN', fopen('php://stdin', 'rb'));
		define('STDOUT', fopen('php://stdout', 'wb'));
		define('STDERR', fopen('php://stderr', 'wb'));

		require( ${pe(r)} );
		`);const a=await e.run({scriptPath:"/wordpress/run-cli.php"});if(a.errors)throw new Error(a.errors);return a};function gi(e){let n=0,s="";const a=[];let o="";for(let u=0;u<e.length;u++){const d=e[u];n===0?d==='"'||d==="'"?(n=1,s=d):d.match(/\s/)?(o&&a.push(o),o=""):o+=d:n===1&&(d==="\\"?(u++,o+=e[u]):d===s?(n=0,s=""):o+=d)}return o&&a.push(o),a}const _i=Object.freeze(Object.defineProperty({__proto__:null,activatePlugin:rn,activateTheme:Ws,cp:ri,defineSiteUrl:Ks,defineWpConfigConsts:Qt,enableMultisite:ei,exportWXR:ui,importWordPressFiles:ci,importWxr:oi,installPlugin:li,installTheme:di,login:Br,mkdir:si,mv:ni,request:Gr,resetData:fi,rm:Hs,rmdir:ai,runPHP:Ko,runPHPWithOptions:xo,runSql:Jo,runWpInstallationWizard:pi,setSiteOptions:Gs,unzip:nn,updateUserMeta:Zo,wpCLI:$i,writeFile:Bs,zipWpContent:hi},Symbol.toStringTag,{value:"Module"}));var Kr={exports:{}},Qs={},Re={},Nt={},Yt={},B={},Xt={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.regexpCode=e.getEsmExportName=e.getProperty=e.safeStringify=e.stringify=e.strConcat=e.addCodeArg=e.str=e._=e.nil=e._Code=e.Name=e.IDENTIFIER=e._CodeOrName=void 0;class t{}e._CodeOrName=t,e.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class r extends t{constructor(N){if(super(),!e.IDENTIFIER.test(N))throw new Error("CodeGen: name must be a valid identifier");this.str=N}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}e.Name=r;class n extends t{constructor(N){super(),this._items=typeof N=="string"?[N]:N}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const N=this._items[0];return N===""||N==='""'}get str(){var N;return(N=this._str)!==null&&N!==void 0?N:this._str=this._items.reduce((C,I)=>`${C}${I}`,"")}get names(){var N;return(N=this._names)!==null&&N!==void 0?N:this._names=this._items.reduce((C,I)=>(I instanceof r&&(C[I.str]=(C[I.str]||0)+1),C),{})}}e._Code=n,e.nil=new n("");function s($,...N){const C=[$[0]];let I=0;for(;I<N.length;)u(C,N[I]),C.push($[++I]);return new n(C)}e._=s;const a=new n("+");function o($,...N){const C=[g($[0])];let I=0;for(;I<N.length;)C.push(a),u(C,N[I]),C.push(a,g($[++I]));return d(C),new n(C)}e.str=o;function u($,N){N instanceof n?$.push(...N._items):N instanceof r?$.push(N):$.push(y(N))}e.addCodeArg=u;function d($){let N=1;for(;N<$.length-1;){if($[N]===a){const C=l($[N-1],$[N+1]);if(C!==void 0){$.splice(N-1,3,C);continue}$[N++]="+"}N++}}function l($,N){if(N==='""')return $;if($==='""')return N;if(typeof $=="string")return N instanceof r||$[$.length-1]!=='"'?void 0:typeof N!="string"?`${$.slice(0,-1)}${N}"`:N[0]==='"'?$.slice(0,-1)+N.slice(1):void 0;if(typeof N=="string"&&N[0]==='"'&&!($ instanceof r))return`"${$}${N.slice(1)}`}function f($,N){return N.emptyStr()?$:$.emptyStr()?N:o`${$}${N}`}e.strConcat=f;function y($){return typeof $=="number"||typeof $=="boolean"||$===null?$:g(Array.isArray($)?$.join(","):$)}function T($){return new n(g($))}e.stringify=T;function g($){return JSON.stringify($).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}e.safeStringify=g;function w($){return typeof $=="string"&&e.IDENTIFIER.test($)?new n(`.${$}`):s`[${$}]`}e.getProperty=w;function k($){if(typeof $=="string"&&e.IDENTIFIER.test($))return new n(`${$}`);throw new Error(`CodeGen: invalid export name: ${$}, use explicit $id name mapping`)}e.getEsmExportName=k;function _($){return new n($.toString())}e.regexpCode=_})(Xt);var xr={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ValueScope=e.ValueScopeName=e.Scope=e.varKinds=e.UsedValueState=void 0;const t=Xt;class r extends Error{constructor(l){super(`CodeGen: "code" for ${l} not defined`),this.value=l.value}}var n;(function(d){d[d.Started=0]="Started",d[d.Completed=1]="Completed"})(n=e.UsedValueState||(e.UsedValueState={})),e.varKinds={const:new t.Name("const"),let:new t.Name("let"),var:new t.Name("var")};class s{constructor({prefixes:l,parent:f}={}){this._names={},this._prefixes=l,this._parent=f}toName(l){return l instanceof t.Name?l:this.name(l)}name(l){return new t.Name(this._newName(l))}_newName(l){const f=this._names[l]||this._nameGroup(l);return`${l}${f.index++}`}_nameGroup(l){var f,y;if(!((y=(f=this._parent)===null||f===void 0?void 0:f._prefixes)===null||y===void 0)&&y.has(l)||this._prefixes&&!this._prefixes.has(l))throw new Error(`CodeGen: prefix "${l}" is not allowed in this scope`);return this._names[l]={prefix:l,index:0}}}e.Scope=s;class a extends t.Name{constructor(l,f){super(f),this.prefix=l}setValue(l,{property:f,itemIndex:y}){this.value=l,this.scopePath=(0,t._)`.${new t.Name(f)}[${y}]`}}e.ValueScopeName=a;const o=(0,t._)`\n`;class u extends s{constructor(l){super(l),this._values={},this._scope=l.scope,this.opts={...l,_n:l.lines?o:t.nil}}get(){return this._scope}name(l){return new a(l,this._newName(l))}value(l,f){var y;if(f.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const T=this.toName(l),{prefix:g}=T,w=(y=f.key)!==null&&y!==void 0?y:f.ref;let k=this._values[g];if(k){const N=k.get(w);if(N)return N}else k=this._values[g]=new Map;k.set(w,T);const _=this._scope[g]||(this._scope[g]=[]),$=_.length;return _[$]=f.ref,T.setValue(f,{property:g,itemIndex:$}),T}getValue(l,f){const y=this._values[l];if(y)return y.get(f)}scopeRefs(l,f=this._values){return this._reduceValues(f,y=>{if(y.scopePath===void 0)throw new Error(`CodeGen: name "${y}" has no value`);return(0,t._)`${l}${y.scopePath}`})}scopeCode(l=this._values,f,y){return this._reduceValues(l,T=>{if(T.value===void 0)throw new Error(`CodeGen: name "${T}" has no value`);return T.value.code},f,y)}_reduceValues(l,f,y={},T){let g=t.nil;for(const w in l){const k=l[w];if(!k)continue;const _=y[w]=y[w]||new Map;k.forEach($=>{if(_.has($))return;_.set($,n.Started);let N=f($);if(N){const C=this.opts.es5?e.varKinds.var:e.varKinds.const;g=(0,t._)`${g}${C} ${$} = ${N};${this.opts._n}`}else if(N=T?.($))g=(0,t._)`${g}${N}${this.opts._n}`;else throw new r($);_.set($,n.Completed)})}return g}}e.ValueScope=u})(xr);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.or=e.and=e.not=e.CodeGen=e.operators=e.varKinds=e.ValueScopeName=e.ValueScope=e.Scope=e.Name=e.regexpCode=e.stringify=e.getProperty=e.nil=e.strConcat=e.str=e._=void 0;const t=Xt,r=xr;var n=Xt;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return n._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return n.str}}),Object.defineProperty(e,"strConcat",{enumerable:!0,get:function(){return n.strConcat}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return n.nil}}),Object.defineProperty(e,"getProperty",{enumerable:!0,get:function(){return n.getProperty}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return n.stringify}}),Object.defineProperty(e,"regexpCode",{enumerable:!0,get:function(){return n.regexpCode}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return n.Name}});var s=xr;Object.defineProperty(e,"Scope",{enumerable:!0,get:function(){return s.Scope}}),Object.defineProperty(e,"ValueScope",{enumerable:!0,get:function(){return s.ValueScope}}),Object.defineProperty(e,"ValueScopeName",{enumerable:!0,get:function(){return s.ValueScopeName}}),Object.defineProperty(e,"varKinds",{enumerable:!0,get:function(){return s.varKinds}}),e.operators={GT:new t._Code(">"),GTE:new t._Code(">="),LT:new t._Code("<"),LTE:new t._Code("<="),EQ:new t._Code("==="),NEQ:new t._Code("!=="),NOT:new t._Code("!"),OR:new t._Code("||"),AND:new t._Code("&&"),ADD:new t._Code("+")};class a{optimizeNodes(){return this}optimizeNames(i,h){return this}}class o extends a{constructor(i,h,R){super(),this.varKind=i,this.name=h,this.rhs=R}render({es5:i,_n:h}){const R=i?r.varKinds.var:this.varKind,L=this.rhs===void 0?"":` = ${this.rhs}`;return`${R} ${this.name}${L};`+h}optimizeNames(i,h){if(i[this.name.str])return this.rhs&&(this.rhs=de(this.rhs,i,h)),this}get names(){return this.rhs instanceof t._CodeOrName?this.rhs.names:{}}}class u extends a{constructor(i,h,R){super(),this.lhs=i,this.rhs=h,this.sideEffects=R}render({_n:i}){return`${this.lhs} = ${this.rhs};`+i}optimizeNames(i,h){if(!(this.lhs instanceof t.Name&&!i[this.lhs.str]&&!this.sideEffects))return this.rhs=de(this.rhs,i,h),this}get names(){const i=this.lhs instanceof t.Name?{}:{...this.lhs.names};return Ee(i,this.rhs)}}class d extends u{constructor(i,h,R,L){super(i,R,L),this.op=h}render({_n:i}){return`${this.lhs} ${this.op}= ${this.rhs};`+i}}class l extends a{constructor(i){super(),this.label=i,this.names={}}render({_n:i}){return`${this.label}:`+i}}class f extends a{constructor(i){super(),this.label=i,this.names={}}render({_n:i}){return`break${this.label?` ${this.label}`:""};`+i}}class y extends a{constructor(i){super(),this.error=i}render({_n:i}){return`throw ${this.error};`+i}get names(){return this.error.names}}class T extends a{constructor(i){super(),this.code=i}render({_n:i}){return`${this.code};`+i}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(i,h){return this.code=de(this.code,i,h),this}get names(){return this.code instanceof t._CodeOrName?this.code.names:{}}}class g extends a{constructor(i=[]){super(),this.nodes=i}render(i){return this.nodes.reduce((h,R)=>h+R.render(i),"")}optimizeNodes(){const{nodes:i}=this;let h=i.length;for(;h--;){const R=i[h].optimizeNodes();Array.isArray(R)?i.splice(h,1,...R):R?i[h]=R:i.splice(h,1)}return i.length>0?this:void 0}optimizeNames(i,h){const{nodes:R}=this;let L=R.length;for(;L--;){const F=R[L];F.optimizeNames(i,h)||(et(i,F.names),R.splice(L,1))}return R.length>0?this:void 0}get names(){return this.nodes.reduce((i,h)=>X(i,h.names),{})}}class w extends g{render(i){return"{"+i._n+super.render(i)+"}"+i._n}}class k extends g{}class _ extends w{}_.kind="else";class $ extends w{constructor(i,h){super(h),this.condition=i}render(i){let h=`if(${this.condition})`+super.render(i);return this.else&&(h+="else "+this.else.render(i)),h}optimizeNodes(){super.optimizeNodes();const i=this.condition;if(i===!0)return this.nodes;let h=this.else;if(h){const R=h.optimizeNodes();h=this.else=Array.isArray(R)?new _(R):R}if(h)return i===!1?h instanceof $?h:h.nodes:this.nodes.length?this:new $(tt(i),h instanceof $?[h]:h.nodes);if(!(i===!1||!this.nodes.length))return this}optimizeNames(i,h){var R;if(this.else=(R=this.else)===null||R===void 0?void 0:R.optimizeNames(i,h),!!(super.optimizeNames(i,h)||this.else))return this.condition=de(this.condition,i,h),this}get names(){const i=super.names;return Ee(i,this.condition),this.else&&X(i,this.else.names),i}}$.kind="if";class N extends w{}N.kind="for";class C extends N{constructor(i){super(),this.iteration=i}render(i){return`for(${this.iteration})`+super.render(i)}optimizeNames(i,h){if(super.optimizeNames(i,h))return this.iteration=de(this.iteration,i,h),this}get names(){return X(super.names,this.iteration.names)}}class I extends N{constructor(i,h,R,L){super(),this.varKind=i,this.name=h,this.from=R,this.to=L}render(i){const h=i.es5?r.varKinds.var:this.varKind,{name:R,from:L,to:F}=this;return`for(${h} ${R}=${L}; ${R}<${F}; ${R}++)`+super.render(i)}get names(){const i=Ee(super.names,this.from);return Ee(i,this.to)}}class j extends N{constructor(i,h,R,L){super(),this.loop=i,this.varKind=h,this.name=R,this.iterable=L}render(i){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(i)}optimizeNames(i,h){if(super.optimizeNames(i,h))return this.iterable=de(this.iterable,i,h),this}get names(){return X(super.names,this.iterable.names)}}class E extends w{constructor(i,h,R){super(),this.name=i,this.args=h,this.async=R}render(i){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(i)}}E.kind="func";class O extends g{render(i){return"return "+super.render(i)}}O.kind="return";class D extends w{render(i){let h="try"+super.render(i);return this.catch&&(h+=this.catch.render(i)),this.finally&&(h+=this.finally.render(i)),h}optimizeNodes(){var i,h;return super.optimizeNodes(),(i=this.catch)===null||i===void 0||i.optimizeNodes(),(h=this.finally)===null||h===void 0||h.optimizeNodes(),this}optimizeNames(i,h){var R,L;return super.optimizeNames(i,h),(R=this.catch)===null||R===void 0||R.optimizeNames(i,h),(L=this.finally)===null||L===void 0||L.optimizeNames(i,h),this}get names(){const i=super.names;return this.catch&&X(i,this.catch.names),this.finally&&X(i,this.finally.names),i}}class W extends w{constructor(i){super(),this.error=i}render(i){return`catch(${this.error})`+super.render(i)}}W.kind="catch";class K extends w{render(i){return"finally"+super.render(i)}}K.kind="finally";class ae{constructor(i,h={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...h,_n:h.lines?`
`:""},this._extScope=i,this._scope=new r.Scope({parent:i}),this._nodes=[new k]}toString(){return this._root.render(this.opts)}name(i){return this._scope.name(i)}scopeName(i){return this._extScope.name(i)}scopeValue(i,h){const R=this._extScope.value(i,h);return(this._values[R.prefix]||(this._values[R.prefix]=new Set)).add(R),R}getScopeValue(i,h){return this._extScope.getValue(i,h)}scopeRefs(i){return this._extScope.scopeRefs(i,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(i,h,R,L){const F=this._scope.toName(h);return R!==void 0&&L&&(this._constants[F.str]=R),this._leafNode(new o(i,F,R)),F}const(i,h,R){return this._def(r.varKinds.const,i,h,R)}let(i,h,R){return this._def(r.varKinds.let,i,h,R)}var(i,h,R){return this._def(r.varKinds.var,i,h,R)}assign(i,h,R){return this._leafNode(new u(i,h,R))}add(i,h){return this._leafNode(new d(i,e.operators.ADD,h))}code(i){return typeof i=="function"?i():i!==t.nil&&this._leafNode(new T(i)),this}object(...i){const h=["{"];for(const[R,L]of i)h.length>1&&h.push(","),h.push(R),(R!==L||this.opts.es5)&&(h.push(":"),(0,t.addCodeArg)(h,L));return h.push("}"),new t._Code(h)}if(i,h,R){if(this._blockNode(new $(i)),h&&R)this.code(h).else().code(R).endIf();else if(h)this.code(h).endIf();else if(R)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(i){return this._elseNode(new $(i))}else(){return this._elseNode(new _)}endIf(){return this._endBlockNode($,_)}_for(i,h){return this._blockNode(i),h&&this.code(h).endFor(),this}for(i,h){return this._for(new C(i),h)}forRange(i,h,R,L,F=this.opts.es5?r.varKinds.var:r.varKinds.let){const x=this._scope.toName(i);return this._for(new I(F,x,h,R),()=>L(x))}forOf(i,h,R,L=r.varKinds.const){const F=this._scope.toName(i);if(this.opts.es5){const x=h instanceof t.Name?h:this.var("_arr",h);return this.forRange("_i",0,(0,t._)`${x}.length`,Q=>{this.var(F,(0,t._)`${x}[${Q}]`),R(F)})}return this._for(new j("of",L,F,h),()=>R(F))}forIn(i,h,R,L=this.opts.es5?r.varKinds.var:r.varKinds.const){if(this.opts.ownProperties)return this.forOf(i,(0,t._)`Object.keys(${h})`,R);const F=this._scope.toName(i);return this._for(new j("in",L,F,h),()=>R(F))}endFor(){return this._endBlockNode(N)}label(i){return this._leafNode(new l(i))}break(i){return this._leafNode(new f(i))}return(i){const h=new O;if(this._blockNode(h),this.code(i),h.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(O)}try(i,h,R){if(!h&&!R)throw new Error('CodeGen: "try" without "catch" and "finally"');const L=new D;if(this._blockNode(L),this.code(i),h){const F=this.name("e");this._currNode=L.catch=new W(F),h(F)}return R&&(this._currNode=L.finally=new K,this.code(R)),this._endBlockNode(W,K)}throw(i){return this._leafNode(new y(i))}block(i,h){return this._blockStarts.push(this._nodes.length),i&&this.code(i).endBlock(h),this}endBlock(i){const h=this._blockStarts.pop();if(h===void 0)throw new Error("CodeGen: not in self-balancing block");const R=this._nodes.length-h;if(R<0||i!==void 0&&R!==i)throw new Error(`CodeGen: wrong number of nodes: ${R} vs ${i} expected`);return this._nodes.length=h,this}func(i,h=t.nil,R,L){return this._blockNode(new E(i,h,R)),L&&this.code(L).endFunc(),this}endFunc(){return this._endBlockNode(E)}optimize(i=1){for(;i-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(i){return this._currNode.nodes.push(i),this}_blockNode(i){this._currNode.nodes.push(i),this._nodes.push(i)}_endBlockNode(i,h){const R=this._currNode;if(R instanceof i||h&&R instanceof h)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${h?`${i.kind}/${h.kind}`:i.kind}"`)}_elseNode(i){const h=this._currNode;if(!(h instanceof $))throw new Error('CodeGen: "else" without "if"');return this._currNode=h.else=i,this}get _root(){return this._nodes[0]}get _currNode(){const i=this._nodes;return i[i.length-1]}set _currNode(i){const h=this._nodes;h[h.length-1]=i}}e.CodeGen=ae;function X(b,i){for(const h in i)b[h]=(b[h]||0)+(i[h]||0);return b}function Ee(b,i){return i instanceof t._CodeOrName?X(b,i.names):b}function de(b,i,h){if(b instanceof t.Name)return R(b);if(!L(b))return b;return new t._Code(b._items.reduce((F,x)=>(x instanceof t.Name&&(x=R(x)),x instanceof t._Code?F.push(...x._items):F.push(x),F),[]));function R(F){const x=h[F.str];return x===void 0||i[F.str]!==1?F:(delete i[F.str],x)}function L(F){return F instanceof t._Code&&F._items.some(x=>x instanceof t.Name&&i[x.str]===1&&h[x.str]!==void 0)}}function et(b,i){for(const h in i)b[h]=(b[h]||0)-(i[h]||0)}function tt(b){return typeof b=="boolean"||typeof b=="number"||b===null?!b:(0,t._)`!${A(b)}`}e.not=tt;const pt=v(e.operators.AND);function It(...b){return b.reduce(pt)}e.and=It;const ht=v(e.operators.OR);function M(...b){return b.reduce(ht)}e.or=M;function v(b){return(i,h)=>i===t.nil?h:h===t.nil?i:(0,t._)`${A(i)} ${b} ${A(h)}`}function A(b){return b instanceof t.Name?b:(0,t._)`(${b})`}})(B);var Z={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.checkStrictMode=e.getErrorPath=e.Type=e.useFunc=e.setEvaluated=e.evaluatedPropsToName=e.mergeEvaluated=e.eachItem=e.unescapeJsonPointer=e.escapeJsonPointer=e.escapeFragment=e.unescapeFragment=e.schemaRefOrVal=e.schemaHasRulesButRef=e.schemaHasRules=e.checkUnknownRules=e.alwaysValidSchema=e.toHash=void 0;const t=B,r=Xt;function n(E){const O={};for(const D of E)O[D]=!0;return O}e.toHash=n;function s(E,O){return typeof O=="boolean"?O:Object.keys(O).length===0?!0:(a(E,O),!o(O,E.self.RULES.all))}e.alwaysValidSchema=s;function a(E,O=E.schema){const{opts:D,self:W}=E;if(!D.strictSchema||typeof O=="boolean")return;const K=W.RULES.keywords;for(const ae in O)K[ae]||j(E,`unknown keyword: "${ae}"`)}e.checkUnknownRules=a;function o(E,O){if(typeof E=="boolean")return!E;for(const D in E)if(O[D])return!0;return!1}e.schemaHasRules=o;function u(E,O){if(typeof E=="boolean")return!E;for(const D in E)if(D!=="$ref"&&O.all[D])return!0;return!1}e.schemaHasRulesButRef=u;function d({topSchemaRef:E,schemaPath:O},D,W,K){if(!K){if(typeof D=="number"||typeof D=="boolean")return D;if(typeof D=="string")return(0,t._)`${D}`}return(0,t._)`${E}${O}${(0,t.getProperty)(W)}`}e.schemaRefOrVal=d;function l(E){return T(decodeURIComponent(E))}e.unescapeFragment=l;function f(E){return encodeURIComponent(y(E))}e.escapeFragment=f;function y(E){return typeof E=="number"?`${E}`:E.replace(/~/g,"~0").replace(/\//g,"~1")}e.escapeJsonPointer=y;function T(E){return E.replace(/~1/g,"/").replace(/~0/g,"~")}e.unescapeJsonPointer=T;function g(E,O){if(Array.isArray(E))for(const D of E)O(D);else O(E)}e.eachItem=g;function w({mergeNames:E,mergeToName:O,mergeValues:D,resultToName:W}){return(K,ae,X,Ee)=>{const de=X===void 0?ae:X instanceof t.Name?(ae instanceof t.Name?E(K,ae,X):O(K,ae,X),X):ae instanceof t.Name?(O(K,X,ae),ae):D(ae,X);return Ee===t.Name&&!(de instanceof t.Name)?W(K,de):de}}e.mergeEvaluated={props:w({mergeNames:(E,O,D)=>E.if((0,t._)`${D} !== true && ${O} !== undefined`,()=>{E.if((0,t._)`${O} === true`,()=>E.assign(D,!0),()=>E.assign(D,(0,t._)`${D} || {}`).code((0,t._)`Object.assign(${D}, ${O})`))}),mergeToName:(E,O,D)=>E.if((0,t._)`${D} !== true`,()=>{O===!0?E.assign(D,!0):(E.assign(D,(0,t._)`${D} || {}`),_(E,D,O))}),mergeValues:(E,O)=>E===!0?!0:{...E,...O},resultToName:k}),items:w({mergeNames:(E,O,D)=>E.if((0,t._)`${D} !== true && ${O} !== undefined`,()=>E.assign(D,(0,t._)`${O} === true ? true : ${D} > ${O} ? ${D} : ${O}`)),mergeToName:(E,O,D)=>E.if((0,t._)`${D} !== true`,()=>E.assign(D,O===!0?!0:(0,t._)`${D} > ${O} ? ${D} : ${O}`)),mergeValues:(E,O)=>E===!0?!0:Math.max(E,O),resultToName:(E,O)=>E.var("items",O)})};function k(E,O){if(O===!0)return E.var("props",!0);const D=E.var("props",(0,t._)`{}`);return O!==void 0&&_(E,D,O),D}e.evaluatedPropsToName=k;function _(E,O,D){Object.keys(D).forEach(W=>E.assign((0,t._)`${O}${(0,t.getProperty)(W)}`,!0))}e.setEvaluated=_;const $={};function N(E,O){return E.scopeValue("func",{ref:O,code:$[O.code]||($[O.code]=new r._Code(O.code))})}e.useFunc=N;var C;(function(E){E[E.Num=0]="Num",E[E.Str=1]="Str"})(C=e.Type||(e.Type={}));function I(E,O,D){if(E instanceof t.Name){const W=O===C.Num;return D?W?(0,t._)`"[" + ${E} + "]"`:(0,t._)`"['" + ${E} + "']"`:W?(0,t._)`"/" + ${E}`:(0,t._)`"/" + ${E}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return D?(0,t.getProperty)(E).toString():"/"+y(E)}e.getErrorPath=I;function j(E,O,D=E.opts.strictSchema){if(D){if(O=`strict mode: ${O}`,D===!0)throw new Error(O);E.self.logger.warn(O)}}e.checkStrictMode=j})(Z);var We={};Object.defineProperty(We,"__esModule",{value:!0});const ye=B,vi={data:new ye.Name("data"),valCxt:new ye.Name("valCxt"),instancePath:new ye.Name("instancePath"),parentData:new ye.Name("parentData"),parentDataProperty:new ye.Name("parentDataProperty"),rootData:new ye.Name("rootData"),dynamicAnchors:new ye.Name("dynamicAnchors"),vErrors:new ye.Name("vErrors"),errors:new ye.Name("errors"),this:new ye.Name("this"),self:new ye.Name("self"),scope:new ye.Name("scope"),json:new ye.Name("json"),jsonPos:new ye.Name("jsonPos"),jsonLen:new ye.Name("jsonLen"),jsonPart:new ye.Name("jsonPart")};We.default=vi;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.extendErrors=e.resetErrorsCount=e.reportExtraError=e.reportError=e.keyword$DataError=e.keywordError=void 0;const t=B,r=Z,n=We;e.keywordError={message:({keyword:_})=>(0,t.str)`must pass "${_}" keyword validation`},e.keyword$DataError={message:({keyword:_,schemaType:$})=>$?(0,t.str)`"${_}" keyword must be ${$} ($data)`:(0,t.str)`"${_}" keyword is invalid ($data)`};function s(_,$=e.keywordError,N,C){const{it:I}=_,{gen:j,compositeRule:E,allErrors:O}=I,D=y(_,$,N);C??(E||O)?d(j,D):l(I,(0,t._)`[${D}]`)}e.reportError=s;function a(_,$=e.keywordError,N){const{it:C}=_,{gen:I,compositeRule:j,allErrors:E}=C,O=y(_,$,N);d(I,O),j||E||l(C,n.default.vErrors)}e.reportExtraError=a;function o(_,$){_.assign(n.default.errors,$),_.if((0,t._)`${n.default.vErrors} !== null`,()=>_.if($,()=>_.assign((0,t._)`${n.default.vErrors}.length`,$),()=>_.assign(n.default.vErrors,null)))}e.resetErrorsCount=o;function u({gen:_,keyword:$,schemaValue:N,data:C,errsCount:I,it:j}){if(I===void 0)throw new Error("ajv implementation error");const E=_.name("err");_.forRange("i",I,n.default.errors,O=>{_.const(E,(0,t._)`${n.default.vErrors}[${O}]`),_.if((0,t._)`${E}.instancePath === undefined`,()=>_.assign((0,t._)`${E}.instancePath`,(0,t.strConcat)(n.default.instancePath,j.errorPath))),_.assign((0,t._)`${E}.schemaPath`,(0,t.str)`${j.errSchemaPath}/${$}`),j.opts.verbose&&(_.assign((0,t._)`${E}.schema`,N),_.assign((0,t._)`${E}.data`,C))})}e.extendErrors=u;function d(_,$){const N=_.const("err",$);_.if((0,t._)`${n.default.vErrors} === null`,()=>_.assign(n.default.vErrors,(0,t._)`[${N}]`),(0,t._)`${n.default.vErrors}.push(${N})`),_.code((0,t._)`${n.default.errors}++`)}function l(_,$){const{gen:N,validateName:C,schemaEnv:I}=_;I.$async?N.throw((0,t._)`new ${_.ValidationError}(${$})`):(N.assign((0,t._)`${C}.errors`,$),N.return(!1))}const f={keyword:new t.Name("keyword"),schemaPath:new t.Name("schemaPath"),params:new t.Name("params"),propertyName:new t.Name("propertyName"),message:new t.Name("message"),schema:new t.Name("schema"),parentSchema:new t.Name("parentSchema")};function y(_,$,N){const{createErrors:C}=_.it;return C===!1?(0,t._)`{}`:T(_,$,N)}function T(_,$,N={}){const{gen:C,it:I}=_,j=[g(I,N),w(_,N)];return k(_,$,j),C.object(...j)}function g({errorPath:_},{instancePath:$}){const N=$?(0,t.str)`${_}${(0,r.getErrorPath)($,r.Type.Str)}`:_;return[n.default.instancePath,(0,t.strConcat)(n.default.instancePath,N)]}function w({keyword:_,it:{errSchemaPath:$}},{schemaPath:N,parentSchema:C}){let I=C?$:(0,t.str)`${$}/${_}`;return N&&(I=(0,t.str)`${I}${(0,r.getErrorPath)(N,r.Type.Str)}`),[f.schemaPath,I]}function k(_,{params:$,message:N},C){const{keyword:I,data:j,schemaValue:E,it:O}=_,{opts:D,propertyName:W,topSchemaRef:K,schemaPath:ae}=O;C.push([f.keyword,I],[f.params,typeof $=="function"?$(_):$||(0,t._)`{}`]),D.messages&&C.push([f.message,typeof N=="function"?N(_):N]),D.verbose&&C.push([f.schema,E],[f.parentSchema,(0,t._)`${K}${ae}`],[n.default.data,j]),W&&C.push([f.propertyName,W])}})(Yt);Object.defineProperty(Nt,"__esModule",{value:!0});Nt.boolOrEmptySchema=Nt.topBoolOrEmptySchema=void 0;const wi=Yt,Ei=B,bi=We,Si={message:"boolean schema is false"};function Pi(e){const{gen:t,schema:r,validateName:n}=e;r===!1?Xs(e,!1):typeof r=="object"&&r.$async===!0?t.return(bi.default.data):(t.assign((0,Ei._)`${n}.errors`,null),t.return(!0))}Nt.topBoolOrEmptySchema=Pi;function ki(e,t){const{gen:r,schema:n}=e;n===!1?(r.var(t,!1),Xs(e)):r.var(t,!0)}Nt.boolOrEmptySchema=ki;function Xs(e,t){const{gen:r,data:n}=e,s={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:e};(0,wi.reportError)(s,Si,void 0,t)}var Zt={},dt={};Object.defineProperty(dt,"__esModule",{value:!0});dt.getRules=dt.isJSONType=void 0;const Ti=["string","number","integer","boolean","null","object","array"],Ni=new Set(Ti);function Ci(e){return typeof e=="string"&&Ni.has(e)}dt.isJSONType=Ci;function Oi(){const e={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...e,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{},keywords:{}}}dt.getRules=Oi;var Ge={};Object.defineProperty(Ge,"__esModule",{value:!0});Ge.shouldUseRule=Ge.shouldUseGroup=Ge.schemaHasRulesForType=void 0;function Ri({schema:e,self:t},r){const n=t.RULES.types[r];return n&&n!==!0&&Ys(e,n)}Ge.schemaHasRulesForType=Ri;function Ys(e,t){return t.rules.some(r=>Zs(e,r))}Ge.shouldUseGroup=Ys;function Zs(e,t){var r;return e[t.keyword]!==void 0||((r=t.definition.implements)===null||r===void 0?void 0:r.some(n=>e[n]!==void 0))}Ge.shouldUseRule=Zs;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.reportTypeError=e.checkDataTypes=e.checkDataType=e.coerceAndCheckDataType=e.getJSONTypes=e.getSchemaTypes=e.DataType=void 0;const t=dt,r=Ge,n=Yt,s=B,a=Z;var o;(function(C){C[C.Correct=0]="Correct",C[C.Wrong=1]="Wrong"})(o=e.DataType||(e.DataType={}));function u(C){const I=d(C.type);if(I.includes("null")){if(C.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!I.length&&C.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');C.nullable===!0&&I.push("null")}return I}e.getSchemaTypes=u;function d(C){const I=Array.isArray(C)?C:C?[C]:[];if(I.every(t.isJSONType))return I;throw new Error("type must be JSONType or JSONType[]: "+I.join(","))}e.getJSONTypes=d;function l(C,I){const{gen:j,data:E,opts:O}=C,D=y(I,O.coerceTypes),W=I.length>0&&!(D.length===0&&I.length===1&&(0,r.schemaHasRulesForType)(C,I[0]));if(W){const K=k(I,E,O.strictNumbers,o.Wrong);j.if(K,()=>{D.length?T(C,I,D):$(C)})}return W}e.coerceAndCheckDataType=l;const f=new Set(["string","number","integer","boolean","null"]);function y(C,I){return I?C.filter(j=>f.has(j)||I==="array"&&j==="array"):[]}function T(C,I,j){const{gen:E,data:O,opts:D}=C,W=E.let("dataType",(0,s._)`typeof ${O}`),K=E.let("coerced",(0,s._)`undefined`);D.coerceTypes==="array"&&E.if((0,s._)`${W} == 'object' && Array.isArray(${O}) && ${O}.length == 1`,()=>E.assign(O,(0,s._)`${O}[0]`).assign(W,(0,s._)`typeof ${O}`).if(k(I,O,D.strictNumbers),()=>E.assign(K,O))),E.if((0,s._)`${K} !== undefined`);for(const X of j)(f.has(X)||X==="array"&&D.coerceTypes==="array")&&ae(X);E.else(),$(C),E.endIf(),E.if((0,s._)`${K} !== undefined`,()=>{E.assign(O,K),g(C,K)});function ae(X){switch(X){case"string":E.elseIf((0,s._)`${W} == "number" || ${W} == "boolean"`).assign(K,(0,s._)`"" + ${O}`).elseIf((0,s._)`${O} === null`).assign(K,(0,s._)`""`);return;case"number":E.elseIf((0,s._)`${W} == "boolean" || ${O} === null
              || (${W} == "string" && ${O} && ${O} == +${O})`).assign(K,(0,s._)`+${O}`);return;case"integer":E.elseIf((0,s._)`${W} === "boolean" || ${O} === null
              || (${W} === "string" && ${O} && ${O} == +${O} && !(${O} % 1))`).assign(K,(0,s._)`+${O}`);return;case"boolean":E.elseIf((0,s._)`${O} === "false" || ${O} === 0 || ${O} === null`).assign(K,!1).elseIf((0,s._)`${O} === "true" || ${O} === 1`).assign(K,!0);return;case"null":E.elseIf((0,s._)`${O} === "" || ${O} === 0 || ${O} === false`),E.assign(K,null);return;case"array":E.elseIf((0,s._)`${W} === "string" || ${W} === "number"
              || ${W} === "boolean" || ${O} === null`).assign(K,(0,s._)`[${O}]`)}}}function g({gen:C,parentData:I,parentDataProperty:j},E){C.if((0,s._)`${I} !== undefined`,()=>C.assign((0,s._)`${I}[${j}]`,E))}function w(C,I,j,E=o.Correct){const O=E===o.Correct?s.operators.EQ:s.operators.NEQ;let D;switch(C){case"null":return(0,s._)`${I} ${O} null`;case"array":D=(0,s._)`Array.isArray(${I})`;break;case"object":D=(0,s._)`${I} && typeof ${I} == "object" && !Array.isArray(${I})`;break;case"integer":D=W((0,s._)`!(${I} % 1) && !isNaN(${I})`);break;case"number":D=W();break;default:return(0,s._)`typeof ${I} ${O} ${C}`}return E===o.Correct?D:(0,s.not)(D);function W(K=s.nil){return(0,s.and)((0,s._)`typeof ${I} == "number"`,K,j?(0,s._)`isFinite(${I})`:s.nil)}}e.checkDataType=w;function k(C,I,j,E){if(C.length===1)return w(C[0],I,j,E);let O;const D=(0,a.toHash)(C);if(D.array&&D.object){const W=(0,s._)`typeof ${I} != "object"`;O=D.null?W:(0,s._)`!${I} || ${W}`,delete D.null,delete D.array,delete D.object}else O=s.nil;D.number&&delete D.integer;for(const W in D)O=(0,s.and)(O,w(W,I,j,E));return O}e.checkDataTypes=k;const _={message:({schema:C})=>`must be ${C}`,params:({schema:C,schemaValue:I})=>typeof C=="string"?(0,s._)`{type: ${C}}`:(0,s._)`{type: ${I}}`};function $(C){const I=N(C);(0,n.reportError)(I,_)}e.reportTypeError=$;function N(C){const{gen:I,data:j,schema:E}=C,O=(0,a.schemaRefOrVal)(C,E,"type");return{gen:I,keyword:"type",data:j,schema:E.type,schemaCode:O,schemaValue:O,parentSchema:E,params:{},it:C}}})(Zt);var Or={};Object.defineProperty(Or,"__esModule",{value:!0});Or.assignDefaults=void 0;const Et=B,Ii=Z;function Ai(e,t){const{properties:r,items:n}=e.schema;if(t==="object"&&r)for(const s in r)is(e,s,r[s].default);else t==="array"&&Array.isArray(n)&&n.forEach((s,a)=>is(e,a,s.default))}Or.assignDefaults=Ai;function is(e,t,r){const{gen:n,compositeRule:s,data:a,opts:o}=e;if(r===void 0)return;const u=(0,Et._)`${a}${(0,Et.getProperty)(t)}`;if(s){(0,Ii.checkStrictMode)(e,`default is ignored for: ${u}`);return}let d=(0,Et._)`${u} === undefined`;o.useDefaults==="empty"&&(d=(0,Et._)`${d} || ${u} === null || ${u} === ""`),n.if(d,(0,Et._)`${u} = ${(0,Et.stringify)(r)}`)}var Ue={},G={};Object.defineProperty(G,"__esModule",{value:!0});G.validateUnion=G.validateArray=G.usePattern=G.callValidateCode=G.schemaProperties=G.allSchemaProperties=G.noPropertyInData=G.propertyInData=G.isOwnProperty=G.hasPropFunc=G.reportMissingProp=G.checkMissingProp=G.checkReportMissingProp=void 0;const re=B,sn=Z,Je=We,Di=Z;function ji(e,t){const{gen:r,data:n,it:s}=e;r.if(on(r,n,t,s.opts.ownProperties),()=>{e.setParams({missingProperty:(0,re._)`${t}`},!0),e.error()})}G.checkReportMissingProp=ji;function Mi({gen:e,data:t,it:{opts:r}},n,s){return(0,re.or)(...n.map(a=>(0,re.and)(on(e,t,a,r.ownProperties),(0,re._)`${s} = ${a}`)))}G.checkMissingProp=Mi;function Li(e,t){e.setParams({missingProperty:t},!0),e.error()}G.reportMissingProp=Li;function ea(e){return e.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,re._)`Object.prototype.hasOwnProperty`})}G.hasPropFunc=ea;function an(e,t,r){return(0,re._)`${ea(e)}.call(${t}, ${r})`}G.isOwnProperty=an;function Fi(e,t,r,n){const s=(0,re._)`${t}${(0,re.getProperty)(r)} !== undefined`;return n?(0,re._)`${s} && ${an(e,t,r)}`:s}G.propertyInData=Fi;function on(e,t,r,n){const s=(0,re._)`${t}${(0,re.getProperty)(r)} === undefined`;return n?(0,re.or)(s,(0,re.not)(an(e,t,r))):s}G.noPropertyInData=on;function ta(e){return e?Object.keys(e).filter(t=>t!=="__proto__"):[]}G.allSchemaProperties=ta;function Ui(e,t){return ta(t).filter(r=>!(0,sn.alwaysValidSchema)(e,t[r]))}G.schemaProperties=Ui;function Vi({schemaCode:e,data:t,it:{gen:r,topSchemaRef:n,schemaPath:s,errorPath:a},it:o},u,d,l){const f=l?(0,re._)`${e}, ${t}, ${n}${s}`:t,y=[[Je.default.instancePath,(0,re.strConcat)(Je.default.instancePath,a)],[Je.default.parentData,o.parentData],[Je.default.parentDataProperty,o.parentDataProperty],[Je.default.rootData,Je.default.rootData]];o.opts.dynamicRef&&y.push([Je.default.dynamicAnchors,Je.default.dynamicAnchors]);const T=(0,re._)`${f}, ${r.object(...y)}`;return d!==re.nil?(0,re._)`${u}.call(${d}, ${T})`:(0,re._)`${u}(${T})`}G.callValidateCode=Vi;const zi=(0,re._)`new RegExp`;function qi({gen:e,it:{opts:t}},r){const n=t.unicodeRegExp?"u":"",{regExp:s}=t.code,a=s(r,n);return e.scopeValue("pattern",{key:a.toString(),ref:a,code:(0,re._)`${s.code==="new RegExp"?zi:(0,Di.useFunc)(e,s)}(${r}, ${n})`})}G.usePattern=qi;function Wi(e){const{gen:t,data:r,keyword:n,it:s}=e,a=t.name("valid");if(s.allErrors){const u=t.let("valid",!0);return o(()=>t.assign(u,!1)),u}return t.var(a,!0),o(()=>t.break()),a;function o(u){const d=t.const("len",(0,re._)`${r}.length`);t.forRange("i",0,d,l=>{e.subschema({keyword:n,dataProp:l,dataPropType:sn.Type.Num},a),t.if((0,re.not)(a),u)})}}G.validateArray=Wi;function Hi(e){const{gen:t,schema:r,keyword:n,it:s}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(d=>(0,sn.alwaysValidSchema)(s,d))&&!s.opts.unevaluated)return;const o=t.let("valid",!1),u=t.name("_valid");t.block(()=>r.forEach((d,l)=>{const f=e.subschema({keyword:n,schemaProp:l,compositeRule:!0},u);t.assign(o,(0,re._)`${o} || ${u}`),e.mergeValidEvaluated(f,u)||t.if((0,re.not)(o))})),e.result(o,()=>e.reset(),()=>e.error(!0))}G.validateUnion=Hi;Object.defineProperty(Ue,"__esModule",{value:!0});Ue.validateKeywordUsage=Ue.validSchemaType=Ue.funcKeywordCode=Ue.macroKeywordCode=void 0;const $e=B,ct=We,Gi=G,Bi=Yt;function Ki(e,t){const{gen:r,keyword:n,schema:s,parentSchema:a,it:o}=e,u=t.macro.call(o.self,s,a,o),d=ra(r,n,u);o.opts.validateSchema!==!1&&o.self.validateSchema(u,!0);const l=r.name("valid");e.subschema({schema:u,schemaPath:$e.nil,errSchemaPath:`${o.errSchemaPath}/${n}`,topSchemaRef:d,compositeRule:!0},l),e.pass(l,()=>e.error(!0))}Ue.macroKeywordCode=Ki;function xi(e,t){var r;const{gen:n,keyword:s,schema:a,parentSchema:o,$data:u,it:d}=e;Qi(d,t);const l=!u&&t.compile?t.compile.call(d.self,a,o,d):t.validate,f=ra(n,s,l),y=n.let("valid");e.block$data(y,T),e.ok((r=t.valid)!==null&&r!==void 0?r:y);function T(){if(t.errors===!1)k(),t.modifying&&cs(e),_(()=>e.error());else{const $=t.async?g():w();t.modifying&&cs(e),_(()=>Ji(e,$))}}function g(){const $=n.let("ruleErrs",null);return n.try(()=>k((0,$e._)`await `),N=>n.assign(y,!1).if((0,$e._)`${N} instanceof ${d.ValidationError}`,()=>n.assign($,(0,$e._)`${N}.errors`),()=>n.throw(N))),$}function w(){const $=(0,$e._)`${f}.errors`;return n.assign($,null),k($e.nil),$}function k($=t.async?(0,$e._)`await `:$e.nil){const N=d.opts.passContext?ct.default.this:ct.default.self,C=!("compile"in t&&!u||t.schema===!1);n.assign(y,(0,$e._)`${$}${(0,Gi.callValidateCode)(e,f,N,C)}`,t.modifying)}function _($){var N;n.if((0,$e.not)((N=t.valid)!==null&&N!==void 0?N:y),$)}}Ue.funcKeywordCode=xi;function cs(e){const{gen:t,data:r,it:n}=e;t.if(n.parentData,()=>t.assign(r,(0,$e._)`${n.parentData}[${n.parentDataProperty}]`))}function Ji(e,t){const{gen:r}=e;r.if((0,$e._)`Array.isArray(${t})`,()=>{r.assign(ct.default.vErrors,(0,$e._)`${ct.default.vErrors} === null ? ${t} : ${ct.default.vErrors}.concat(${t})`).assign(ct.default.errors,(0,$e._)`${ct.default.vErrors}.length`),(0,Bi.extendErrors)(e)},()=>e.error())}function Qi({schemaEnv:e},t){if(t.async&&!e.$async)throw new Error("async keyword in sync schema")}function ra(e,t,r){if(r===void 0)throw new Error(`keyword "${t}" failed to compile`);return e.scopeValue("keyword",typeof r=="function"?{ref:r}:{ref:r,code:(0,$e.stringify)(r)})}function Xi(e,t,r=!1){return!t.length||t.some(n=>n==="array"?Array.isArray(e):n==="object"?e&&typeof e=="object"&&!Array.isArray(e):typeof e==n||r&&typeof e>"u")}Ue.validSchemaType=Xi;function Yi({schema:e,opts:t,self:r,errSchemaPath:n},s,a){if(Array.isArray(s.keyword)?!s.keyword.includes(a):s.keyword!==a)throw new Error("ajv implementation error");const o=s.dependencies;if(o?.some(u=>!Object.prototype.hasOwnProperty.call(e,u)))throw new Error(`parent schema must have dependencies of ${a}: ${o.join(",")}`);if(s.validateSchema&&!s.validateSchema(e[a])){const d=`keyword "${a}" value is invalid at path "${n}": `+r.errorsText(s.validateSchema.errors);if(t.validateSchema==="log")r.logger.error(d);else throw new Error(d)}}Ue.validateKeywordUsage=Yi;var Ze={};Object.defineProperty(Ze,"__esModule",{value:!0});Ze.extendSubschemaMode=Ze.extendSubschemaData=Ze.getSubschema=void 0;const Fe=B,na=Z;function Zi(e,{keyword:t,schemaProp:r,schema:n,schemaPath:s,errSchemaPath:a,topSchemaRef:o}){if(t!==void 0&&n!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(t!==void 0){const u=e.schema[t];return r===void 0?{schema:u,schemaPath:(0,Fe._)`${e.schemaPath}${(0,Fe.getProperty)(t)}`,errSchemaPath:`${e.errSchemaPath}/${t}`}:{schema:u[r],schemaPath:(0,Fe._)`${e.schemaPath}${(0,Fe.getProperty)(t)}${(0,Fe.getProperty)(r)}`,errSchemaPath:`${e.errSchemaPath}/${t}/${(0,na.escapeFragment)(r)}`}}if(n!==void 0){if(s===void 0||a===void 0||o===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,schemaPath:s,topSchemaRef:o,errSchemaPath:a}}throw new Error('either "keyword" or "schema" must be passed')}Ze.getSubschema=Zi;function ec(e,t,{dataProp:r,dataPropType:n,data:s,dataTypes:a,propertyName:o}){if(s!==void 0&&r!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:u}=t;if(r!==void 0){const{errorPath:l,dataPathArr:f,opts:y}=t,T=u.let("data",(0,Fe._)`${t.data}${(0,Fe.getProperty)(r)}`,!0);d(T),e.errorPath=(0,Fe.str)`${l}${(0,na.getErrorPath)(r,n,y.jsPropertySyntax)}`,e.parentDataProperty=(0,Fe._)`${r}`,e.dataPathArr=[...f,e.parentDataProperty]}if(s!==void 0){const l=s instanceof Fe.Name?s:u.let("data",s,!0);d(l),o!==void 0&&(e.propertyName=o)}a&&(e.dataTypes=a);function d(l){e.data=l,e.dataLevel=t.dataLevel+1,e.dataTypes=[],t.definedProperties=new Set,e.parentData=t.data,e.dataNames=[...t.dataNames,l]}}Ze.extendSubschemaData=ec;function tc(e,{jtdDiscriminator:t,jtdMetadata:r,compositeRule:n,createErrors:s,allErrors:a}){n!==void 0&&(e.compositeRule=n),s!==void 0&&(e.createErrors=s),a!==void 0&&(e.allErrors=a),e.jtdDiscriminator=t,e.jtdMetadata=r}Ze.extendSubschemaMode=tc;var me={},sa=function e(t,r){if(t===r)return!0;if(t&&r&&typeof t=="object"&&typeof r=="object"){if(t.constructor!==r.constructor)return!1;var n,s,a;if(Array.isArray(t)){if(n=t.length,n!=r.length)return!1;for(s=n;s--!==0;)if(!e(t[s],r[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if(a=Object.keys(t),n=a.length,n!==Object.keys(r).length)return!1;for(s=n;s--!==0;)if(!Object.prototype.hasOwnProperty.call(r,a[s]))return!1;for(s=n;s--!==0;){var o=a[s];if(!e(t[o],r[o]))return!1}return!0}return t!==t&&r!==r},aa={exports:{}},Ye=aa.exports=function(e,t,r){typeof t=="function"&&(r=t,t={}),r=t.cb||r;var n=typeof r=="function"?r:r.pre||function(){},s=r.post||function(){};hr(t,n,s,e,"",e)};Ye.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};Ye.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};Ye.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};Ye.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function hr(e,t,r,n,s,a,o,u,d,l){if(n&&typeof n=="object"&&!Array.isArray(n)){t(n,s,a,o,u,d,l);for(var f in n){var y=n[f];if(Array.isArray(y)){if(f in Ye.arrayKeywords)for(var T=0;T<y.length;T++)hr(e,t,r,y[T],s+"/"+f+"/"+T,a,s,f,n,T)}else if(f in Ye.propsKeywords){if(y&&typeof y=="object")for(var g in y)hr(e,t,r,y[g],s+"/"+f+"/"+rc(g),a,s,f,n,g)}else(f in Ye.keywords||e.allKeys&&!(f in Ye.skipKeywords))&&hr(e,t,r,y,s+"/"+f,a,s,f,n)}r(n,s,a,o,u,d,l)}}function rc(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}var nc=aa.exports;Object.defineProperty(me,"__esModule",{value:!0});me.getSchemaRefs=me.resolveUrl=me.normalizeId=me._getFullPath=me.getFullPath=me.inlineRef=void 0;const sc=Z,ac=sa,oc=nc,ic=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function cc(e,t=!0){return typeof e=="boolean"?!0:t===!0?!Jr(e):t?oa(e)<=t:!1}me.inlineRef=cc;const uc=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function Jr(e){for(const t in e){if(uc.has(t))return!0;const r=e[t];if(Array.isArray(r)&&r.some(Jr)||typeof r=="object"&&Jr(r))return!0}return!1}function oa(e){let t=0;for(const r in e){if(r==="$ref")return 1/0;if(t++,!ic.has(r)&&(typeof e[r]=="object"&&(0,sc.eachItem)(e[r],n=>t+=oa(n)),t===1/0))return 1/0}return t}function ia(e,t="",r){r!==!1&&(t=Tt(t));const n=e.parse(t);return ca(e,n)}me.getFullPath=ia;function ca(e,t){return e.serialize(t).split("#")[0]+"#"}me._getFullPath=ca;const lc=/#\/?$/;function Tt(e){return e?e.replace(lc,""):""}me.normalizeId=Tt;function dc(e,t,r){return r=Tt(r),e.resolve(t,r)}me.resolveUrl=dc;const fc=/^[a-z_][-a-z0-9._]*$/i;function pc(e,t){if(typeof e=="boolean")return{};const{schemaId:r,uriResolver:n}=this.opts,s=Tt(e[r]||t),a={"":s},o=ia(n,s,!1),u={},d=new Set;return oc(e,{allKeys:!0},(y,T,g,w)=>{if(w===void 0)return;const k=o+T;let _=a[w];typeof y[r]=="string"&&(_=$.call(this,y[r])),N.call(this,y.$anchor),N.call(this,y.$dynamicAnchor),a[T]=_;function $(C){const I=this.opts.uriResolver.resolve;if(C=Tt(_?I(_,C):C),d.has(C))throw f(C);d.add(C);let j=this.refs[C];return typeof j=="string"&&(j=this.refs[j]),typeof j=="object"?l(y,j.schema,C):C!==Tt(k)&&(C[0]==="#"?(l(y,u[C],C),u[C]=y):this.refs[C]=k),C}function N(C){if(typeof C=="string"){if(!fc.test(C))throw new Error(`invalid anchor "${C}"`);$.call(this,`#${C}`)}}}),u;function l(y,T,g){if(T!==void 0&&!ac(y,T))throw f(g)}function f(y){return new Error(`reference "${y}" resolves to more than one schema`)}}me.getSchemaRefs=pc;Object.defineProperty(Re,"__esModule",{value:!0});Re.getData=Re.KeywordCxt=Re.validateFunctionCode=void 0;const ua=Nt,us=Zt,cn=Ge,br=Zt,hc=Or,Gt=Ue,Lr=Ze,U=B,q=We,mc=me,Be=Z,qt=Yt;function yc(e){if(fa(e)&&(pa(e),da(e))){_c(e);return}la(e,()=>(0,ua.topBoolOrEmptySchema)(e))}Re.validateFunctionCode=yc;function la({gen:e,validateName:t,schema:r,schemaEnv:n,opts:s},a){s.code.es5?e.func(t,(0,U._)`${q.default.data}, ${q.default.valCxt}`,n.$async,()=>{e.code((0,U._)`"use strict"; ${ls(r,s)}`),gc(e,s),e.code(a)}):e.func(t,(0,U._)`${q.default.data}, ${$c(s)}`,n.$async,()=>e.code(ls(r,s)).code(a))}function $c(e){return(0,U._)`{${q.default.instancePath}="", ${q.default.parentData}, ${q.default.parentDataProperty}, ${q.default.rootData}=${q.default.data}${e.dynamicRef?(0,U._)`, ${q.default.dynamicAnchors}={}`:U.nil}}={}`}function gc(e,t){e.if(q.default.valCxt,()=>{e.var(q.default.instancePath,(0,U._)`${q.default.valCxt}.${q.default.instancePath}`),e.var(q.default.parentData,(0,U._)`${q.default.valCxt}.${q.default.parentData}`),e.var(q.default.parentDataProperty,(0,U._)`${q.default.valCxt}.${q.default.parentDataProperty}`),e.var(q.default.rootData,(0,U._)`${q.default.valCxt}.${q.default.rootData}`),t.dynamicRef&&e.var(q.default.dynamicAnchors,(0,U._)`${q.default.valCxt}.${q.default.dynamicAnchors}`)},()=>{e.var(q.default.instancePath,(0,U._)`""`),e.var(q.default.parentData,(0,U._)`undefined`),e.var(q.default.parentDataProperty,(0,U._)`undefined`),e.var(q.default.rootData,q.default.data),t.dynamicRef&&e.var(q.default.dynamicAnchors,(0,U._)`{}`)})}function _c(e){const{schema:t,opts:r,gen:n}=e;la(e,()=>{r.$comment&&t.$comment&&ma(e),Sc(e),n.let(q.default.vErrors,null),n.let(q.default.errors,0),r.unevaluated&&vc(e),ha(e),Tc(e)})}function vc(e){const{gen:t,validateName:r}=e;e.evaluated=t.const("evaluated",(0,U._)`${r}.evaluated`),t.if((0,U._)`${e.evaluated}.dynamicProps`,()=>t.assign((0,U._)`${e.evaluated}.props`,(0,U._)`undefined`)),t.if((0,U._)`${e.evaluated}.dynamicItems`,()=>t.assign((0,U._)`${e.evaluated}.items`,(0,U._)`undefined`))}function ls(e,t){const r=typeof e=="object"&&e[t.schemaId];return r&&(t.code.source||t.code.process)?(0,U._)`/*# sourceURL=${r} */`:U.nil}function wc(e,t){if(fa(e)&&(pa(e),da(e))){Ec(e,t);return}(0,ua.boolOrEmptySchema)(e,t)}function da({schema:e,self:t}){if(typeof e=="boolean")return!e;for(const r in e)if(t.RULES.all[r])return!0;return!1}function fa(e){return typeof e.schema!="boolean"}function Ec(e,t){const{schema:r,gen:n,opts:s}=e;s.$comment&&r.$comment&&ma(e),Pc(e),kc(e);const a=n.const("_errs",q.default.errors);ha(e,a),n.var(t,(0,U._)`${a} === ${q.default.errors}`)}function pa(e){(0,Be.checkUnknownRules)(e),bc(e)}function ha(e,t){if(e.opts.jtd)return ds(e,[],!1,t);const r=(0,us.getSchemaTypes)(e.schema),n=(0,us.coerceAndCheckDataType)(e,r);ds(e,r,!n,t)}function bc(e){const{schema:t,errSchemaPath:r,opts:n,self:s}=e;t.$ref&&n.ignoreKeywordsWithRef&&(0,Be.schemaHasRulesButRef)(t,s.RULES)&&s.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}function Sc(e){const{schema:t,opts:r}=e;t.default!==void 0&&r.useDefaults&&r.strictSchema&&(0,Be.checkStrictMode)(e,"default is ignored in the schema root")}function Pc(e){const t=e.schema[e.opts.schemaId];t&&(e.baseId=(0,mc.resolveUrl)(e.opts.uriResolver,e.baseId,t))}function kc(e){if(e.schema.$async&&!e.schemaEnv.$async)throw new Error("async schema in sync schema")}function ma({gen:e,schemaEnv:t,schema:r,errSchemaPath:n,opts:s}){const a=r.$comment;if(s.$comment===!0)e.code((0,U._)`${q.default.self}.logger.log(${a})`);else if(typeof s.$comment=="function"){const o=(0,U.str)`${n}/$comment`,u=e.scopeValue("root",{ref:t.root});e.code((0,U._)`${q.default.self}.opts.$comment(${a}, ${o}, ${u}.schema)`)}}function Tc(e){const{gen:t,schemaEnv:r,validateName:n,ValidationError:s,opts:a}=e;r.$async?t.if((0,U._)`${q.default.errors} === 0`,()=>t.return(q.default.data),()=>t.throw((0,U._)`new ${s}(${q.default.vErrors})`)):(t.assign((0,U._)`${n}.errors`,q.default.vErrors),a.unevaluated&&Nc(e),t.return((0,U._)`${q.default.errors} === 0`))}function Nc({gen:e,evaluated:t,props:r,items:n}){r instanceof U.Name&&e.assign((0,U._)`${t}.props`,r),n instanceof U.Name&&e.assign((0,U._)`${t}.items`,n)}function ds(e,t,r,n){const{gen:s,schema:a,data:o,allErrors:u,opts:d,self:l}=e,{RULES:f}=l;if(a.$ref&&(d.ignoreKeywordsWithRef||!(0,Be.schemaHasRulesButRef)(a,f))){s.block(()=>ga(e,"$ref",f.all.$ref.definition));return}d.jtd||Cc(e,t),s.block(()=>{for(const T of f.rules)y(T);y(f.post)});function y(T){(0,cn.shouldUseGroup)(a,T)&&(T.type?(s.if((0,br.checkDataType)(T.type,o,d.strictNumbers)),fs(e,T),t.length===1&&t[0]===T.type&&r&&(s.else(),(0,br.reportTypeError)(e)),s.endIf()):fs(e,T),u||s.if((0,U._)`${q.default.errors} === ${n||0}`))}}function fs(e,t){const{gen:r,schema:n,opts:{useDefaults:s}}=e;s&&(0,hc.assignDefaults)(e,t.type),r.block(()=>{for(const a of t.rules)(0,cn.shouldUseRule)(n,a)&&ga(e,a.keyword,a.definition,t.type)})}function Cc(e,t){e.schemaEnv.meta||!e.opts.strictTypes||(Oc(e,t),e.opts.allowUnionTypes||Rc(e,t),Ic(e,e.dataTypes))}function Oc(e,t){if(t.length){if(!e.dataTypes.length){e.dataTypes=t;return}t.forEach(r=>{ya(e.dataTypes,r)||un(e,`type "${r}" not allowed by context "${e.dataTypes.join(",")}"`)}),Dc(e,t)}}function Rc(e,t){t.length>1&&!(t.length===2&&t.includes("null"))&&un(e,"use allowUnionTypes to allow union type keyword")}function Ic(e,t){const r=e.self.RULES.all;for(const n in r){const s=r[n];if(typeof s=="object"&&(0,cn.shouldUseRule)(e.schema,s)){const{type:a}=s.definition;a.length&&!a.some(o=>Ac(t,o))&&un(e,`missing type "${a.join(",")}" for keyword "${n}"`)}}}function Ac(e,t){return e.includes(t)||t==="number"&&e.includes("integer")}function ya(e,t){return e.includes(t)||t==="integer"&&e.includes("number")}function Dc(e,t){const r=[];for(const n of e.dataTypes)ya(t,n)?r.push(n):t.includes("integer")&&n==="number"&&r.push("integer");e.dataTypes=r}function un(e,t){const r=e.schemaEnv.baseId+e.errSchemaPath;t+=` at "${r}" (strictTypes)`,(0,Be.checkStrictMode)(e,t,e.opts.strictTypes)}class $a{constructor(t,r,n){if((0,Gt.validateKeywordUsage)(t,r,n),this.gen=t.gen,this.allErrors=t.allErrors,this.keyword=n,this.data=t.data,this.schema=t.schema[n],this.$data=r.$data&&t.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,Be.schemaRefOrVal)(t,this.schema,n,this.$data),this.schemaType=r.schemaType,this.parentSchema=t.schema,this.params={},this.it=t,this.def=r,this.$data)this.schemaCode=t.gen.const("vSchema",_a(this.$data,t));else if(this.schemaCode=this.schemaValue,!(0,Gt.validSchemaType)(this.schema,r.schemaType,r.allowUndefined))throw new Error(`${n} value must be ${JSON.stringify(r.schemaType)}`);("code"in r?r.trackErrors:r.errors!==!1)&&(this.errsCount=t.gen.const("_errs",q.default.errors))}result(t,r,n){this.failResult((0,U.not)(t),r,n)}failResult(t,r,n){this.gen.if(t),n?n():this.error(),r?(this.gen.else(),r(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(t,r){this.failResult((0,U.not)(t),void 0,r)}fail(t){if(t===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(t),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(t){if(!this.$data)return this.fail(t);const{schemaCode:r}=this;this.fail((0,U._)`${r} !== undefined && (${(0,U.or)(this.invalid$data(),t)})`)}error(t,r,n){if(r){this.setParams(r),this._error(t,n),this.setParams({});return}this._error(t,n)}_error(t,r){(t?qt.reportExtraError:qt.reportError)(this,this.def.error,r)}$dataError(){(0,qt.reportError)(this,this.def.$dataError||qt.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,qt.resetErrorsCount)(this.gen,this.errsCount)}ok(t){this.allErrors||this.gen.if(t)}setParams(t,r){r?Object.assign(this.params,t):this.params=t}block$data(t,r,n=U.nil){this.gen.block(()=>{this.check$data(t,n),r()})}check$data(t=U.nil,r=U.nil){if(!this.$data)return;const{gen:n,schemaCode:s,schemaType:a,def:o}=this;n.if((0,U.or)((0,U._)`${s} === undefined`,r)),t!==U.nil&&n.assign(t,!0),(a.length||o.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),t!==U.nil&&n.assign(t,!1)),n.else()}invalid$data(){const{gen:t,schemaCode:r,schemaType:n,def:s,it:a}=this;return(0,U.or)(o(),u());function o(){if(n.length){if(!(r instanceof U.Name))throw new Error("ajv implementation error");const d=Array.isArray(n)?n:[n];return(0,U._)`${(0,br.checkDataTypes)(d,r,a.opts.strictNumbers,br.DataType.Wrong)}`}return U.nil}function u(){if(s.validateSchema){const d=t.scopeValue("validate$data",{ref:s.validateSchema});return(0,U._)`!${d}(${r})`}return U.nil}}subschema(t,r){const n=(0,Lr.getSubschema)(this.it,t);(0,Lr.extendSubschemaData)(n,this.it,t),(0,Lr.extendSubschemaMode)(n,t);const s={...this.it,...n,items:void 0,props:void 0};return wc(s,r),s}mergeEvaluated(t,r){const{it:n,gen:s}=this;n.opts.unevaluated&&(n.props!==!0&&t.props!==void 0&&(n.props=Be.mergeEvaluated.props(s,t.props,n.props,r)),n.items!==!0&&t.items!==void 0&&(n.items=Be.mergeEvaluated.items(s,t.items,n.items,r)))}mergeValidEvaluated(t,r){const{it:n,gen:s}=this;if(n.opts.unevaluated&&(n.props!==!0||n.items!==!0))return s.if(r,()=>this.mergeEvaluated(t,U.Name)),!0}}Re.KeywordCxt=$a;function ga(e,t,r,n){const s=new $a(e,r,t);"code"in r?r.code(s,n):s.$data&&r.validate?(0,Gt.funcKeywordCode)(s,r):"macro"in r?(0,Gt.macroKeywordCode)(s,r):(r.compile||r.validate)&&(0,Gt.funcKeywordCode)(s,r)}const jc=/^\/(?:[^~]|~0|~1)*$/,Mc=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function _a(e,{dataLevel:t,dataNames:r,dataPathArr:n}){let s,a;if(e==="")return q.default.rootData;if(e[0]==="/"){if(!jc.test(e))throw new Error(`Invalid JSON-pointer: ${e}`);s=e,a=q.default.rootData}else{const l=Mc.exec(e);if(!l)throw new Error(`Invalid JSON-pointer: ${e}`);const f=+l[1];if(s=l[2],s==="#"){if(f>=t)throw new Error(d("property/index",f));return n[t-f]}if(f>t)throw new Error(d("data",f));if(a=r[t-f],!s)return a}let o=a;const u=s.split("/");for(const l of u)l&&(a=(0,U._)`${a}${(0,U.getProperty)((0,Be.unescapeJsonPointer)(l))}`,o=(0,U._)`${o} && ${a}`);return o;function d(l,f){return`Cannot access ${l} ${f} levels up, current level is ${t}`}}Re.getData=_a;var er={};Object.defineProperty(er,"__esModule",{value:!0});class Lc extends Error{constructor(t){super("validation failed"),this.errors=t,this.ajv=this.validation=!0}}er.default=Lc;var tr={};Object.defineProperty(tr,"__esModule",{value:!0});const Fr=me;class Fc extends Error{constructor(t,r,n,s){super(s||`can't resolve reference ${n} from id ${r}`),this.missingRef=(0,Fr.resolveUrl)(t,r,n),this.missingSchema=(0,Fr.normalizeId)((0,Fr.getFullPath)(t,this.missingRef))}}tr.default=Fc;var ve={};Object.defineProperty(ve,"__esModule",{value:!0});ve.resolveSchema=ve.getCompilingSchema=ve.resolveRef=ve.compileSchema=ve.SchemaEnv=void 0;const Ne=B,Uc=er,ot=We,Oe=me,ps=Z,Vc=Re;class Rr{constructor(t){var r;this.refs={},this.dynamicAnchors={};let n;typeof t.schema=="object"&&(n=t.schema),this.schema=t.schema,this.schemaId=t.schemaId,this.root=t.root||this,this.baseId=(r=t.baseId)!==null&&r!==void 0?r:(0,Oe.normalizeId)(n?.[t.schemaId||"$id"]),this.schemaPath=t.schemaPath,this.localRefs=t.localRefs,this.meta=t.meta,this.$async=n?.$async,this.refs={}}}ve.SchemaEnv=Rr;function ln(e){const t=va.call(this,e);if(t)return t;const r=(0,Oe.getFullPath)(this.opts.uriResolver,e.root.baseId),{es5:n,lines:s}=this.opts.code,{ownProperties:a}=this.opts,o=new Ne.CodeGen(this.scope,{es5:n,lines:s,ownProperties:a});let u;e.$async&&(u=o.scopeValue("Error",{ref:Uc.default,code:(0,Ne._)`require("ajv/dist/runtime/validation_error").default`}));const d=o.scopeName("validate");e.validateName=d;const l={gen:o,allErrors:this.opts.allErrors,data:ot.default.data,parentData:ot.default.parentData,parentDataProperty:ot.default.parentDataProperty,dataNames:[ot.default.data],dataPathArr:[Ne.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:o.scopeValue("schema",this.opts.code.source===!0?{ref:e.schema,code:(0,Ne.stringify)(e.schema)}:{ref:e.schema}),validateName:d,ValidationError:u,schema:e.schema,schemaEnv:e,rootId:r,baseId:e.baseId||r,schemaPath:Ne.nil,errSchemaPath:e.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,Ne._)`""`,opts:this.opts,self:this};let f;try{this._compilations.add(e),(0,Vc.validateFunctionCode)(l),o.optimize(this.opts.code.optimize);const y=o.toString();f=`${o.scopeRefs(ot.default.scope)}return ${y}`,this.opts.code.process&&(f=this.opts.code.process(f,e));const g=new Function(`${ot.default.self}`,`${ot.default.scope}`,f)(this,this.scope.get());if(this.scope.value(d,{ref:g}),g.errors=null,g.schema=e.schema,g.schemaEnv=e,e.$async&&(g.$async=!0),this.opts.code.source===!0&&(g.source={validateName:d,validateCode:y,scopeValues:o._values}),this.opts.unevaluated){const{props:w,items:k}=l;g.evaluated={props:w instanceof Ne.Name?void 0:w,items:k instanceof Ne.Name?void 0:k,dynamicProps:w instanceof Ne.Name,dynamicItems:k instanceof Ne.Name},g.source&&(g.source.evaluated=(0,Ne.stringify)(g.evaluated))}return e.validate=g,e}catch(y){throw delete e.validate,delete e.validateName,f&&this.logger.error("Error compiling schema, function code:",f),y}finally{this._compilations.delete(e)}}ve.compileSchema=ln;function zc(e,t,r){var n;r=(0,Oe.resolveUrl)(this.opts.uriResolver,t,r);const s=e.refs[r];if(s)return s;let a=Hc.call(this,e,r);if(a===void 0){const o=(n=e.localRefs)===null||n===void 0?void 0:n[r],{schemaId:u}=this.opts;o&&(a=new Rr({schema:o,schemaId:u,root:e,baseId:t}))}if(a!==void 0)return e.refs[r]=qc.call(this,a)}ve.resolveRef=zc;function qc(e){return(0,Oe.inlineRef)(e.schema,this.opts.inlineRefs)?e.schema:e.validate?e:ln.call(this,e)}function va(e){for(const t of this._compilations)if(Wc(t,e))return t}ve.getCompilingSchema=va;function Wc(e,t){return e.schema===t.schema&&e.root===t.root&&e.baseId===t.baseId}function Hc(e,t){let r;for(;typeof(r=this.refs[t])=="string";)t=r;return r||this.schemas[t]||Ir.call(this,e,t)}function Ir(e,t){const r=this.opts.uriResolver.parse(t),n=(0,Oe._getFullPath)(this.opts.uriResolver,r);let s=(0,Oe.getFullPath)(this.opts.uriResolver,e.baseId,void 0);if(Object.keys(e.schema).length>0&&n===s)return Ur.call(this,r,e);const a=(0,Oe.normalizeId)(n),o=this.refs[a]||this.schemas[a];if(typeof o=="string"){const u=Ir.call(this,e,o);return typeof u?.schema!="object"?void 0:Ur.call(this,r,u)}if(typeof o?.schema=="object"){if(o.validate||ln.call(this,o),a===(0,Oe.normalizeId)(t)){const{schema:u}=o,{schemaId:d}=this.opts,l=u[d];return l&&(s=(0,Oe.resolveUrl)(this.opts.uriResolver,s,l)),new Rr({schema:u,schemaId:d,root:e,baseId:s})}return Ur.call(this,r,o)}}ve.resolveSchema=Ir;const Gc=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function Ur(e,{baseId:t,schema:r,root:n}){var s;if(((s=e.fragment)===null||s===void 0?void 0:s[0])!=="/")return;for(const u of e.fragment.slice(1).split("/")){if(typeof r=="boolean")return;const d=r[(0,ps.unescapeFragment)(u)];if(d===void 0)return;r=d;const l=typeof r=="object"&&r[this.opts.schemaId];!Gc.has(u)&&l&&(t=(0,Oe.resolveUrl)(this.opts.uriResolver,t,l))}let a;if(typeof r!="boolean"&&r.$ref&&!(0,ps.schemaHasRulesButRef)(r,this.RULES)){const u=(0,Oe.resolveUrl)(this.opts.uriResolver,t,r.$ref);a=Ir.call(this,n,u)}const{schemaId:o}=this.opts;if(a=a||new Rr({schema:r,schemaId:o,root:n,baseId:t}),a.schema!==a.root.schema)return a}const Bc="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",Kc="Meta-schema for $data reference (JSON AnySchema extension proposal)",xc="object",Jc=["$data"],Qc={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},Xc=!1,Yc={$id:Bc,description:Kc,type:xc,required:Jc,properties:Qc,additionalProperties:Xc};var dn={},Qr={exports:{}};/** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */(function(e,t){(function(r,n){n(t)})(no,function(r){function n(){for(var p=arguments.length,c=Array(p),m=0;m<p;m++)c[m]=arguments[m];if(c.length>1){c[0]=c[0].slice(0,-1);for(var P=c.length-1,S=1;S<P;++S)c[S]=c[S].slice(1,-1);return c[P]=c[P].slice(1),c.join("")}else return c[0]}function s(p){return"(?:"+p+")"}function a(p){return p===void 0?"undefined":p===null?"null":Object.prototype.toString.call(p).split(" ").pop().split("]").shift().toLowerCase()}function o(p){return p.toUpperCase()}function u(p){return p!=null?p instanceof Array?p:typeof p.length!="number"||p.split||p.setInterval||p.call?[p]:Array.prototype.slice.call(p):[]}function d(p,c){var m=p;if(c)for(var P in c)m[P]=c[P];return m}function l(p){var c="[A-Za-z]",m="[0-9]",P=n(m,"[A-Fa-f]"),S=s(s("%[EFef]"+P+"%"+P+P+"%"+P+P)+"|"+s("%[89A-Fa-f]"+P+"%"+P+P)+"|"+s("%"+P+P)),V="[\\:\\/\\?\\#\\[\\]\\@]",z="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",Y=n(V,z),te=p?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",ie=p?"[\\uE000-\\uF8FF]":"[]",J=n(c,m,"[\\-\\.\\_\\~]",te);s(c+n(c,m,"[\\+\\-\\.]")+"*"),s(s(S+"|"+n(J,z,"[\\:]"))+"*");var ee=s(s("25[0-5]")+"|"+s("2[0-4]"+m)+"|"+s("1"+m+m)+"|"+s("0?[1-9]"+m)+"|0?0?"+m),ce=s(ee+"\\."+ee+"\\."+ee+"\\."+ee),H=s(P+"{1,4}"),ne=s(s(H+"\\:"+H)+"|"+ce),fe=s(s(H+"\\:")+"{6}"+ne),se=s("\\:\\:"+s(H+"\\:")+"{5}"+ne),xe=s(s(H)+"?\\:\\:"+s(H+"\\:")+"{4}"+ne),je=s(s(s(H+"\\:")+"{0,1}"+H)+"?\\:\\:"+s(H+"\\:")+"{3}"+ne),Me=s(s(s(H+"\\:")+"{0,2}"+H)+"?\\:\\:"+s(H+"\\:")+"{2}"+ne),wt=s(s(s(H+"\\:")+"{0,3}"+H)+"?\\:\\:"+H+"\\:"+ne),st=s(s(s(H+"\\:")+"{0,4}"+H)+"?\\:\\:"+ne),Se=s(s(s(H+"\\:")+"{0,5}"+H)+"?\\:\\:"+H),Le=s(s(s(H+"\\:")+"{0,6}"+H)+"?\\:\\:"),at=s([fe,se,xe,je,Me,wt,st,Se,Le].join("|")),He=s(s(J+"|"+S)+"+");s("[vV]"+P+"+\\."+n(J,z,"[\\:]")+"+"),s(s(S+"|"+n(J,z))+"*");var Vt=s(S+"|"+n(J,z,"[\\:\\@]"));return s(s(S+"|"+n(J,z,"[\\@]"))+"+"),s(s(Vt+"|"+n("[\\/\\?]",ie))+"*"),{NOT_SCHEME:new RegExp(n("[^]",c,m,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(n("[^\\%\\:]",J,z),"g"),NOT_HOST:new RegExp(n("[^\\%\\[\\]\\:]",J,z),"g"),NOT_PATH:new RegExp(n("[^\\%\\/\\:\\@]",J,z),"g"),NOT_PATH_NOSCHEME:new RegExp(n("[^\\%\\/\\@]",J,z),"g"),NOT_QUERY:new RegExp(n("[^\\%]",J,z,"[\\:\\@\\/\\?]",ie),"g"),NOT_FRAGMENT:new RegExp(n("[^\\%]",J,z,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(n("[^]",J,z),"g"),UNRESERVED:new RegExp(J,"g"),OTHER_CHARS:new RegExp(n("[^\\%]",J,Y),"g"),PCT_ENCODED:new RegExp(S,"g"),IPV4ADDRESS:new RegExp("^("+ce+")$"),IPV6ADDRESS:new RegExp("^\\[?("+at+")"+s(s("\\%25|\\%(?!"+P+"{2})")+"("+He+")")+"?\\]?$")}}var f=l(!1),y=l(!0),T=function(){function p(c,m){var P=[],S=!0,V=!1,z=void 0;try{for(var Y=c[Symbol.iterator](),te;!(S=(te=Y.next()).done)&&(P.push(te.value),!(m&&P.length===m));S=!0);}catch(ie){V=!0,z=ie}finally{try{!S&&Y.return&&Y.return()}finally{if(V)throw z}}return P}return function(c,m){if(Array.isArray(c))return c;if(Symbol.iterator in Object(c))return p(c,m);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),g=function(p){if(Array.isArray(p)){for(var c=0,m=Array(p.length);c<p.length;c++)m[c]=p[c];return m}else return Array.from(p)},w=2147483647,k=36,_=1,$=26,N=38,C=700,I=72,j=128,E="-",O=/^xn--/,D=/[^\0-\x7E]/,W=/[\x2E\u3002\uFF0E\uFF61]/g,K={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},ae=k-_,X=Math.floor,Ee=String.fromCharCode;function de(p){throw new RangeError(K[p])}function et(p,c){for(var m=[],P=p.length;P--;)m[P]=c(p[P]);return m}function tt(p,c){var m=p.split("@"),P="";m.length>1&&(P=m[0]+"@",p=m[1]),p=p.replace(W,".");var S=p.split("."),V=et(S,c).join(".");return P+V}function pt(p){for(var c=[],m=0,P=p.length;m<P;){var S=p.charCodeAt(m++);if(S>=55296&&S<=56319&&m<P){var V=p.charCodeAt(m++);(V&64512)==56320?c.push(((S&1023)<<10)+(V&1023)+65536):(c.push(S),m--)}else c.push(S)}return c}var It=function(c){return String.fromCodePoint.apply(String,g(c))},ht=function(c){return c-48<10?c-22:c-65<26?c-65:c-97<26?c-97:k},M=function(c,m){return c+22+75*(c<26)-((m!=0)<<5)},v=function(c,m,P){var S=0;for(c=P?X(c/C):c>>1,c+=X(c/m);c>ae*$>>1;S+=k)c=X(c/ae);return X(S+(ae+1)*c/(c+N))},A=function(c){var m=[],P=c.length,S=0,V=j,z=I,Y=c.lastIndexOf(E);Y<0&&(Y=0);for(var te=0;te<Y;++te)c.charCodeAt(te)>=128&&de("not-basic"),m.push(c.charCodeAt(te));for(var ie=Y>0?Y+1:0;ie<P;){for(var J=S,ee=1,ce=k;;ce+=k){ie>=P&&de("invalid-input");var H=ht(c.charCodeAt(ie++));(H>=k||H>X((w-S)/ee))&&de("overflow"),S+=H*ee;var ne=ce<=z?_:ce>=z+$?$:ce-z;if(H<ne)break;var fe=k-ne;ee>X(w/fe)&&de("overflow"),ee*=fe}var se=m.length+1;z=v(S-J,se,J==0),X(S/se)>w-V&&de("overflow"),V+=X(S/se),S%=se,m.splice(S++,0,V)}return String.fromCodePoint.apply(String,m)},b=function(c){var m=[];c=pt(c);var P=c.length,S=j,V=0,z=I,Y=!0,te=!1,ie=void 0;try{for(var J=c[Symbol.iterator](),ee;!(Y=(ee=J.next()).done);Y=!0){var ce=ee.value;ce<128&&m.push(Ee(ce))}}catch(zt){te=!0,ie=zt}finally{try{!Y&&J.return&&J.return()}finally{if(te)throw ie}}var H=m.length,ne=H;for(H&&m.push(E);ne<P;){var fe=w,se=!0,xe=!1,je=void 0;try{for(var Me=c[Symbol.iterator](),wt;!(se=(wt=Me.next()).done);se=!0){var st=wt.value;st>=S&&st<fe&&(fe=st)}}catch(zt){xe=!0,je=zt}finally{try{!se&&Me.return&&Me.return()}finally{if(xe)throw je}}var Se=ne+1;fe-S>X((w-V)/Se)&&de("overflow"),V+=(fe-S)*Se,S=fe;var Le=!0,at=!1,He=void 0;try{for(var Vt=c[Symbol.iterator](),Xn;!(Le=(Xn=Vt.next()).done);Le=!0){var Yn=Xn.value;if(Yn<S&&++V>w&&de("overflow"),Yn==S){for(var sr=V,ar=k;;ar+=k){var or=ar<=z?_:ar>=z+$?$:ar-z;if(sr<or)break;var Zn=sr-or,es=k-or;m.push(Ee(M(or+Zn%es,0))),sr=X(Zn/es)}m.push(Ee(M(sr,0))),z=v(V,Se,ne==H),V=0,++ne}}}catch(zt){at=!0,He=zt}finally{try{!Le&&Vt.return&&Vt.return()}finally{if(at)throw He}}++V,++S}return m.join("")},i=function(c){return tt(c,function(m){return O.test(m)?A(m.slice(4).toLowerCase()):m})},h=function(c){return tt(c,function(m){return D.test(m)?"xn--"+b(m):m})},R={version:"2.1.0",ucs2:{decode:pt,encode:It},decode:A,encode:b,toASCII:h,toUnicode:i},L={};function F(p){var c=p.charCodeAt(0),m=void 0;return c<16?m="%0"+c.toString(16).toUpperCase():c<128?m="%"+c.toString(16).toUpperCase():c<2048?m="%"+(c>>6|192).toString(16).toUpperCase()+"%"+(c&63|128).toString(16).toUpperCase():m="%"+(c>>12|224).toString(16).toUpperCase()+"%"+(c>>6&63|128).toString(16).toUpperCase()+"%"+(c&63|128).toString(16).toUpperCase(),m}function x(p){for(var c="",m=0,P=p.length;m<P;){var S=parseInt(p.substr(m+1,2),16);if(S<128)c+=String.fromCharCode(S),m+=3;else if(S>=194&&S<224){if(P-m>=6){var V=parseInt(p.substr(m+4,2),16);c+=String.fromCharCode((S&31)<<6|V&63)}else c+=p.substr(m,6);m+=6}else if(S>=224){if(P-m>=9){var z=parseInt(p.substr(m+4,2),16),Y=parseInt(p.substr(m+7,2),16);c+=String.fromCharCode((S&15)<<12|(z&63)<<6|Y&63)}else c+=p.substr(m,9);m+=9}else c+=p.substr(m,3),m+=3}return c}function Q(p,c){function m(P){var S=x(P);return S.match(c.UNRESERVED)?S:P}return p.scheme&&(p.scheme=String(p.scheme).replace(c.PCT_ENCODED,m).toLowerCase().replace(c.NOT_SCHEME,"")),p.userinfo!==void 0&&(p.userinfo=String(p.userinfo).replace(c.PCT_ENCODED,m).replace(c.NOT_USERINFO,F).replace(c.PCT_ENCODED,o)),p.host!==void 0&&(p.host=String(p.host).replace(c.PCT_ENCODED,m).toLowerCase().replace(c.NOT_HOST,F).replace(c.PCT_ENCODED,o)),p.path!==void 0&&(p.path=String(p.path).replace(c.PCT_ENCODED,m).replace(p.scheme?c.NOT_PATH:c.NOT_PATH_NOSCHEME,F).replace(c.PCT_ENCODED,o)),p.query!==void 0&&(p.query=String(p.query).replace(c.PCT_ENCODED,m).replace(c.NOT_QUERY,F).replace(c.PCT_ENCODED,o)),p.fragment!==void 0&&(p.fragment=String(p.fragment).replace(c.PCT_ENCODED,m).replace(c.NOT_FRAGMENT,F).replace(c.PCT_ENCODED,o)),p}function oe(p){return p.replace(/^0*(.*)/,"$1")||"0"}function Ie(p,c){var m=p.match(c.IPV4ADDRESS)||[],P=T(m,2),S=P[1];return S?S.split(".").map(oe).join("."):p}function mt(p,c){var m=p.match(c.IPV6ADDRESS)||[],P=T(m,3),S=P[1],V=P[2];if(S){for(var z=S.toLowerCase().split("::").reverse(),Y=T(z,2),te=Y[0],ie=Y[1],J=ie?ie.split(":").map(oe):[],ee=te.split(":").map(oe),ce=c.IPV4ADDRESS.test(ee[ee.length-1]),H=ce?7:8,ne=ee.length-H,fe=Array(H),se=0;se<H;++se)fe[se]=J[se]||ee[ne+se]||"";ce&&(fe[H-1]=Ie(fe[H-1],c));var xe=fe.reduce(function(Se,Le,at){if(!Le||Le==="0"){var He=Se[Se.length-1];He&&He.index+He.length===at?He.length++:Se.push({index:at,length:1})}return Se},[]),je=xe.sort(function(Se,Le){return Le.length-Se.length})[0],Me=void 0;if(je&&je.length>1){var wt=fe.slice(0,je.index),st=fe.slice(je.index+je.length);Me=wt.join(":")+"::"+st.join(":")}else Me=fe.join(":");return V&&(Me+="%"+V),Me}else return p}var At=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,Dt="".match(/(){0}/)[1]===void 0;function we(p){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},m={},P=c.iri!==!1?y:f;c.reference==="suffix"&&(p=(c.scheme?c.scheme+":":"")+"//"+p);var S=p.match(At);if(S){Dt?(m.scheme=S[1],m.userinfo=S[3],m.host=S[4],m.port=parseInt(S[5],10),m.path=S[6]||"",m.query=S[7],m.fragment=S[8],isNaN(m.port)&&(m.port=S[5])):(m.scheme=S[1]||void 0,m.userinfo=p.indexOf("@")!==-1?S[3]:void 0,m.host=p.indexOf("//")!==-1?S[4]:void 0,m.port=parseInt(S[5],10),m.path=S[6]||"",m.query=p.indexOf("?")!==-1?S[7]:void 0,m.fragment=p.indexOf("#")!==-1?S[8]:void 0,isNaN(m.port)&&(m.port=p.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?S[4]:void 0)),m.host&&(m.host=mt(Ie(m.host,P),P)),m.scheme===void 0&&m.userinfo===void 0&&m.host===void 0&&m.port===void 0&&!m.path&&m.query===void 0?m.reference="same-document":m.scheme===void 0?m.reference="relative":m.fragment===void 0?m.reference="absolute":m.reference="uri",c.reference&&c.reference!=="suffix"&&c.reference!==m.reference&&(m.error=m.error||"URI is not a "+c.reference+" reference.");var V=L[(c.scheme||m.scheme||"").toLowerCase()];if(!c.unicodeSupport&&(!V||!V.unicodeSupport)){if(m.host&&(c.domainHost||V&&V.domainHost))try{m.host=R.toASCII(m.host.replace(P.PCT_ENCODED,x).toLowerCase())}catch(z){m.error=m.error||"Host's domain name can not be converted to ASCII via punycode: "+z}Q(m,f)}else Q(m,P);V&&V.parse&&V.parse(m,c)}else m.error=m.error||"URI can not be parsed.";return m}function jt(p,c){var m=c.iri!==!1?y:f,P=[];return p.userinfo!==void 0&&(P.push(p.userinfo),P.push("@")),p.host!==void 0&&P.push(mt(Ie(String(p.host),m),m).replace(m.IPV6ADDRESS,function(S,V,z){return"["+V+(z?"%25"+z:"")+"]"})),(typeof p.port=="number"||typeof p.port=="string")&&(P.push(":"),P.push(String(p.port))),P.length?P.join(""):void 0}var yt=/^\.\.?\//,$t=/^\/\.(\/|$)/,gt=/^\/\.\.(\/|$)/,Mt=/^\/?(?:.|\n)*?(?=\/|$)/;function Ae(p){for(var c=[];p.length;)if(p.match(yt))p=p.replace(yt,"");else if(p.match($t))p=p.replace($t,"/");else if(p.match(gt))p=p.replace(gt,"/"),c.pop();else if(p==="."||p==="..")p="";else{var m=p.match(Mt);if(m){var P=m[0];p=p.slice(P.length),c.push(P)}else throw new Error("Unexpected dot segment condition")}return c.join("")}function ge(p){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},m=c.iri?y:f,P=[],S=L[(c.scheme||p.scheme||"").toLowerCase()];if(S&&S.serialize&&S.serialize(p,c),p.host&&!m.IPV6ADDRESS.test(p.host)){if(c.domainHost||S&&S.domainHost)try{p.host=c.iri?R.toUnicode(p.host):R.toASCII(p.host.replace(m.PCT_ENCODED,x).toLowerCase())}catch(Y){p.error=p.error||"Host's domain name can not be converted to "+(c.iri?"Unicode":"ASCII")+" via punycode: "+Y}}Q(p,m),c.reference!=="suffix"&&p.scheme&&(P.push(p.scheme),P.push(":"));var V=jt(p,c);if(V!==void 0&&(c.reference!=="suffix"&&P.push("//"),P.push(V),p.path&&p.path.charAt(0)!=="/"&&P.push("/")),p.path!==void 0){var z=p.path;!c.absolutePath&&(!S||!S.absolutePath)&&(z=Ae(z)),V===void 0&&(z=z.replace(/^\/\//,"/%2F")),P.push(z)}return p.query!==void 0&&(P.push("?"),P.push(p.query)),p.fragment!==void 0&&(P.push("#"),P.push(p.fragment)),P.join("")}function _t(p,c){var m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},P=arguments[3],S={};return P||(p=we(ge(p,m),m),c=we(ge(c,m),m)),m=m||{},!m.tolerant&&c.scheme?(S.scheme=c.scheme,S.userinfo=c.userinfo,S.host=c.host,S.port=c.port,S.path=Ae(c.path||""),S.query=c.query):(c.userinfo!==void 0||c.host!==void 0||c.port!==void 0?(S.userinfo=c.userinfo,S.host=c.host,S.port=c.port,S.path=Ae(c.path||""),S.query=c.query):(c.path?(c.path.charAt(0)==="/"?S.path=Ae(c.path):((p.userinfo!==void 0||p.host!==void 0||p.port!==void 0)&&!p.path?S.path="/"+c.path:p.path?S.path=p.path.slice(0,p.path.lastIndexOf("/")+1)+c.path:S.path=c.path,S.path=Ae(S.path)),S.query=c.query):(S.path=p.path,c.query!==void 0?S.query=c.query:S.query=p.query),S.userinfo=p.userinfo,S.host=p.host,S.port=p.port),S.scheme=p.scheme),S.fragment=c.fragment,S}function Lt(p,c,m){var P=d({scheme:"null"},m);return ge(_t(we(p,P),we(c,P),P,!0),P)}function rt(p,c){return typeof p=="string"?p=ge(we(p,c),c):a(p)==="object"&&(p=we(ge(p,c),c)),p}function Ft(p,c,m){return typeof p=="string"?p=ge(we(p,m),m):a(p)==="object"&&(p=ge(p,m)),typeof c=="string"?c=ge(we(c,m),m):a(c)==="object"&&(c=ge(c,m)),p===c}function nr(p,c){return p&&p.toString().replace(!c||!c.iri?f.ESCAPE:y.ESCAPE,F)}function be(p,c){return p&&p.toString().replace(!c||!c.iri?f.PCT_ENCODED:y.PCT_ENCODED,x)}var nt={scheme:"http",domainHost:!0,parse:function(c,m){return c.host||(c.error=c.error||"HTTP URIs must have a host."),c},serialize:function(c,m){var P=String(c.scheme).toLowerCase()==="https";return(c.port===(P?443:80)||c.port==="")&&(c.port=void 0),c.path||(c.path="/"),c}},Wn={scheme:"https",domainHost:nt.domainHost,parse:nt.parse,serialize:nt.serialize};function Hn(p){return typeof p.secure=="boolean"?p.secure:String(p.scheme).toLowerCase()==="wss"}var Ut={scheme:"ws",domainHost:!0,parse:function(c,m){var P=c;return P.secure=Hn(P),P.resourceName=(P.path||"/")+(P.query?"?"+P.query:""),P.path=void 0,P.query=void 0,P},serialize:function(c,m){if((c.port===(Hn(c)?443:80)||c.port==="")&&(c.port=void 0),typeof c.secure=="boolean"&&(c.scheme=c.secure?"wss":"ws",c.secure=void 0),c.resourceName){var P=c.resourceName.split("?"),S=T(P,2),V=S[0],z=S[1];c.path=V&&V!=="/"?V:void 0,c.query=z,c.resourceName=void 0}return c.fragment=void 0,c}},Gn={scheme:"wss",domainHost:Ut.domainHost,parse:Ut.parse,serialize:Ut.serialize},Ia={},Bn="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",De="[0-9A-Fa-f]",Aa=s(s("%[EFef]"+De+"%"+De+De+"%"+De+De)+"|"+s("%[89A-Fa-f]"+De+"%"+De+De)+"|"+s("%"+De+De)),Da="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",ja="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",Ma=n(ja,'[\\"\\\\]'),La="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",Fa=new RegExp(Bn,"g"),vt=new RegExp(Aa,"g"),Ua=new RegExp(n("[^]",Da,"[\\.]",'[\\"]',Ma),"g"),Kn=new RegExp(n("[^]",Bn,La),"g"),Va=Kn;function Dr(p){var c=x(p);return c.match(Fa)?c:p}var xn={scheme:"mailto",parse:function(c,m){var P=c,S=P.to=P.path?P.path.split(","):[];if(P.path=void 0,P.query){for(var V=!1,z={},Y=P.query.split("&"),te=0,ie=Y.length;te<ie;++te){var J=Y[te].split("=");switch(J[0]){case"to":for(var ee=J[1].split(","),ce=0,H=ee.length;ce<H;++ce)S.push(ee[ce]);break;case"subject":P.subject=be(J[1],m);break;case"body":P.body=be(J[1],m);break;default:V=!0,z[be(J[0],m)]=be(J[1],m);break}}V&&(P.headers=z)}P.query=void 0;for(var ne=0,fe=S.length;ne<fe;++ne){var se=S[ne].split("@");if(se[0]=be(se[0]),m.unicodeSupport)se[1]=be(se[1],m).toLowerCase();else try{se[1]=R.toASCII(be(se[1],m).toLowerCase())}catch(xe){P.error=P.error||"Email address's domain name can not be converted to ASCII via punycode: "+xe}S[ne]=se.join("@")}return P},serialize:function(c,m){var P=c,S=u(c.to);if(S){for(var V=0,z=S.length;V<z;++V){var Y=String(S[V]),te=Y.lastIndexOf("@"),ie=Y.slice(0,te).replace(vt,Dr).replace(vt,o).replace(Ua,F),J=Y.slice(te+1);try{J=m.iri?R.toUnicode(J):R.toASCII(be(J,m).toLowerCase())}catch(ne){P.error=P.error||"Email address's domain name can not be converted to "+(m.iri?"Unicode":"ASCII")+" via punycode: "+ne}S[V]=ie+"@"+J}P.path=S.join(",")}var ee=c.headers=c.headers||{};c.subject&&(ee.subject=c.subject),c.body&&(ee.body=c.body);var ce=[];for(var H in ee)ee[H]!==Ia[H]&&ce.push(H.replace(vt,Dr).replace(vt,o).replace(Kn,F)+"="+ee[H].replace(vt,Dr).replace(vt,o).replace(Va,F));return ce.length&&(P.query=ce.join("&")),P}},za=/^([^\:]+)\:(.*)/,Jn={scheme:"urn",parse:function(c,m){var P=c.path&&c.path.match(za),S=c;if(P){var V=m.scheme||S.scheme||"urn",z=P[1].toLowerCase(),Y=P[2],te=V+":"+(m.nid||z),ie=L[te];S.nid=z,S.nss=Y,S.path=void 0,ie&&(S=ie.parse(S,m))}else S.error=S.error||"URN can not be parsed.";return S},serialize:function(c,m){var P=m.scheme||c.scheme||"urn",S=c.nid,V=P+":"+(m.nid||S),z=L[V];z&&(c=z.serialize(c,m));var Y=c,te=c.nss;return Y.path=(S||m.nid)+":"+te,Y}},qa=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,Qn={scheme:"urn:uuid",parse:function(c,m){var P=c;return P.uuid=P.nss,P.nss=void 0,!m.tolerant&&(!P.uuid||!P.uuid.match(qa))&&(P.error=P.error||"UUID is not valid."),P},serialize:function(c,m){var P=c;return P.nss=(c.uuid||"").toLowerCase(),P}};L[nt.scheme]=nt,L[Wn.scheme]=Wn,L[Ut.scheme]=Ut,L[Gn.scheme]=Gn,L[xn.scheme]=xn,L[Jn.scheme]=Jn,L[Qn.scheme]=Qn,r.SCHEMES=L,r.pctEncChar=F,r.pctDecChars=x,r.parse=we,r.removeDotSegments=Ae,r.serialize=ge,r.resolveComponents=_t,r.resolve=Lt,r.normalize=rt,r.equal=Ft,r.escapeComponent=nr,r.unescapeComponent=be,Object.defineProperty(r,"__esModule",{value:!0})})})(Qr,Qr.exports);var Zc=Qr.exports;Object.defineProperty(dn,"__esModule",{value:!0});const wa=Zc;wa.code='require("ajv/dist/runtime/uri").default';dn.default=wa;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=void 0;var t=Re;Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return t.KeywordCxt}});var r=B;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return r.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return r.CodeGen}});const n=er,s=tr,a=dt,o=ve,u=B,d=me,l=Zt,f=Z,y=Yc,T=dn,g=(M,v)=>new RegExp(M,v);g.code="new RegExp";const w=["removeAdditional","useDefaults","coerceTypes"],k=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),_={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},$={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},N=200;function C(M){var v,A,b,i,h,R,L,F,x,Q,oe,Ie,mt,At,Dt,we,jt,yt,$t,gt,Mt,Ae,ge,_t,Lt;const rt=M.strict,Ft=(v=M.code)===null||v===void 0?void 0:v.optimize,nr=Ft===!0||Ft===void 0?1:Ft||0,be=(b=(A=M.code)===null||A===void 0?void 0:A.regExp)!==null&&b!==void 0?b:g,nt=(i=M.uriResolver)!==null&&i!==void 0?i:T.default;return{strictSchema:(R=(h=M.strictSchema)!==null&&h!==void 0?h:rt)!==null&&R!==void 0?R:!0,strictNumbers:(F=(L=M.strictNumbers)!==null&&L!==void 0?L:rt)!==null&&F!==void 0?F:!0,strictTypes:(Q=(x=M.strictTypes)!==null&&x!==void 0?x:rt)!==null&&Q!==void 0?Q:"log",strictTuples:(Ie=(oe=M.strictTuples)!==null&&oe!==void 0?oe:rt)!==null&&Ie!==void 0?Ie:"log",strictRequired:(At=(mt=M.strictRequired)!==null&&mt!==void 0?mt:rt)!==null&&At!==void 0?At:!1,code:M.code?{...M.code,optimize:nr,regExp:be}:{optimize:nr,regExp:be},loopRequired:(Dt=M.loopRequired)!==null&&Dt!==void 0?Dt:N,loopEnum:(we=M.loopEnum)!==null&&we!==void 0?we:N,meta:(jt=M.meta)!==null&&jt!==void 0?jt:!0,messages:(yt=M.messages)!==null&&yt!==void 0?yt:!0,inlineRefs:($t=M.inlineRefs)!==null&&$t!==void 0?$t:!0,schemaId:(gt=M.schemaId)!==null&&gt!==void 0?gt:"$id",addUsedSchema:(Mt=M.addUsedSchema)!==null&&Mt!==void 0?Mt:!0,validateSchema:(Ae=M.validateSchema)!==null&&Ae!==void 0?Ae:!0,validateFormats:(ge=M.validateFormats)!==null&&ge!==void 0?ge:!0,unicodeRegExp:(_t=M.unicodeRegExp)!==null&&_t!==void 0?_t:!0,int32range:(Lt=M.int32range)!==null&&Lt!==void 0?Lt:!0,uriResolver:nt}}class I{constructor(v={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,v=this.opts={...v,...C(v)};const{es5:A,lines:b}=this.opts.code;this.scope=new u.ValueScope({scope:{},prefixes:k,es5:A,lines:b}),this.logger=X(v.logger);const i=v.validateFormats;v.validateFormats=!1,this.RULES=(0,a.getRules)(),j.call(this,_,v,"NOT SUPPORTED"),j.call(this,$,v,"DEPRECATED","warn"),this._metaOpts=K.call(this),v.formats&&D.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),v.keywords&&W.call(this,v.keywords),typeof v.meta=="object"&&this.addMetaSchema(v.meta),O.call(this),v.validateFormats=i}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:v,meta:A,schemaId:b}=this.opts;let i=y;b==="id"&&(i={...y},i.id=i.$id,delete i.$id),A&&v&&this.addMetaSchema(i,i[b],!1)}defaultMeta(){const{meta:v,schemaId:A}=this.opts;return this.opts.defaultMeta=typeof v=="object"?v[A]||v:void 0}validate(v,A){let b;if(typeof v=="string"){if(b=this.getSchema(v),!b)throw new Error(`no schema with key or ref "${v}"`)}else b=this.compile(v);const i=b(A);return"$async"in b||(this.errors=b.errors),i}compile(v,A){const b=this._addSchema(v,A);return b.validate||this._compileSchemaEnv(b)}compileAsync(v,A){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:b}=this.opts;return i.call(this,v,A);async function i(Q,oe){await h.call(this,Q.$schema);const Ie=this._addSchema(Q,oe);return Ie.validate||R.call(this,Ie)}async function h(Q){Q&&!this.getSchema(Q)&&await i.call(this,{$ref:Q},!0)}async function R(Q){try{return this._compileSchemaEnv(Q)}catch(oe){if(!(oe instanceof s.default))throw oe;return L.call(this,oe),await F.call(this,oe.missingSchema),R.call(this,Q)}}function L({missingSchema:Q,missingRef:oe}){if(this.refs[Q])throw new Error(`AnySchema ${Q} is loaded but ${oe} cannot be resolved`)}async function F(Q){const oe=await x.call(this,Q);this.refs[Q]||await h.call(this,oe.$schema),this.refs[Q]||this.addSchema(oe,Q,A)}async function x(Q){const oe=this._loading[Q];if(oe)return oe;try{return await(this._loading[Q]=b(Q))}finally{delete this._loading[Q]}}}addSchema(v,A,b,i=this.opts.validateSchema){if(Array.isArray(v)){for(const R of v)this.addSchema(R,void 0,b,i);return this}let h;if(typeof v=="object"){const{schemaId:R}=this.opts;if(h=v[R],h!==void 0&&typeof h!="string")throw new Error(`schema ${R} must be string`)}return A=(0,d.normalizeId)(A||h),this._checkUnique(A),this.schemas[A]=this._addSchema(v,b,A,i,!0),this}addMetaSchema(v,A,b=this.opts.validateSchema){return this.addSchema(v,A,!0,b),this}validateSchema(v,A){if(typeof v=="boolean")return!0;let b;if(b=v.$schema,b!==void 0&&typeof b!="string")throw new Error("$schema must be a string");if(b=b||this.opts.defaultMeta||this.defaultMeta(),!b)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const i=this.validate(b,v);if(!i&&A){const h="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(h);else throw new Error(h)}return i}getSchema(v){let A;for(;typeof(A=E.call(this,v))=="string";)v=A;if(A===void 0){const{schemaId:b}=this.opts,i=new o.SchemaEnv({schema:{},schemaId:b});if(A=o.resolveSchema.call(this,i,v),!A)return;this.refs[v]=A}return A.validate||this._compileSchemaEnv(A)}removeSchema(v){if(v instanceof RegExp)return this._removeAllSchemas(this.schemas,v),this._removeAllSchemas(this.refs,v),this;switch(typeof v){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const A=E.call(this,v);return typeof A=="object"&&this._cache.delete(A.schema),delete this.schemas[v],delete this.refs[v],this}case"object":{const A=v;this._cache.delete(A);let b=v[this.opts.schemaId];return b&&(b=(0,d.normalizeId)(b),delete this.schemas[b],delete this.refs[b]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(v){for(const A of v)this.addKeyword(A);return this}addKeyword(v,A){let b;if(typeof v=="string")b=v,typeof A=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),A.keyword=b);else if(typeof v=="object"&&A===void 0){if(A=v,b=A.keyword,Array.isArray(b)&&!b.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(de.call(this,b,A),!A)return(0,f.eachItem)(b,h=>et.call(this,h)),this;pt.call(this,A);const i={...A,type:(0,l.getJSONTypes)(A.type),schemaType:(0,l.getJSONTypes)(A.schemaType)};return(0,f.eachItem)(b,i.type.length===0?h=>et.call(this,h,i):h=>i.type.forEach(R=>et.call(this,h,i,R))),this}getKeyword(v){const A=this.RULES.all[v];return typeof A=="object"?A.definition:!!A}removeKeyword(v){const{RULES:A}=this;delete A.keywords[v],delete A.all[v];for(const b of A.rules){const i=b.rules.findIndex(h=>h.keyword===v);i>=0&&b.rules.splice(i,1)}return this}addFormat(v,A){return typeof A=="string"&&(A=new RegExp(A)),this.formats[v]=A,this}errorsText(v=this.errors,{separator:A=", ",dataVar:b="data"}={}){return!v||v.length===0?"No errors":v.map(i=>`${b}${i.instancePath} ${i.message}`).reduce((i,h)=>i+A+h)}$dataMetaSchema(v,A){const b=this.RULES.all;v=JSON.parse(JSON.stringify(v));for(const i of A){const h=i.split("/").slice(1);let R=v;for(const L of h)R=R[L];for(const L in b){const F=b[L];if(typeof F!="object")continue;const{$data:x}=F.definition,Q=R[L];x&&Q&&(R[L]=ht(Q))}}return v}_removeAllSchemas(v,A){for(const b in v){const i=v[b];(!A||A.test(b))&&(typeof i=="string"?delete v[b]:i&&!i.meta&&(this._cache.delete(i.schema),delete v[b]))}}_addSchema(v,A,b,i=this.opts.validateSchema,h=this.opts.addUsedSchema){let R;const{schemaId:L}=this.opts;if(typeof v=="object")R=v[L];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof v!="boolean")throw new Error("schema must be object or boolean")}let F=this._cache.get(v);if(F!==void 0)return F;b=(0,d.normalizeId)(R||b);const x=d.getSchemaRefs.call(this,v,b);return F=new o.SchemaEnv({schema:v,schemaId:L,meta:A,baseId:b,localRefs:x}),this._cache.set(F.schema,F),h&&!b.startsWith("#")&&(b&&this._checkUnique(b),this.refs[b]=F),i&&this.validateSchema(v,!0),F}_checkUnique(v){if(this.schemas[v]||this.refs[v])throw new Error(`schema with key or id "${v}" already exists`)}_compileSchemaEnv(v){if(v.meta?this._compileMetaSchema(v):o.compileSchema.call(this,v),!v.validate)throw new Error("ajv implementation error");return v.validate}_compileMetaSchema(v){const A=this.opts;this.opts=this._metaOpts;try{o.compileSchema.call(this,v)}finally{this.opts=A}}}e.default=I,I.ValidationError=n.default,I.MissingRefError=s.default;function j(M,v,A,b="error"){for(const i in M){const h=i;h in v&&this.logger[b](`${A}: option ${i}. ${M[h]}`)}}function E(M){return M=(0,d.normalizeId)(M),this.schemas[M]||this.refs[M]}function O(){const M=this.opts.schemas;if(M)if(Array.isArray(M))this.addSchema(M);else for(const v in M)this.addSchema(M[v],v)}function D(){for(const M in this.opts.formats){const v=this.opts.formats[M];v&&this.addFormat(M,v)}}function W(M){if(Array.isArray(M)){this.addVocabulary(M);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const v in M){const A=M[v];A.keyword||(A.keyword=v),this.addKeyword(A)}}function K(){const M={...this.opts};for(const v of w)delete M[v];return M}const ae={log(){},warn(){},error(){}};function X(M){if(M===!1)return ae;if(M===void 0)return console;if(M.log&&M.warn&&M.error)return M;throw new Error("logger must implement log, warn and error methods")}const Ee=/^[a-z_$][a-z0-9_$:-]*$/i;function de(M,v){const{RULES:A}=this;if((0,f.eachItem)(M,b=>{if(A.keywords[b])throw new Error(`Keyword ${b} is already defined`);if(!Ee.test(b))throw new Error(`Keyword ${b} has invalid name`)}),!!v&&v.$data&&!("code"in v||"validate"in v))throw new Error('$data keyword must have "code" or "validate" function')}function et(M,v,A){var b;const i=v?.post;if(A&&i)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:h}=this;let R=i?h.post:h.rules.find(({type:F})=>F===A);if(R||(R={type:A,rules:[]},h.rules.push(R)),h.keywords[M]=!0,!v)return;const L={keyword:M,definition:{...v,type:(0,l.getJSONTypes)(v.type),schemaType:(0,l.getJSONTypes)(v.schemaType)}};v.before?tt.call(this,R,L,v.before):R.rules.push(L),h.all[M]=L,(b=v.implements)===null||b===void 0||b.forEach(F=>this.addKeyword(F))}function tt(M,v,A){const b=M.rules.findIndex(i=>i.keyword===A);b>=0?M.rules.splice(b,0,v):(M.rules.push(v),this.logger.warn(`rule ${A} is not defined`))}function pt(M){let{metaSchema:v}=M;v!==void 0&&(M.$data&&this.opts.$data&&(v=ht(v)),M.validateSchema=this.compile(v,!0))}const It={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function ht(M){return{anyOf:[M,It]}}})(Qs);var fn={},pn={},hn={};Object.defineProperty(hn,"__esModule",{value:!0});const eu={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};hn.default=eu;var ft={};Object.defineProperty(ft,"__esModule",{value:!0});ft.callRef=ft.getValidate=void 0;const tu=tr,hs=G,_e=B,bt=We,ms=ve,cr=Z,ru={keyword:"$ref",schemaType:"string",code(e){const{gen:t,schema:r,it:n}=e,{baseId:s,schemaEnv:a,validateName:o,opts:u,self:d}=n,{root:l}=a;if((r==="#"||r==="#/")&&s===l.baseId)return y();const f=ms.resolveRef.call(d,l,s,r);if(f===void 0)throw new tu.default(n.opts.uriResolver,s,r);if(f instanceof ms.SchemaEnv)return T(f);return g(f);function y(){if(a===l)return mr(e,o,a,a.$async);const w=t.scopeValue("root",{ref:l});return mr(e,(0,_e._)`${w}.validate`,l,l.$async)}function T(w){const k=Ea(e,w);mr(e,k,w,w.$async)}function g(w){const k=t.scopeValue("schema",u.code.source===!0?{ref:w,code:(0,_e.stringify)(w)}:{ref:w}),_=t.name("valid"),$=e.subschema({schema:w,dataTypes:[],schemaPath:_e.nil,topSchemaRef:k,errSchemaPath:r},_);e.mergeEvaluated($),e.ok(_)}}};function Ea(e,t){const{gen:r}=e;return t.validate?r.scopeValue("validate",{ref:t.validate}):(0,_e._)`${r.scopeValue("wrapper",{ref:t})}.validate`}ft.getValidate=Ea;function mr(e,t,r,n){const{gen:s,it:a}=e,{allErrors:o,schemaEnv:u,opts:d}=a,l=d.passContext?bt.default.this:_e.nil;n?f():y();function f(){if(!u.$async)throw new Error("async schema referenced by sync schema");const w=s.let("valid");s.try(()=>{s.code((0,_e._)`await ${(0,hs.callValidateCode)(e,t,l)}`),g(t),o||s.assign(w,!0)},k=>{s.if((0,_e._)`!(${k} instanceof ${a.ValidationError})`,()=>s.throw(k)),T(k),o||s.assign(w,!1)}),e.ok(w)}function y(){e.result((0,hs.callValidateCode)(e,t,l),()=>g(t),()=>T(t))}function T(w){const k=(0,_e._)`${w}.errors`;s.assign(bt.default.vErrors,(0,_e._)`${bt.default.vErrors} === null ? ${k} : ${bt.default.vErrors}.concat(${k})`),s.assign(bt.default.errors,(0,_e._)`${bt.default.vErrors}.length`)}function g(w){var k;if(!a.opts.unevaluated)return;const _=(k=r?.validate)===null||k===void 0?void 0:k.evaluated;if(a.props!==!0)if(_&&!_.dynamicProps)_.props!==void 0&&(a.props=cr.mergeEvaluated.props(s,_.props,a.props));else{const $=s.var("props",(0,_e._)`${w}.evaluated.props`);a.props=cr.mergeEvaluated.props(s,$,a.props,_e.Name)}if(a.items!==!0)if(_&&!_.dynamicItems)_.items!==void 0&&(a.items=cr.mergeEvaluated.items(s,_.items,a.items));else{const $=s.var("items",(0,_e._)`${w}.evaluated.items`);a.items=cr.mergeEvaluated.items(s,$,a.items,_e.Name)}}}ft.callRef=mr;ft.default=ru;Object.defineProperty(pn,"__esModule",{value:!0});const nu=hn,su=ft,au=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",nu.default,su.default];pn.default=au;var mn={},yn={};Object.defineProperty(yn,"__esModule",{value:!0});const Sr=B,Qe=Sr.operators,Pr={maximum:{okStr:"<=",ok:Qe.LTE,fail:Qe.GT},minimum:{okStr:">=",ok:Qe.GTE,fail:Qe.LT},exclusiveMaximum:{okStr:"<",ok:Qe.LT,fail:Qe.GTE},exclusiveMinimum:{okStr:">",ok:Qe.GT,fail:Qe.LTE}},ou={message:({keyword:e,schemaCode:t})=>(0,Sr.str)`must be ${Pr[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>(0,Sr._)`{comparison: ${Pr[e].okStr}, limit: ${t}}`},iu={keyword:Object.keys(Pr),type:"number",schemaType:"number",$data:!0,error:ou,code(e){const{keyword:t,data:r,schemaCode:n}=e;e.fail$data((0,Sr._)`${r} ${Pr[t].fail} ${n} || isNaN(${r})`)}};yn.default=iu;var $n={};Object.defineProperty($n,"__esModule",{value:!0});const Bt=B,cu={message:({schemaCode:e})=>(0,Bt.str)`must be multiple of ${e}`,params:({schemaCode:e})=>(0,Bt._)`{multipleOf: ${e}}`},uu={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:cu,code(e){const{gen:t,data:r,schemaCode:n,it:s}=e,a=s.opts.multipleOfPrecision,o=t.let("res"),u=a?(0,Bt._)`Math.abs(Math.round(${o}) - ${o}) > 1e-${a}`:(0,Bt._)`${o} !== parseInt(${o})`;e.fail$data((0,Bt._)`(${n} === 0 || (${o} = ${r}/${n}, ${u}))`)}};$n.default=uu;var gn={},_n={};Object.defineProperty(_n,"__esModule",{value:!0});function ba(e){const t=e.length;let r=0,n=0,s;for(;n<t;)r++,s=e.charCodeAt(n++),s>=55296&&s<=56319&&n<t&&(s=e.charCodeAt(n),(s&64512)===56320&&n++);return r}_n.default=ba;ba.code='require("ajv/dist/runtime/ucs2length").default';Object.defineProperty(gn,"__esModule",{value:!0});const ut=B,lu=Z,du=_n,fu={message({keyword:e,schemaCode:t}){const r=e==="maxLength"?"more":"fewer";return(0,ut.str)`must NOT have ${r} than ${t} characters`},params:({schemaCode:e})=>(0,ut._)`{limit: ${e}}`},pu={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:fu,code(e){const{keyword:t,data:r,schemaCode:n,it:s}=e,a=t==="maxLength"?ut.operators.GT:ut.operators.LT,o=s.opts.unicode===!1?(0,ut._)`${r}.length`:(0,ut._)`${(0,lu.useFunc)(e.gen,du.default)}(${r})`;e.fail$data((0,ut._)`${o} ${a} ${n}`)}};gn.default=pu;var vn={};Object.defineProperty(vn,"__esModule",{value:!0});const hu=G,kr=B,mu={message:({schemaCode:e})=>(0,kr.str)`must match pattern "${e}"`,params:({schemaCode:e})=>(0,kr._)`{pattern: ${e}}`},yu={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:mu,code(e){const{data:t,$data:r,schema:n,schemaCode:s,it:a}=e,o=a.opts.unicodeRegExp?"u":"",u=r?(0,kr._)`(new RegExp(${s}, ${o}))`:(0,hu.usePattern)(e,n);e.fail$data((0,kr._)`!${u}.test(${t})`)}};vn.default=yu;var wn={};Object.defineProperty(wn,"__esModule",{value:!0});const Kt=B,$u={message({keyword:e,schemaCode:t}){const r=e==="maxProperties"?"more":"fewer";return(0,Kt.str)`must NOT have ${r} than ${t} properties`},params:({schemaCode:e})=>(0,Kt._)`{limit: ${e}}`},gu={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:$u,code(e){const{keyword:t,data:r,schemaCode:n}=e,s=t==="maxProperties"?Kt.operators.GT:Kt.operators.LT;e.fail$data((0,Kt._)`Object.keys(${r}).length ${s} ${n}`)}};wn.default=gu;var En={};Object.defineProperty(En,"__esModule",{value:!0});const Wt=G,xt=B,_u=Z,vu={message:({params:{missingProperty:e}})=>(0,xt.str)`must have required property '${e}'`,params:({params:{missingProperty:e}})=>(0,xt._)`{missingProperty: ${e}}`},wu={keyword:"required",type:"object",schemaType:"array",$data:!0,error:vu,code(e){const{gen:t,schema:r,schemaCode:n,data:s,$data:a,it:o}=e,{opts:u}=o;if(!a&&r.length===0)return;const d=r.length>=u.loopRequired;if(o.allErrors?l():f(),u.strictRequired){const g=e.parentSchema.properties,{definedProperties:w}=e.it;for(const k of r)if(g?.[k]===void 0&&!w.has(k)){const _=o.schemaEnv.baseId+o.errSchemaPath,$=`required property "${k}" is not defined at "${_}" (strictRequired)`;(0,_u.checkStrictMode)(o,$,o.opts.strictRequired)}}function l(){if(d||a)e.block$data(xt.nil,y);else for(const g of r)(0,Wt.checkReportMissingProp)(e,g)}function f(){const g=t.let("missing");if(d||a){const w=t.let("valid",!0);e.block$data(w,()=>T(g,w)),e.ok(w)}else t.if((0,Wt.checkMissingProp)(e,r,g)),(0,Wt.reportMissingProp)(e,g),t.else()}function y(){t.forOf("prop",n,g=>{e.setParams({missingProperty:g}),t.if((0,Wt.noPropertyInData)(t,s,g,u.ownProperties),()=>e.error())})}function T(g,w){e.setParams({missingProperty:g}),t.forOf(g,n,()=>{t.assign(w,(0,Wt.propertyInData)(t,s,g,u.ownProperties)),t.if((0,xt.not)(w),()=>{e.error(),t.break()})},xt.nil)}}};En.default=wu;var bn={};Object.defineProperty(bn,"__esModule",{value:!0});const Jt=B,Eu={message({keyword:e,schemaCode:t}){const r=e==="maxItems"?"more":"fewer";return(0,Jt.str)`must NOT have ${r} than ${t} items`},params:({schemaCode:e})=>(0,Jt._)`{limit: ${e}}`},bu={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:Eu,code(e){const{keyword:t,data:r,schemaCode:n}=e,s=t==="maxItems"?Jt.operators.GT:Jt.operators.LT;e.fail$data((0,Jt._)`${r}.length ${s} ${n}`)}};bn.default=bu;var Sn={},rr={};Object.defineProperty(rr,"__esModule",{value:!0});const Sa=sa;Sa.code='require("ajv/dist/runtime/equal").default';rr.default=Sa;Object.defineProperty(Sn,"__esModule",{value:!0});const Vr=Zt,he=B,Su=Z,Pu=rr,ku={message:({params:{i:e,j:t}})=>(0,he.str)`must NOT have duplicate items (items ## ${t} and ${e} are identical)`,params:({params:{i:e,j:t}})=>(0,he._)`{i: ${e}, j: ${t}}`},Tu={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:ku,code(e){const{gen:t,data:r,$data:n,schema:s,parentSchema:a,schemaCode:o,it:u}=e;if(!n&&!s)return;const d=t.let("valid"),l=a.items?(0,Vr.getSchemaTypes)(a.items):[];e.block$data(d,f,(0,he._)`${o} === false`),e.ok(d);function f(){const w=t.let("i",(0,he._)`${r}.length`),k=t.let("j");e.setParams({i:w,j:k}),t.assign(d,!0),t.if((0,he._)`${w} > 1`,()=>(y()?T:g)(w,k))}function y(){return l.length>0&&!l.some(w=>w==="object"||w==="array")}function T(w,k){const _=t.name("item"),$=(0,Vr.checkDataTypes)(l,_,u.opts.strictNumbers,Vr.DataType.Wrong),N=t.const("indices",(0,he._)`{}`);t.for((0,he._)`;${w}--;`,()=>{t.let(_,(0,he._)`${r}[${w}]`),t.if($,(0,he._)`continue`),l.length>1&&t.if((0,he._)`typeof ${_} == "string"`,(0,he._)`${_} += "_"`),t.if((0,he._)`typeof ${N}[${_}] == "number"`,()=>{t.assign(k,(0,he._)`${N}[${_}]`),e.error(),t.assign(d,!1).break()}).code((0,he._)`${N}[${_}] = ${w}`)})}function g(w,k){const _=(0,Su.useFunc)(t,Pu.default),$=t.name("outer");t.label($).for((0,he._)`;${w}--;`,()=>t.for((0,he._)`${k} = ${w}; ${k}--;`,()=>t.if((0,he._)`${_}(${r}[${w}], ${r}[${k}])`,()=>{e.error(),t.assign(d,!1).break($)})))}}};Sn.default=Tu;var Pn={};Object.defineProperty(Pn,"__esModule",{value:!0});const Xr=B,Nu=Z,Cu=rr,Ou={message:"must be equal to constant",params:({schemaCode:e})=>(0,Xr._)`{allowedValue: ${e}}`},Ru={keyword:"const",$data:!0,error:Ou,code(e){const{gen:t,data:r,$data:n,schemaCode:s,schema:a}=e;n||a&&typeof a=="object"?e.fail$data((0,Xr._)`!${(0,Nu.useFunc)(t,Cu.default)}(${r}, ${s})`):e.fail((0,Xr._)`${a} !== ${r}`)}};Pn.default=Ru;var kn={};Object.defineProperty(kn,"__esModule",{value:!0});const Ht=B,Iu=Z,Au=rr,Du={message:"must be equal to one of the allowed values",params:({schemaCode:e})=>(0,Ht._)`{allowedValues: ${e}}`},ju={keyword:"enum",schemaType:"array",$data:!0,error:Du,code(e){const{gen:t,data:r,$data:n,schema:s,schemaCode:a,it:o}=e;if(!n&&s.length===0)throw new Error("enum must have non-empty array");const u=s.length>=o.opts.loopEnum;let d;const l=()=>d??(d=(0,Iu.useFunc)(t,Au.default));let f;if(u||n)f=t.let("valid"),e.block$data(f,y);else{if(!Array.isArray(s))throw new Error("ajv implementation error");const g=t.const("vSchema",a);f=(0,Ht.or)(...s.map((w,k)=>T(g,k)))}e.pass(f);function y(){t.assign(f,!1),t.forOf("v",a,g=>t.if((0,Ht._)`${l()}(${r}, ${g})`,()=>t.assign(f,!0).break()))}function T(g,w){const k=s[w];return typeof k=="object"&&k!==null?(0,Ht._)`${l()}(${r}, ${g}[${w}])`:(0,Ht._)`${r} === ${k}`}}};kn.default=ju;Object.defineProperty(mn,"__esModule",{value:!0});const Mu=yn,Lu=$n,Fu=gn,Uu=vn,Vu=wn,zu=En,qu=bn,Wu=Sn,Hu=Pn,Gu=kn,Bu=[Mu.default,Lu.default,Fu.default,Uu.default,Vu.default,zu.default,qu.default,Wu.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},Hu.default,Gu.default];mn.default=Bu;var Tn={},Ot={};Object.defineProperty(Ot,"__esModule",{value:!0});Ot.validateAdditionalItems=void 0;const lt=B,Yr=Z,Ku={message:({params:{len:e}})=>(0,lt.str)`must NOT have more than ${e} items`,params:({params:{len:e}})=>(0,lt._)`{limit: ${e}}`},xu={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:Ku,code(e){const{parentSchema:t,it:r}=e,{items:n}=t;if(!Array.isArray(n)){(0,Yr.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}Pa(e,n)}};function Pa(e,t){const{gen:r,schema:n,data:s,keyword:a,it:o}=e;o.items=!0;const u=r.const("len",(0,lt._)`${s}.length`);if(n===!1)e.setParams({len:t.length}),e.pass((0,lt._)`${u} <= ${t.length}`);else if(typeof n=="object"&&!(0,Yr.alwaysValidSchema)(o,n)){const l=r.var("valid",(0,lt._)`${u} <= ${t.length}`);r.if((0,lt.not)(l),()=>d(l)),e.ok(l)}function d(l){r.forRange("i",t.length,u,f=>{e.subschema({keyword:a,dataProp:f,dataPropType:Yr.Type.Num},l),o.allErrors||r.if((0,lt.not)(l),()=>r.break())})}}Ot.validateAdditionalItems=Pa;Ot.default=xu;var Nn={},Rt={};Object.defineProperty(Rt,"__esModule",{value:!0});Rt.validateTuple=void 0;const ys=B,yr=Z,Ju=G,Qu={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(e){const{schema:t,it:r}=e;if(Array.isArray(t))return ka(e,"additionalItems",t);r.items=!0,!(0,yr.alwaysValidSchema)(r,t)&&e.ok((0,Ju.validateArray)(e))}};function ka(e,t,r=e.schema){const{gen:n,parentSchema:s,data:a,keyword:o,it:u}=e;f(s),u.opts.unevaluated&&r.length&&u.items!==!0&&(u.items=yr.mergeEvaluated.items(n,r.length,u.items));const d=n.name("valid"),l=n.const("len",(0,ys._)`${a}.length`);r.forEach((y,T)=>{(0,yr.alwaysValidSchema)(u,y)||(n.if((0,ys._)`${l} > ${T}`,()=>e.subschema({keyword:o,schemaProp:T,dataProp:T},d)),e.ok(d))});function f(y){const{opts:T,errSchemaPath:g}=u,w=r.length,k=w===y.minItems&&(w===y.maxItems||y[t]===!1);if(T.strictTuples&&!k){const _=`"${o}" is ${w}-tuple, but minItems or maxItems/${t} are not specified or different at path "${g}"`;(0,yr.checkStrictMode)(u,_,T.strictTuples)}}}Rt.validateTuple=ka;Rt.default=Qu;Object.defineProperty(Nn,"__esModule",{value:!0});const Xu=Rt,Yu={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:e=>(0,Xu.validateTuple)(e,"items")};Nn.default=Yu;var Cn={};Object.defineProperty(Cn,"__esModule",{value:!0});const $s=B,Zu=Z,el=G,tl=Ot,rl={message:({params:{len:e}})=>(0,$s.str)`must NOT have more than ${e} items`,params:({params:{len:e}})=>(0,$s._)`{limit: ${e}}`},nl={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:rl,code(e){const{schema:t,parentSchema:r,it:n}=e,{prefixItems:s}=r;n.items=!0,!(0,Zu.alwaysValidSchema)(n,t)&&(s?(0,tl.validateAdditionalItems)(e,s):e.ok((0,el.validateArray)(e)))}};Cn.default=nl;var On={};Object.defineProperty(On,"__esModule",{value:!0});const Te=B,ur=Z,sl={message:({params:{min:e,max:t}})=>t===void 0?(0,Te.str)`must contain at least ${e} valid item(s)`:(0,Te.str)`must contain at least ${e} and no more than ${t} valid item(s)`,params:({params:{min:e,max:t}})=>t===void 0?(0,Te._)`{minContains: ${e}}`:(0,Te._)`{minContains: ${e}, maxContains: ${t}}`},al={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:sl,code(e){const{gen:t,schema:r,parentSchema:n,data:s,it:a}=e;let o,u;const{minContains:d,maxContains:l}=n;a.opts.next?(o=d===void 0?1:d,u=l):o=1;const f=t.const("len",(0,Te._)`${s}.length`);if(e.setParams({min:o,max:u}),u===void 0&&o===0){(0,ur.checkStrictMode)(a,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(u!==void 0&&o>u){(0,ur.checkStrictMode)(a,'"minContains" > "maxContains" is always invalid'),e.fail();return}if((0,ur.alwaysValidSchema)(a,r)){let k=(0,Te._)`${f} >= ${o}`;u!==void 0&&(k=(0,Te._)`${k} && ${f} <= ${u}`),e.pass(k);return}a.items=!0;const y=t.name("valid");u===void 0&&o===1?g(y,()=>t.if(y,()=>t.break())):o===0?(t.let(y,!0),u!==void 0&&t.if((0,Te._)`${s}.length > 0`,T)):(t.let(y,!1),T()),e.result(y,()=>e.reset());function T(){const k=t.name("_valid"),_=t.let("count",0);g(k,()=>t.if(k,()=>w(_)))}function g(k,_){t.forRange("i",0,f,$=>{e.subschema({keyword:"contains",dataProp:$,dataPropType:ur.Type.Num,compositeRule:!0},k),_()})}function w(k){t.code((0,Te._)`${k}++`),u===void 0?t.if((0,Te._)`${k} >= ${o}`,()=>t.assign(y,!0).break()):(t.if((0,Te._)`${k} > ${u}`,()=>t.assign(y,!1).break()),o===1?t.assign(y,!0):t.if((0,Te._)`${k} >= ${o}`,()=>t.assign(y,!0)))}}};On.default=al;var Ta={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.validateSchemaDeps=e.validatePropertyDeps=e.error=void 0;const t=B,r=Z,n=G;e.error={message:({params:{property:d,depsCount:l,deps:f}})=>{const y=l===1?"property":"properties";return(0,t.str)`must have ${y} ${f} when property ${d} is present`},params:({params:{property:d,depsCount:l,deps:f,missingProperty:y}})=>(0,t._)`{property: ${d},
    missingProperty: ${y},
    depsCount: ${l},
    deps: ${f}}`};const s={keyword:"dependencies",type:"object",schemaType:"object",error:e.error,code(d){const[l,f]=a(d);o(d,l),u(d,f)}};function a({schema:d}){const l={},f={};for(const y in d){if(y==="__proto__")continue;const T=Array.isArray(d[y])?l:f;T[y]=d[y]}return[l,f]}function o(d,l=d.schema){const{gen:f,data:y,it:T}=d;if(Object.keys(l).length===0)return;const g=f.let("missing");for(const w in l){const k=l[w];if(k.length===0)continue;const _=(0,n.propertyInData)(f,y,w,T.opts.ownProperties);d.setParams({property:w,depsCount:k.length,deps:k.join(", ")}),T.allErrors?f.if(_,()=>{for(const $ of k)(0,n.checkReportMissingProp)(d,$)}):(f.if((0,t._)`${_} && (${(0,n.checkMissingProp)(d,k,g)})`),(0,n.reportMissingProp)(d,g),f.else())}}e.validatePropertyDeps=o;function u(d,l=d.schema){const{gen:f,data:y,keyword:T,it:g}=d,w=f.name("valid");for(const k in l)(0,r.alwaysValidSchema)(g,l[k])||(f.if((0,n.propertyInData)(f,y,k,g.opts.ownProperties),()=>{const _=d.subschema({keyword:T,schemaProp:k},w);d.mergeValidEvaluated(_,w)},()=>f.var(w,!0)),d.ok(w))}e.validateSchemaDeps=u,e.default=s})(Ta);var Rn={};Object.defineProperty(Rn,"__esModule",{value:!0});const Na=B,ol=Z,il={message:"property name must be valid",params:({params:e})=>(0,Na._)`{propertyName: ${e.propertyName}}`},cl={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:il,code(e){const{gen:t,schema:r,data:n,it:s}=e;if((0,ol.alwaysValidSchema)(s,r))return;const a=t.name("valid");t.forIn("key",n,o=>{e.setParams({propertyName:o}),e.subschema({keyword:"propertyNames",data:o,dataTypes:["string"],propertyName:o,compositeRule:!0},a),t.if((0,Na.not)(a),()=>{e.error(!0),s.allErrors||t.break()})}),e.ok(a)}};Rn.default=cl;var Ar={};Object.defineProperty(Ar,"__esModule",{value:!0});const lr=G,Ce=B,ul=We,dr=Z,ll={message:"must NOT have additional properties",params:({params:e})=>(0,Ce._)`{additionalProperty: ${e.additionalProperty}}`},dl={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:ll,code(e){const{gen:t,schema:r,parentSchema:n,data:s,errsCount:a,it:o}=e;if(!a)throw new Error("ajv implementation error");const{allErrors:u,opts:d}=o;if(o.props=!0,d.removeAdditional!=="all"&&(0,dr.alwaysValidSchema)(o,r))return;const l=(0,lr.allSchemaProperties)(n.properties),f=(0,lr.allSchemaProperties)(n.patternProperties);y(),e.ok((0,Ce._)`${a} === ${ul.default.errors}`);function y(){t.forIn("key",s,_=>{!l.length&&!f.length?w(_):t.if(T(_),()=>w(_))})}function T(_){let $;if(l.length>8){const N=(0,dr.schemaRefOrVal)(o,n.properties,"properties");$=(0,lr.isOwnProperty)(t,N,_)}else l.length?$=(0,Ce.or)(...l.map(N=>(0,Ce._)`${_} === ${N}`)):$=Ce.nil;return f.length&&($=(0,Ce.or)($,...f.map(N=>(0,Ce._)`${(0,lr.usePattern)(e,N)}.test(${_})`))),(0,Ce.not)($)}function g(_){t.code((0,Ce._)`delete ${s}[${_}]`)}function w(_){if(d.removeAdditional==="all"||d.removeAdditional&&r===!1){g(_);return}if(r===!1){e.setParams({additionalProperty:_}),e.error(),u||t.break();return}if(typeof r=="object"&&!(0,dr.alwaysValidSchema)(o,r)){const $=t.name("valid");d.removeAdditional==="failing"?(k(_,$,!1),t.if((0,Ce.not)($),()=>{e.reset(),g(_)})):(k(_,$),u||t.if((0,Ce.not)($),()=>t.break()))}}function k(_,$,N){const C={keyword:"additionalProperties",dataProp:_,dataPropType:dr.Type.Str};N===!1&&Object.assign(C,{compositeRule:!0,createErrors:!1,allErrors:!1}),e.subschema(C,$)}}};Ar.default=dl;var In={};Object.defineProperty(In,"__esModule",{value:!0});const fl=Re,gs=G,zr=Z,_s=Ar,pl={keyword:"properties",type:"object",schemaType:"object",code(e){const{gen:t,schema:r,parentSchema:n,data:s,it:a}=e;a.opts.removeAdditional==="all"&&n.additionalProperties===void 0&&_s.default.code(new fl.KeywordCxt(a,_s.default,"additionalProperties"));const o=(0,gs.allSchemaProperties)(r);for(const y of o)a.definedProperties.add(y);a.opts.unevaluated&&o.length&&a.props!==!0&&(a.props=zr.mergeEvaluated.props(t,(0,zr.toHash)(o),a.props));const u=o.filter(y=>!(0,zr.alwaysValidSchema)(a,r[y]));if(u.length===0)return;const d=t.name("valid");for(const y of u)l(y)?f(y):(t.if((0,gs.propertyInData)(t,s,y,a.opts.ownProperties)),f(y),a.allErrors||t.else().var(d,!0),t.endIf()),e.it.definedProperties.add(y),e.ok(d);function l(y){return a.opts.useDefaults&&!a.compositeRule&&r[y].default!==void 0}function f(y){e.subschema({keyword:"properties",schemaProp:y,dataProp:y},d)}}};In.default=pl;var An={};Object.defineProperty(An,"__esModule",{value:!0});const vs=G,fr=B,ws=Z,Es=Z,hl={keyword:"patternProperties",type:"object",schemaType:"object",code(e){const{gen:t,schema:r,data:n,parentSchema:s,it:a}=e,{opts:o}=a,u=(0,vs.allSchemaProperties)(r),d=u.filter(k=>(0,ws.alwaysValidSchema)(a,r[k]));if(u.length===0||d.length===u.length&&(!a.opts.unevaluated||a.props===!0))return;const l=o.strictSchema&&!o.allowMatchingProperties&&s.properties,f=t.name("valid");a.props!==!0&&!(a.props instanceof fr.Name)&&(a.props=(0,Es.evaluatedPropsToName)(t,a.props));const{props:y}=a;T();function T(){for(const k of u)l&&g(k),a.allErrors?w(k):(t.var(f,!0),w(k),t.if(f))}function g(k){for(const _ in l)new RegExp(k).test(_)&&(0,ws.checkStrictMode)(a,`property ${_} matches pattern ${k} (use allowMatchingProperties)`)}function w(k){t.forIn("key",n,_=>{t.if((0,fr._)`${(0,vs.usePattern)(e,k)}.test(${_})`,()=>{const $=d.includes(k);$||e.subschema({keyword:"patternProperties",schemaProp:k,dataProp:_,dataPropType:Es.Type.Str},f),a.opts.unevaluated&&y!==!0?t.assign((0,fr._)`${y}[${_}]`,!0):!$&&!a.allErrors&&t.if((0,fr.not)(f),()=>t.break())})})}}};An.default=hl;var Dn={};Object.defineProperty(Dn,"__esModule",{value:!0});const ml=Z,yl={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(e){const{gen:t,schema:r,it:n}=e;if((0,ml.alwaysValidSchema)(n,r)){e.fail();return}const s=t.name("valid");e.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},s),e.failResult(s,()=>e.reset(),()=>e.error())},error:{message:"must NOT be valid"}};Dn.default=yl;var jn={};Object.defineProperty(jn,"__esModule",{value:!0});const $l=G,gl={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:$l.validateUnion,error:{message:"must match a schema in anyOf"}};jn.default=gl;var Mn={};Object.defineProperty(Mn,"__esModule",{value:!0});const $r=B,_l=Z,vl={message:"must match exactly one schema in oneOf",params:({params:e})=>(0,$r._)`{passingSchemas: ${e.passing}}`},wl={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:vl,code(e){const{gen:t,schema:r,parentSchema:n,it:s}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");if(s.opts.discriminator&&n.discriminator)return;const a=r,o=t.let("valid",!1),u=t.let("passing",null),d=t.name("_valid");e.setParams({passing:u}),t.block(l),e.result(o,()=>e.reset(),()=>e.error(!0));function l(){a.forEach((f,y)=>{let T;(0,_l.alwaysValidSchema)(s,f)?t.var(d,!0):T=e.subschema({keyword:"oneOf",schemaProp:y,compositeRule:!0},d),y>0&&t.if((0,$r._)`${d} && ${o}`).assign(o,!1).assign(u,(0,$r._)`[${u}, ${y}]`).else(),t.if(d,()=>{t.assign(o,!0),t.assign(u,y),T&&e.mergeEvaluated(T,$r.Name)})})}}};Mn.default=wl;var Ln={};Object.defineProperty(Ln,"__esModule",{value:!0});const El=Z,bl={keyword:"allOf",schemaType:"array",code(e){const{gen:t,schema:r,it:n}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");const s=t.name("valid");r.forEach((a,o)=>{if((0,El.alwaysValidSchema)(n,a))return;const u=e.subschema({keyword:"allOf",schemaProp:o},s);e.ok(s),e.mergeEvaluated(u)})}};Ln.default=bl;var Fn={};Object.defineProperty(Fn,"__esModule",{value:!0});const Tr=B,Ca=Z,Sl={message:({params:e})=>(0,Tr.str)`must match "${e.ifClause}" schema`,params:({params:e})=>(0,Tr._)`{failingKeyword: ${e.ifClause}}`},Pl={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:Sl,code(e){const{gen:t,parentSchema:r,it:n}=e;r.then===void 0&&r.else===void 0&&(0,Ca.checkStrictMode)(n,'"if" without "then" and "else" is ignored');const s=bs(n,"then"),a=bs(n,"else");if(!s&&!a)return;const o=t.let("valid",!0),u=t.name("_valid");if(d(),e.reset(),s&&a){const f=t.let("ifClause");e.setParams({ifClause:f}),t.if(u,l("then",f),l("else",f))}else s?t.if(u,l("then")):t.if((0,Tr.not)(u),l("else"));e.pass(o,()=>e.error(!0));function d(){const f=e.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},u);e.mergeEvaluated(f)}function l(f,y){return()=>{const T=e.subschema({keyword:f},u);t.assign(o,u),e.mergeValidEvaluated(T,o),y?t.assign(y,(0,Tr._)`${f}`):e.setParams({ifClause:f})}}}};function bs(e,t){const r=e.schema[t];return r!==void 0&&!(0,Ca.alwaysValidSchema)(e,r)}Fn.default=Pl;var Un={};Object.defineProperty(Un,"__esModule",{value:!0});const kl=Z,Tl={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:e,parentSchema:t,it:r}){t.if===void 0&&(0,kl.checkStrictMode)(r,`"${e}" without "if" is ignored`)}};Un.default=Tl;Object.defineProperty(Tn,"__esModule",{value:!0});const Nl=Ot,Cl=Nn,Ol=Rt,Rl=Cn,Il=On,Al=Ta,Dl=Rn,jl=Ar,Ml=In,Ll=An,Fl=Dn,Ul=jn,Vl=Mn,zl=Ln,ql=Fn,Wl=Un;function Hl(e=!1){const t=[Fl.default,Ul.default,Vl.default,zl.default,ql.default,Wl.default,Dl.default,jl.default,Al.default,Ml.default,Ll.default];return e?t.push(Cl.default,Rl.default):t.push(Nl.default,Ol.default),t.push(Il.default),t}Tn.default=Hl;var Vn={},zn={};Object.defineProperty(zn,"__esModule",{value:!0});const ue=B,Gl={message:({schemaCode:e})=>(0,ue.str)`must match format "${e}"`,params:({schemaCode:e})=>(0,ue._)`{format: ${e}}`},Bl={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:Gl,code(e,t){const{gen:r,data:n,$data:s,schema:a,schemaCode:o,it:u}=e,{opts:d,errSchemaPath:l,schemaEnv:f,self:y}=u;if(!d.validateFormats)return;s?T():g();function T(){const w=r.scopeValue("formats",{ref:y.formats,code:d.code.formats}),k=r.const("fDef",(0,ue._)`${w}[${o}]`),_=r.let("fType"),$=r.let("format");r.if((0,ue._)`typeof ${k} == "object" && !(${k} instanceof RegExp)`,()=>r.assign(_,(0,ue._)`${k}.type || "string"`).assign($,(0,ue._)`${k}.validate`),()=>r.assign(_,(0,ue._)`"string"`).assign($,k)),e.fail$data((0,ue.or)(N(),C()));function N(){return d.strictSchema===!1?ue.nil:(0,ue._)`${o} && !${$}`}function C(){const I=f.$async?(0,ue._)`(${k}.async ? await ${$}(${n}) : ${$}(${n}))`:(0,ue._)`${$}(${n})`,j=(0,ue._)`(typeof ${$} == "function" ? ${I} : ${$}.test(${n}))`;return(0,ue._)`${$} && ${$} !== true && ${_} === ${t} && !${j}`}}function g(){const w=y.formats[a];if(!w){N();return}if(w===!0)return;const[k,_,$]=C(w);k===t&&e.pass(I());function N(){if(d.strictSchema===!1){y.logger.warn(j());return}throw new Error(j());function j(){return`unknown format "${a}" ignored in schema at path "${l}"`}}function C(j){const E=j instanceof RegExp?(0,ue.regexpCode)(j):d.code.formats?(0,ue._)`${d.code.formats}${(0,ue.getProperty)(a)}`:void 0,O=r.scopeValue("formats",{key:a,ref:j,code:E});return typeof j=="object"&&!(j instanceof RegExp)?[j.type||"string",j.validate,(0,ue._)`${O}.validate`]:["string",j,O]}function I(){if(typeof w=="object"&&!(w instanceof RegExp)&&w.async){if(!f.$async)throw new Error("async format in sync schema");return(0,ue._)`await ${$}(${n})`}return typeof _=="function"?(0,ue._)`${$}(${n})`:(0,ue._)`${$}.test(${n})`}}}};zn.default=Bl;Object.defineProperty(Vn,"__esModule",{value:!0});const Kl=zn,xl=[Kl.default];Vn.default=xl;var Ct={};Object.defineProperty(Ct,"__esModule",{value:!0});Ct.contentVocabulary=Ct.metadataVocabulary=void 0;Ct.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];Ct.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"];Object.defineProperty(fn,"__esModule",{value:!0});const Jl=pn,Ql=mn,Xl=Tn,Yl=Vn,Ss=Ct,Zl=[Jl.default,Ql.default,(0,Xl.default)(),Yl.default,Ss.metadataVocabulary,Ss.contentVocabulary];fn.default=Zl;var qn={},Oa={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DiscrError=void 0,function(t){t.Tag="tag",t.Mapping="mapping"}(e.DiscrError||(e.DiscrError={}))})(Oa);Object.defineProperty(qn,"__esModule",{value:!0});const Pt=B,Zr=Oa,Ps=ve,ed=Z,td={message:({params:{discrError:e,tagName:t}})=>e===Zr.DiscrError.Tag?`tag "${t}" must be string`:`value of tag "${t}" must be in oneOf`,params:({params:{discrError:e,tag:t,tagName:r}})=>(0,Pt._)`{error: ${e}, tag: ${r}, tagValue: ${t}}`},rd={keyword:"discriminator",type:"object",schemaType:"object",error:td,code(e){const{gen:t,data:r,schema:n,parentSchema:s,it:a}=e,{oneOf:o}=s;if(!a.opts.discriminator)throw new Error("discriminator: requires discriminator option");const u=n.propertyName;if(typeof u!="string")throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!o)throw new Error("discriminator: requires oneOf keyword");const d=t.let("valid",!1),l=t.const("tag",(0,Pt._)`${r}${(0,Pt.getProperty)(u)}`);t.if((0,Pt._)`typeof ${l} == "string"`,()=>f(),()=>e.error(!1,{discrError:Zr.DiscrError.Tag,tag:l,tagName:u})),e.ok(d);function f(){const g=T();t.if(!1);for(const w in g)t.elseIf((0,Pt._)`${l} === ${w}`),t.assign(d,y(g[w]));t.else(),e.error(!1,{discrError:Zr.DiscrError.Mapping,tag:l,tagName:u}),t.endIf()}function y(g){const w=t.name("valid"),k=e.subschema({keyword:"oneOf",schemaProp:g},w);return e.mergeEvaluated(k,Pt.Name),w}function T(){var g;const w={},k=$(s);let _=!0;for(let I=0;I<o.length;I++){let j=o[I];j?.$ref&&!(0,ed.schemaHasRulesButRef)(j,a.self.RULES)&&(j=Ps.resolveRef.call(a.self,a.schemaEnv.root,a.baseId,j?.$ref),j instanceof Ps.SchemaEnv&&(j=j.schema));const E=(g=j?.properties)===null||g===void 0?void 0:g[u];if(typeof E!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${u}"`);_=_&&(k||$(j)),N(E,I)}if(!_)throw new Error(`discriminator: "${u}" must be required`);return w;function $({required:I}){return Array.isArray(I)&&I.includes(u)}function N(I,j){if(I.const)C(I.const,j);else if(I.enum)for(const E of I.enum)C(E,j);else throw new Error(`discriminator: "properties/${u}" must have "const" or "enum"`)}function C(I,j){if(typeof I!="string"||I in w)throw new Error(`discriminator: "${u}" values must be unique strings`);w[I]=j}}}};qn.default=rd;const nd="http://json-schema.org/draft-07/schema#",sd="http://json-schema.org/draft-07/schema#",ad="Core schema meta-schema",od={schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},id=["object","boolean"],cd={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},ud={$schema:nd,$id:sd,title:ad,definitions:od,type:id,properties:cd,default:!0};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRefError=t.ValidationError=t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;const r=Qs,n=fn,s=qn,a=ud,o=["/properties"],u="http://json-schema.org/draft-07/schema";class d extends r.default{_addVocabularies(){super._addVocabularies(),n.default.forEach(w=>this.addVocabulary(w)),this.opts.discriminator&&this.addKeyword(s.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const w=this.opts.$data?this.$dataMetaSchema(a,o):a;this.addMetaSchema(w,u,!1),this.refs["http://json-schema.org/schema"]=u}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(u)?u:void 0)}}e.exports=t=d,Object.defineProperty(t,"__esModule",{value:!0}),t.default=d;var l=Re;Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return l.KeywordCxt}});var f=B;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return f._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return f.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return f.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return f.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return f.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return f.CodeGen}});var y=er;Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return y.default}});var T=tr;Object.defineProperty(t,"MissingRefError",{enumerable:!0,get:function(){return T.default}})})(Kr,Kr.exports);var ld=Kr.exports;const dd=so(ld),{wpCLI:fd,...ks}=_i;({...ks,importFile:ks.importWxr});new dd({discriminator:!0});async function pd(e){await Qt(e,{consts:{USE_FETCH_FOR_REQUESTS:!0}}),await e.onMessage(async t=>{let r;try{r=JSON.parse(t)}catch{return""}const{type:n,data:s}=r;return n!=="request"?"":(s.headers?Array.isArray(s.headers)&&(s.headers=Object.fromEntries(s.headers)):s.headers={},new URL(s.url).hostname===window.location.hostname&&(s.headers["x-request-issuer"]="php"),hd(s))})}async function hd(e,t=fetch){const r=new URL(e.url).hostname,n=["w.org","s.w.org"].includes(r)?`/plugin-proxy.php?url=${encodeURIComponent(e.url)}`:e.url;let s;try{const f=e.method||"GET",y=e.headers||{};f=="POST"&&(y["Content-Type"]="application/x-www-form-urlencoded",delete y.wp_install,delete y.wp_blog),s=await t(n,{method:f,headers:y,body:e.data,credentials:"omit"})}catch{return new TextEncoder().encode(`HTTP/1.1 400 Invalid Request\r
content-type: text/plain\r
\r
Playground could not serve the request.`)}const a=[];s.headers.forEach((f,y)=>{a.push(y+": "+f)});const o=["HTTP/1.1 "+s.status+" "+s.statusText,...a].join(`\r
`)+`\r
\r
`,u=new TextEncoder().encode(o),d=new Uint8Array(await s.arrayBuffer()),l=new Uint8Array(u.byteLength+d.byteLength);return l.set(u),l.set(d,u.byteLength),l}const Ra=new URL("/",(import.meta||{}).url).origin,md=new URL(Vo,Ra)+"",yd=new URL(zo,Ra),Xe=new URL(document.location.href).searchParams;async function $d(){wd();const e=Xe.has("progressbar");let t;e&&(t=new Uo,document.body.prepend(t.element));const r=Ts(Xe.get("wp"),Bo),n=Ts(Xe.get("php"),oo),s=vd(Xe.getAll("php-extension"),io),a=Xe.get("networking")==="yes",o=Xe.get("sapi-name")||void 0,u=vo(await To(md,{wpVersion:r,phpVersion:n,"php-extension":s,networking:a?"yes":"no",storage:Xe.get("storage")||"",...o?{sapiName:o}:{},"site-slug":Xe.get("site-slug")||"wordpress"})),d=document.querySelector("#wp"),l={async onDownloadProgress(g){return u.onDownloadProgress(g)},async journalFSEvents(g,w){return u.journalFSEvents(g,w)},async replayFSJournal(g){return u.replayFSJournal(g)},async addEventListener(g,w){return await u.addEventListener(g,w)},async removeEventListener(g,w){return await u.removeEventListener(g,w)},async setProgress(g){if(!t)throw new Error("Progress bar not available");t.setOptions(g)},async setLoaded(){if(!t)throw new Error("Progress bar not available");t.destroy()},async onNavigation(g){d.addEventListener("load",async w=>{try{const k=await T.internalUrlToPath(w.currentTarget.contentWindow.location.href);g(k)}catch{}})},async goTo(g){g.startsWith("/")||(g="/"+g);const w=await T.pathToInternalUrl(g),k=d.src;if(w===k&&d.contentWindow)try{d.contentWindow.location.href=w;return}catch{}d.src=w},async getCurrentURL(){let g="";try{g=d.contentWindow.location.href}catch{}return g||(g=d.src),await T.internalUrlToPath(g)},async setIframeSandboxFlags(g){d.setAttribute("sandbox",g.join(" "))},async onMessage(g){return await u.onMessage(g)},async bindOpfs(g,w){return await u.bindOpfs(g,w)}};await u.isConnected();const[f,y,T]=Eo(l,u);try{await u.isReady(),await Po(u,await u.scope,yd+""),ko(d,gd(await T.absoluteUrl)),_d(T),a&&await pd(u),f()}catch(g){throw y(g),g}return T}function gd(e){return new URL(e,"https://example.com").origin}function _d(e){window.addEventListener("message",async t=>{typeof t.data=="object"&&t.data.type==="mount-directory-handle"&&typeof t.data.directoryHandle=="object"&&t.data.mountpoint&&await e.bindOpfs({opfs:t.data.directoryHandle,mountpoint:t.data.mountpoint})})}function Ts(e,t){return!e||e==="latest"?t:e}function vd(e,t){return e?e.filter(r=>t.includes(r)):[]}function wd(){let e=!1;try{e=window.parent!==window&&window.parent.IS_WASM_WORDPRESS}catch{}if(e)throw new Error("The service worker did not load correctly. This is a bug, please report it on https://github.com/WordPress/wordpress-playground/issues");window.IS_WASM_WORDPRESS=!0}window.top!=window.self&&document.body.classList.add("is-embedded");try{window.playground=await $d()}catch(e){console.error(e),document.body.className="has-error",document.body.innerHTML="";const t=document.createElement("div");t.className="error-message";const r=e?.userFriendlyMessage||"See the developer tools for error details.";t.innerHTML="Ooops! WordPress Playground had a hiccup! <br/><br/> "+r,document.body.append(t);const n=document.createElement("button");if(n.innerText="Try again",n.onclick=()=>{window.location.reload()},e?.name==="NotSupportedError"){let s=!1;try{const{state:a}=await navigator.permissions.query({name:"storage-access"});s=a==="granted"}catch{}s||!("requestStorageAccess"in document)?t.innerText="It looks like you have disabled third-party cookies in your browser. This also disables the Service Worker API used by WordPress Playground. Please re-enable third-party cookies and try again.":(t.innerText="WordPress Playground needs to use storage in your browser",n.innerText="Allow storage access",n.onclick=async()=>{try{await document.requestStorageAccess(),window.location.reload()}catch{t.innerHTML=`
									<p>
										Oops! Playground failed to start. Here's what to do:
									</p>
									
									<h3>Did you disable third-party cookies?</h3>
									<p>
										It also disables the required Service Worker API. Please re-enable 
										third-party cookies and try again.
									</p>

									<h3>Did you refuse to grant Playground storage access?</h3>
									<p>
										Click the button below and grant storage access. Note the button may 
										not work if you have disabled third-party cookies in your browser.
									</p>
									`;const o=document.createElement("p");o.innerHTML=`
									If neither method helped, please 
									<a href="https://github.com/WordPress/playground-tools/issues/new"
									   target="_blank">
										report an issue on GitHub
									</a>.
								`,document.body.append(o)}})}document.body.append(n)}finally{document.body.classList.remove("is-loading")}
